/** @license
 * Copyright (c) 2015 NightDev
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without limitation of the rights to use, copy, modify, merge,
 * and/or publish copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following conditions:
 *
 * The above copyright notice, any copyright notices herein, and this permission
 * notice shall be included in all copies or substantial portions of the Software,
 * the Software, or portions of the Software, may not be sold for profit, and the
 * Software may not be distributed nor sub-licensed without explicit permission
 * from the copyright owner.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *
 * Should any questions arise concerning your usage of this Software, or to
 * request permission to distribute this Software, please contact the copyright
 * holder at http://nightdev.com/contact
 *
 * ---------------------------------
 *
 *  Unofficial TLDR:
 *  Free to modify for personal use
 *  Need permission to distribute the code
 *  Can't sell addon or features of the addon
 *  
 */
/** @license
 * Gritter for jQuery
 * http://www.boedesign.com/
 *
 * Copyright (c) 2014 Jordan Boesch
 * Dual licensed under the MIT and GPL licenses.
 */
/** @license
 * Jade
 * https://github.com/visionmedia/jade
 *
 * Copyright (c) 2009-2014 TJ Holowaychuk (tj@vision-media.ca)
 * Licensed under the MIT license.
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.jade=e()}}(function(){return function e(t,n,o){function r(s,i){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!i&&c)return c(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return r(n?n:e)},h,h.exports,e,t,n,o)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){"use strict";function o(e){return null!=e&&""!==e}function r(e){return(Array.isArray(e)?e.map(r):e&&"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}):[e]).filter(o).join(" ")}function a(e){return i[e]||e}function s(e){var t=String(e).replace(c,a);return t===""+e?e:t}n.merge=function l(e,t){if(1===arguments.length){for(var n=e[0],r=1;r<e.length;r++)n=l(n,e[r]);return n}var a=e["class"],s=t["class"];(a||s)&&(a=a||[],s=s||[],Array.isArray(a)||(a=[a]),Array.isArray(s)||(s=[s]),e["class"]=a.concat(s).filter(o));for(var i in t)"class"!=i&&(e[i]=t[i]);return e},n.joinClasses=r,n.cls=function(e,t){for(var o=[],a=0;a<e.length;a++)o.push(t&&t[a]?n.escape(r([e[a]])):r(e[a]));var s=r(o);return s.length?' class="'+s+'"':""},n.style=function(e){return e&&"object"==typeof e?Object.keys(e).map(function(t){return t+":"+e[t]}).join(";"):e},n.attr=function(e,t,o,r){return"style"===e&&(t=n.style(t)),"boolean"==typeof t||null==t?t?" "+(r?e:e+'="'+e+'"'):"":0==e.indexOf("data")&&"string"!=typeof t?(-1!==JSON.stringify(t).indexOf("&")&&console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"),t&&"function"==typeof t.toISOString&&console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0")," "+e+"='"+JSON.stringify(t).replace(/'/g,"&apos;")+"'"):o?(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+n.escape(t)+'"'):(t&&"function"==typeof t.toISOString&&console.warn("Jade will stringify dates in ISO form after 2.0.0")," "+e+'="'+t+'"')},n.attrs=function(e,t){var o=[],a=Object.keys(e);if(a.length)for(var s=0;s<a.length;++s){var i=a[s],c=e[i];"class"==i?(c=r(c))&&o.push(" "+i+'="'+c+'"'):o.push(n.attr(i,c,!1,t))}return o.join("")};var i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"},c=/[&<>"]/g;n.escape=s,n.rethrow=function h(t,n,o,r){if(!(t instanceof Error))throw t;if(!("undefined"==typeof window&&n||r))throw t.message+=" on line "+o,t;try{r=r||e("fs").readFileSync(n,"utf8")}catch(a){h(t,null,o)}var s=3,i=r.split("\n"),c=Math.max(o-s,0),l=Math.min(i.length,o+s),s=i.slice(c,l).map(function(e,t){var n=t+c+1;return(n==o?"  > ":"    ")+n+"| "+e}).join("\n");throw t.path=n,t.message=(n||"Jade")+":"+o+"\n"+s+"\n\n"+t.message,t},n.DebugItem=function(e,t){this.lineno=e,this.filename=t}},{fs:2}],2:[function(){},{}]},{},[1])(1)}),function(e){!function t(e,n,o){function r(s,i){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!i&&c)return c(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return r(n?n:t)},l,l.exports,t,e,n,o)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t){t.exports=["nightbot","moobot","xanbot"]},{}],2:[function(e,t,n){n.tmi=e("./chat/tmi"),n.templates=e("./chat/templates"),n.takeover=e("./chat/takeover"),n.emotes=e("./chat/emotes"),n.helpers=e("./chat/helpers"),n.handlers=e("./chat/handlers"),n.store=e("./chat/store"),n.imagePreview=e("./chat/image-preview")},{"./chat/emotes":3,"./chat/handlers":4,"./chat/helpers":5,"./chat/image-preview":6,"./chat/store":8,"./chat/takeover":9,"./chat/templates":10,"./chat/tmi":11}],3:[function(t,n){var o=t("./tmi"),r=t("./store"),a=t("./helpers"),s=e.vars;n.exports=function(){if(e.settings.get("bttvEmotes")===!1)return[];var t=r.bttvEmotes,n=[];if(s.userData.isLoggedIn&&e.chat.helpers.getEmotes(s.userData.login))var i=a.getEmotes(s.userData.login);return Object.keys(t).forEach(function(r){var a=t[r];if(a.restrictions){if(a.restrictions.channels.length&&-1===a.restrictions.channels.indexOf(e.getChannel()))return;if(a.restrictions.games.length&&o().channel&&-1===a.restrictions.games.indexOf(o().channel.game))return;if(a.restrictions.emoticonSet&&-1===i.indexOf(a.restrictions.emoticonSet))return}("gif"!==a.imageType||e.settings.get("bttvGIFEmotes")===!0)&&(a.text=a.code,a.channel||(a.channel="BetterTTV Emotes",a.badge="https://cdn.betterttv.net/tags/developer.png"),n.push(a))}),n}},{"./helpers":5,"./store":8,"./tmi":11}],4:[function(t,n,o){var r=t("../vars"),a=t("../helpers/debug"),s=t("./store"),i=t("./tmi"),c=t("./helpers"),l=t("./templates"),h=t("./rooms"),u=(t("../features/anon-chat"),t("../features/embedded-polling")),d=t("../features/channel-state"),p=t("../features/audible-feedback"),f=(t("../helpers/regex").getEmoteFromRegEx,t("../helpers/colors").rgbToHsl,t("../helpers/colors").hslToRgb,t("../helpers/colors").getRgb),g=(t("../helpers/colors").getHex,o.commands=function(t){var n=t.trim().split(" "),o=n[0].toLowerCase();if("/join"===o)e.settings.save("anonChat",!1);else if("/part"===o)e.settings.save("anonChat",!0);else if("/b"===o)c.ban(n[1]);else if("/t"===o){var a=600;isNaN(n[2])||(a=n[2]),c.timeout(n[1],a)}else if("/p"===o||"/purge"===o)c.timeout(n[1],1);else if("/massunban"===o||("/unban"===o||"/u"===o)&&"all"===n[1])c.massUnban();else if("/u"===o)c.unban(n[1]);else if("/w"===o&&e.settings.get("disableWhispers")===!0)c.serverMessage("You have disabled whispers in BetterTTV settings");else if("/sub"===o)i().tmiRoom.startSubscribersMode();else if("/suboff"===o)i().tmiRoom.stopSubscribersMode();else if("/localsub"===o)c.serverMessage("Local subscribers-only mode enabled.",!0),r.localSubsOnly=!0;else if("/localsuboff"===o)c.serverMessage("Local subscribers-only mode disabled.",!0),r.localSubsOnly=!1;else if("/localmod"===o)c.serverMessage("Local moderators-only mode enabled.",!0),r.localModsOnly=!0;else if("/localmodoff"===o)c.serverMessage("Local moderators-only mode disabled.",!0),r.localModsOnly=!1;else if("/viewers"===o)e.TwitchAPI.get("streams/"+e.getChannel()).done(function(e){c.serverMessage("Current Viewers: "+Twitch.display.commatize(e.stream.viewers),!0)}).fail(function(){c.serverMessage("Could not fetch viewer count.",!0)});else if("/followers"===o)e.TwitchAPI.get("channels/"+e.getChannel()+"/follows").done(function(e){c.serverMessage("Current Followers: "+Twitch.display.commatize(e._total),!0)}).fail(function(){c.serverMessage("Could not fetch follower count.",!0)});else if("/linehistory"===o)"off"===n[1]?e.settings.save("chatLineHistory",!1):e.settings.save("chatLineHistory",!0);else{if("/uptime"!==o)return"/help"===o?(c.serverMessage("BetterTTV Chat Commands:"),c.serverMessage("/b [username] -- Shortcut for /ban"),c.serverMessage("/followers -- Retrieves the number of followers for the channel"),c.serverMessage("/linehistory on/off -- Toggles the chat field history (pressing up/down arrow in textbox)"),c.serverMessage("/localmod -- Turns on local mod-only mode (only your chat is mod-only mode)"),c.serverMessage("/localmodoff -- Turns off local mod-only mode"),c.serverMessage("/localsub -- Turns on local sub-only mode (only your chat is sub-only mode)"),c.serverMessage("/localsuboff -- Turns off local sub-only mode"),c.serverMessage("/purge [username] (or /p) -- Purges a user's chat"),c.serverMessage("/massunban (or /unban all or /u all) -- Unbans all users in the channel (channel owner only)"),c.serverMessage("/r -- Type '/r ' to respond to your last whisper"),c.serverMessage("/sub -- Shortcut for /subscribers"),c.serverMessage("/suboff -- Shortcut for /subscribersoff"),c.serverMessage("/t [username] [time in seconds] -- Shortcut for /timeout"),c.serverMessage("/u [username] -- Shortcut for /unban"),c.serverMessage("/uptime -- Retrieves the amount of time the channel has been live"),c.serverMessage("/viewers -- Retrieves the number of viewers watching the channel"),c.serverMessage("Native Chat Commands:"),!1):!1;e.TwitchAPI.get("streams/"+e.getChannel()).done(function(e){if(null!==e.stream){var t=new Date(e.stream.created_at),n=Math.round(Math.abs((Date.now()-(t.getTime()-60*t.getTimezoneOffset()*1e3))/1e3)),o=Math.floor(n/86400),r=Math.floor(n/3600)-24*o,a=Math.floor(n/60)-1440*o-60*r,s=n-86400*o-3600*r-60*a;c.serverMessage("Stream uptime: "+(o>0?o+" day"+(1===o?"":"s")+", ":"")+(r>0?r+" hour"+(1===r?"":"s")+", ":"")+(a>0?a+" minute"+(1===a?"":"s")+", ":"")+s+" second"+(1===s?"":"s"),!0)}else c.serverMessage("Stream offline",!0)}).fail(function(){c.serverMessage("Could not fetch start time.",!0)})}return!0},o.countUnreadMessages=function(){var n=t("./rooms"),o=e.getChatController(),r=n.getRooms(),s=0;r.forEach(function(e){var e=n.getRoom(e);e.unread>0&&s++;try{e.emberRoom.set("unreadCount",e.unread)}catch(t){a.log("Error setting unread count! Ember controller for channel must be removed.")}}),o.set("notificationsCount",s)},o.shiftQueue=function(){var e=t("./rooms");if(i()&&i().get("id")){var n=i().get("id");if(n!==s.currentRoom&&i().get("name"))$(".ember-chat .chat-messages .tse-content .chat-line").remove(),s.currentRoom=n,s.__messageQueue=[],e.getRoom(n).playQueue(),c.serverMessage("You switched to: "+i().get("name").replace(/</g,"&lt;").replace(/>/g,"&gt;"),!0);else{if(0===s.__messageQueue.length)return;$(".ember-chat .chat-messages .tse-content .chat-lines").append(s.__messageQueue.join("")),s.__messageQueue=[]}c.scrollChat()}},o.moderationCard=function(n,o){var r=t("../features/make-card");e.TwitchAPI.get("/api/channels/"+n.toLowerCase()+"/ember").done(function(e){return e.name?void r(e,o):void r({name:e,display_name:e.capitalize()},o)}).fail(function(){r({name:n,display_name:n.capitalize()},o)})},o.labelsChanged=function(t){if(e.settings.get("adminStaffAlert")===!0){var n=c.getSpecials(t);-1!==n.indexOf("admin")?c.notifyMessage("admin",t+" just joined! Watch out foo!"):-1!==n.indexOf("staff")&&c.notifyMessage("staff",t+" just joined! Watch out foo!")}},o.clearChat=function(t){var n=s.trackTimeouts;if($("#chat_preview").remove(),t){if(0===$('.chat-line[data-sender="'+t.replace(/%/g,"_").replace(/[<>,]/g,"")+'"]').length)return;if(e.settings.get("hideDeletedMessages")===!0)$('.chat-line[data-sender="'+t.replace(/%/g,"_").replace(/[<>,]/g,"")+'"]').each(function(){$(this).hide(),$("div.tipsy").remove()}),setTimeout(function(){$(".chat-line .mod-icons .bot, .chat-line .mod-icons .oldbot").each(function(){$(this).parent().parent().find("span.message:contains('"+t.replace(/%/g,"_").replace(/[<>,]/g,"")+"')").each(function(){$(this).parent().hide()})})},3e3);else if($('.chat-line[data-sender="'+t.replace(/%/g,"_").replace(/[<>,]/g,"")+'"] .message').each(e.settings.get("showDeletedMessages")!==!0?function(){$(this).addClass("timed-out"),$(this).html('<span style="color: #999">&lt;message deleted&gt;</span>').off("click").on("click",function(){$(this).replaceWith(l.message(t,decodeURIComponent($(this).data("raw"))))})}:function(){$("a",this).each(function(){var e='<span style="text-decoration: line-through;">'+$(this).attr("href").replace(/</g,"&lt;").replace(/>/g,"&gt;")+"</span>";$(this).replaceWith(e)}),$(".emoticon",this).each(function(){$(this).css("opacity","0.1")}),$(this).addClass("timed-out"),$(this).html('<span style="color: #999">'+$(this).html()+"</span>")}),n[t])n[t].count++,$("#times_from_"+t.replace(/%/g,"_").replace(/[<>,]/g,"")+"_"+n[t].timesID).each(function(){$(this).text("("+n[t].count+" times)")});else{n[t]={count:1,timesID:Math.floor(100001*Math.random())};var o=c.lookupDisplayName(t);c.serverMessage(o+' has been timed out. <span id="times_from_'+t.replace(/%/g,"_").replace(/[<>,]/g,"")+"_"+n[t].timesID+'"></span>',!0)}}else c.serverMessage("Chat was cleared by a moderator (Prevented by BetterTTV)",!0)},o.notice=function(e){var t=e.msgId,n=e.message;d({type:"notice",tags:{"msg-id":t},message:n}),c.serverMessage(n,!0)},o.onPrivmsg=function(t,n){if(!h.getRoom(t).active()&&n.from&&"jtv"!==n.from)return void h.getRoom(t).queueMessage(n);if(n.message.length&&i()&&i().tmiRoom)try{if("whisper"===n.style){if(s.chatters[n.from]={lastWhisper:Date.now()},e.settings.get("disableWhispers")===!0)return;n.from!==r.userData.login&&(p(),e.settings.get("desktopNotifications")===!0&&e.chat.store.activeView===!1&&e.notify("You received a whisper from "+(n.tags&&n.tags["display-name"]||n.from)))}g(t,n)}catch(o){if(-1!==s.__reportedErrors.indexOf(o.message))return;s.__reportedErrors.push(o.message),console.log(o);var a={stack:o.stack,message:o.message};$.get("https://nightdev.com/betterttv/errors/?obj="+encodeURIComponent(JSON.stringify(a))),c.serverMessage("BetterTTV encountered an error reading chat. The developer has been sent a log of this action. Please try clearing your cookies and cache.")}},o.privmsg=function(n,o){o.tags&&o.tags["display-name"]&&(s.displayNames[o.from]=o.tags["display-name"]);try{i().trackLatency(o),i().trackWhisper(o)}catch(h){a.log("Error sending tracking data to Twitch")}if(!o.style||-1!==["admin","action","notification","whisper"].indexOf(o.style)){if("admin"===o.style||"notification"===o.style){if(o.message.indexOf("Sorry, we were unable to connect to chat.")>-1&&s.ignoreDC===!0)return void(s.ignoreDC=!1);o.style="admin";var d=l.privmsg(!1,"action"===o.style?!0:!1,"admin"===o.style?!0:!1,r.userData.isLoggedIn?c.isModerator(r.userData.login):!1,{message:o.message,time:null==o.date?"":o.date.toLocaleTimeString().replace(/^(\d{0,2}):(\d{0,2}):(.*)$/i,"$1:$2"),nickname:o.from||"jtv",sender:o.from,badges:o.badges||("twitchnotify"===o.from?[{type:"subscriber",name:"",description:"Channel Subscriber"}]:[]),color:"#555"});return $(".ember-chat .chat-messages .tse-content .chat-lines").append(d),void c.scrollChat()}s.chatters[o.from]||(s.chatters[o.from]={lastWhisper:0}),s.trackTimeouts[o.from]&&delete s.trackTimeouts[o.from];var p=t("../features/keywords-lists").blacklistFilter,g=t("../features/keywords-lists").highlighting;if(!e.settings.get("blacklistKeywords")||!p(o)){var m=e.settings.get("highlightKeywords")&&g(o);if(u(o),o.color=o.tags&&o.tags.color&&o.tags.color.length?o.tags.color:c.getColor(o.from),o.color=c.calculateColor(o.color),c.hasGlow(o.from)&&"action"!==o.style){var v=f("#ffffff"===o.color?"#000000":o.color);e.settings.get("darkenedMode")===!0&&(o.color=o.color+"; text-shadow: 0 0 20px rgba("+v.r+","+v.g+","+v.b+",0.8)")}r.blackChat&&"#000000"===o.color&&(o.color="#ffffff");var b=c.getBadges(o.from),y=c.assignBadges(b,o),w=o.from,k=o.from;if(o.bttvDisplayName?(c.lookupDisplayName(o.from),w=o.bttvDisplayName):w=c.lookupDisplayName(o.from),"whisper"===o.style){var _=c.getColor(o.to);_=c.calculateColor(_);var d=l.whisper({message:o.message,time:null==o.date?"":o.date.toLocaleTimeString().replace(/^(\d{0,2}):(\d{0,2}):(.*)$/i,"$1:$2"),from:w,sender:k,receiver:o.to,to:c.lookupDisplayName(o.to),fromColor:o.color,toColor:_,emotes:o.tags.emotes});return $(".ember-chat .chat-messages .tse-content .chat-lines").append(d),void c.scrollChat()}if((!r.localSubsOnly||c.isModerator(o.from)||c.isSubscriber(o.from))&&(!e.chat.helpers.isIgnored(o.from))){var d=l.privmsg(m,"action"===o.style?!0:!1,"admin"===o.style?!0:!1,r.userData.isLoggedIn?c.isModerator(r.userData.login)&&(!c.isModerator(k)||r.userData.login===n&&r.userData.login!==k):!1,{message:o.message,time:o.date.toLocaleTimeString().replace(/^(\d{0,2}):(\d{0,2}):(.*)$/i,"$1:$2"),nickname:w,sender:k,badges:y,color:o.color,emotes:o.tags.emotes});s.__messageQueue.push(d)}}}})},{"../features/anon-chat":13,"../features/audible-feedback":14,"../features/channel-state":21,"../features/embedded-polling":32,"../features/keywords-lists":41,"../features/make-card":42,"../helpers/colors":45,"../helpers/debug":46,"../helpers/regex":49,"../vars":64,"./helpers":5,"./rooms":7,"./store":8,"./templates":10,"./tmi":11}],5:[function(t,n,o){{var r=t("../vars"),a=t("../helpers/debug"),s=t("../keycodes"),i=t("./tmi"),c=t("./store"),l=t("./templates"),h=t("../bots"),u=t("punycode"),d=t("../features/channel-state"),p=(t("../helpers/element").remove,t("../helpers/regex").escapeRegExp,t("../helpers/colors").calculateColorBackground),f=t("../helpers/colors").calculateColorReplacement,g=o.lookupDisplayName=function(t){return t&&""!==t?(r.userData.isLoggedIn&&t===r.userData.login&&(c.displayNames[t]=Twitch.user.displayName()||t),e.io.lookupUser(t),i()?c.displayNames.hasOwnProperty(t)?c.displayNames[t]||t.capitalize():"jtv"!==t&&"twitchnotify"!==t?t.capitalize():t:t.capitalize()):void 0},m=["mod","unmod","ban","unban","timeout","purge","host","unhost","b","t","u","w","p"],v=function(e){var e=e.split(" ");if(e.length<2)return!1;if(e.pop(),checkCommand=e[e.length-1],e[0]!==checkCommand)return!1;for(var t=0;t<m.length;t++){var n=new RegExp("^(\\/|\\.)"+m[t]+"$","i");if(n.test(checkCommand))return!0}return!1},b=(o.parseTags=function(e){var t=e.slice(1,e.length).split(";");e={};for(var n=0;n<t.length;n++){var o=t[n],r=o.split("=");e[r[0]]=r[1]}return e},o.parseRoomState=function(e){try{d({type:"roomstate",tags:e.tags})}catch(e){a.log("Couldn't handle roomstate update.",e)}},function(){var t=[];e.chat.emotes().forEach(function(e){e.text&&t.push(e.text)});try{var n=i().tmiSession._emotesParser.emoticonRegexToIds;for(var o in n)n.hasOwnProperty(o)&&n[o].isRegex!==!0&&t.push(o)}catch(r){a.log("Couldn't grab user emotes for tab completion.",r)}return t}),y=(o.tabCompletion=function(e){var t=e.keyCode||e.which,n=$(".ember-chat .chat-interface"),o=n.find("textarea"),a=o.val(),i=a.trim().split(" "),l=i.pop().replace(/,$/,""),h=b();if(-1===h.indexOf(l)&&(l=l.toLowerCase()),(v(a)||t===s.Tab||"@"===l.charAt(0))&&t!==s.Enter){var u,d=c.suggestions,p=l.replace(/^@/,""),f=d.matchList.indexOf(p);if(p===d.lastMatch&&f>-1){var m,w;m=f+1<d.matchList.length?f+1:d.matchList.length-1,w=f-1>=0?f-1:0;var k=e.shiftKey?w:m;if(u=d.matchList[k],d.matchList.length<6)y(d.matchList,k);else{var _;0>k-2?_=0:k+2>d.matchList.length-1?(_=d.matchList.length-5,k=k===d.matchList.length-1?4:3):(_=k-2,k=2),y(d.matchList.slice(_,_+5),k)}}else{var C=p,x=Object.keys(c.chatters),T=[];if(v(a)){for(var A=x.length;A>=0;A--)void 0!==c.chatters[x[A]]&&0!==c.chatters[x[A]].lastWhisper&&(T.push(x[A]),x.splice(A,1));T.sort(function(e,t){return c.chatters[t].lastWhisper-c.chatters[e].lastWhisper})}if(x.sort(),x=T.concat(x),"@"===l.charAt(0)||v(a)||(x=x.concat(h)),x.indexOf(r.userData.login)>-1&&x.splice(x.indexOf(r.userData.login),1),/^(\/|\.)/.test(C)&&(C=""),C.length&&(x=x.filter(function(e){var t=e.toLowerCase();return 0===t.search(C)})),!x.length)return;d.matchList=x,y(x.slice(0,5),0),u=x[0]}var S=n.find(".suggestions");if(setTimeout(function(){S.remove()},1e4),t!==s.Tab)return;d.lastMatch=u;var E=!0;if(-1===h.indexOf(u)&&(u=g(u),E=!1),/^(\/|\.)/.test(l))return u=l+" "+u,void o.val(u);"@"===l.charAt(0)&&(u="@"+u),i.push(u),o.val(1!==i.length||E?i.join(" "):i.join(" ")+", ")}},o.whisperReply=function(){var t=$(".ember-chat .chat-interface").find("textarea");if("/r "===t.val()&&e.settings.get("disableWhispers")===!1){var n=($.grep(c.__rooms[c.currentRoom].messages,function(e){return"whisper"===e.style&&e.from.toLowerCase()!==r.userData.login}).pop()||{from:null}).from;n?t.val("/w "+n+" "):(t.val(""),w("You have not received any whispers",!0))}},o.chatLineHistory=function(t,n){if(e.settings.get("chatLineHistory")!==!1){var o=n.keyCode||n.which,r=($(".ember-chat .chat-interface"),c.chatHistory.indexOf(t.val().trim()));o===s.UpArrow?r>=0?c.chatHistory[r+1]&&t.val(c.chatHistory[r+1]):t.val().trim().length?(c.chatHistory.unshift(t.val().trim()),t.val(c.chatHistory[1])):t.val(c.chatHistory[0]):o===s.DownArrow&&r>=0&&t.val(c.chatHistory[r-1]?c.chatHistory[r-1]:"")}},o.suggestions=function(t,n){var o=$(".ember-chat .chat-interface"),r=o.find("textarea"),a=o.find(".suggestions");a.length&&a.remove();var s=r.val(),i=s.trim().split(" "),c=i.pop();("@"===c.charAt(0)||v(s)||e.settings.get("tabCompletionTooltip")!==!1)&&(a=o.find(".textarea-contain").append(l.suggestions(t,n)).find(".suggestions"),a.find(".suggestion").on("click",function(){var e=$(this).text(),t=r.val().trim().split(" "),n=v(s)&&!t[1]?"":t.pop(),o=-1!==b().indexOf(e);t.push(o?e:"@"===n.charAt(0)?"@"+g(e):g(e)),r.val(1!==t.length||o?t.join(" ")+" ":t.join(" ")+", "),a.remove()}).on("mouseover",function(){var e=a.find(".suggestion").eq(0);e.parent().removeClass("highlighted"),$(this).parent().addClass("highlighted")}).on("mouseout",function(){$(this).parent().removeClass("highlighted")}),a.on("click",function(){$(this).remove()}))}),w=o.serverMessage=function(e,n){var o=t("./handlers");o.onPrivmsg(c.currentRoom,{from:"jtv",date:n?new Date:null,message:e,style:"admin"})},k=(o.notifyMessage=function(n,o){var r=t("./handlers"),a=e.settings.get("showJTVTags")===!0&&-1!==["moderator","broadcaster","admin","global-moderator","staff","bot"].indexOf(n)?"old"+n:n;r.onPrivmsg(c.currentRoom,{from:"twitchnotify",date:new Date,badges:[{type:a,name:e.settings.get("showJTVTags")&&"subscriber"!==n&&"turbo"!==n?n.capitalize():"",description:a.capitalize()}],message:o,style:"notification"})},o.sendMessage=function(t){if(t&&""!==t&&i()){if(!r.userData.isLoggedIn){try{window.Ember.$.login()}catch(n){w("You must be logged into Twitch to send messages.")}return}if(e.settings.get("anonChat")===!0)return void w("You can't send messages when Anon Chat is enabled. You can disable Anon Chat in the BetterTTV settings.");("/"===t.charAt(0)||"."===t.charAt(0))&&(t=t.split(" "),t[0]=t[0].toLowerCase(),t=t.join(" ")),i().tmiRoom.sendMessage(t);try{/^\/w(\s|$)/.test(t)||(d({type:"outgoing_message"}),i().trackSubOnly(t),i().trackChat())}catch(n){a.log("Error sending tracking data to Twitch")}i().set("messageToSend",""),i().set("savedInput","")}},o.reparseMessages=function(t){t&&t.length&&e.jQuery('.chat-line[data-sender="'+t+'"] .message').each(function(){var e=$(this),n=decodeURIComponent(e.data("raw")),o=e.data("emotes")?JSON.parse(decodeURIComponent(e.data("emotes"))):!1,r=e.attr("style")?e.attr("style").split(": ")[1]:!1;e.replaceWith(l.message(t,n,o,r))})},o.listMods=function(){return i()?i().tmiRoom._roomUserLabels._sets:{}},o.addMod=function(e){return e&&""!==e?void(i()&&i().tmiRoom._roomUserLabels.add(e,"mod")):!1},o.removeMod=function(e){return e&&""!==e?void(i()&&i().tmiRoom._roomUserLabels.remove(e,"mod")):!1},o.isIgnored=function(e){return e&&""!==e?i()&&i().tmiSession.isIgnored(e):!1},o.isOwner=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("owner"):!1}),_=o.isAdmin=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("admin"):!1},C=o.isGlobalMod=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("global_mod"):!1},x=o.isStaff=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("staff"):!1},T=o.isModerator=function(e){return e&&""!==e?i()&&(-1!==i().tmiRoom.getLabels(e).indexOf("mod")||_(e)||x(e)||k(e)||C(e)):!1},A=(o.isTurbo=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("turbo"):!1},o.isSubscriber=function(e){return e&&""!==e?i()&&-1!==i().tmiRoom.getLabels(e).indexOf("subscriber"):!1},o.getBadges=function(t){if(!t||""===t)return!1;var n=[];return i()&&i().tmiRoom.getLabels(t)&&(n=i().tmiRoom.getLabels(t)),c.__subscriptions[t]&&-1!==c.__subscriptions[t].indexOf(e.getChannel())&&n.push("subscriber"),(c.__channelBots.indexOf(t)>-1||h.indexOf(t)>-1&&T(t))&&n.push("bot"),n},o.hasGlow=function(e){return e&&""!==e?c.__subscriptions[e]&&-1!==c.__subscriptions[e].indexOf("_glow")?!0:void 0:!1},o.getColor=function(e){return e&&""!==e?i()?i().tmiSession.getColor(e):null:!1},o.getEmotes=function(e){if(!e||""===e)return!1;var t=[];return i()&&i().tmiRoom.getEmotes&&i().tmiRoom.getEmotes(e)&&(t=i().tmiRoom.getEmotes(e)),c.__subscriptions[e]&&c.__subscriptions[e].forEach(function(e){t.push(e)}),t},o.getSpecials=function(t){if(!t||""===t)return!1;var n=[];return i()&&i().tmiSession&&i().tmiSession._users&&(n=i().tmiSession._users.getSpecials(t)),c.__subscriptions[t]&&-1!==c.__subscriptions[t].indexOf(e.getChannel())&&n.push("subscriber"),n},o.scrollChat=function(){var t=$(".ember-chat"),n=t.find(".chat-interface").children("span").children(".more-messages-indicator").length;if(!n&&t.length){var o=t.find(".chat-messages"),r=o.children(".tse-scroll-content"),a=r.children(".tse-content").children(".chat-lines").children("div.chat-line");setTimeout(function(){r.length&&(r[0].scrollTop=r[0].scrollHeight)});var s=a.length-e.settings.get("scrollbackAmount");0>=s||a.slice(0,s).each(function(){$(this).remove()})}},o.calculateColor=function(t){var n=/^#[0-9a-f]+$/i;if(n.test(t))for(;"light"===p(t)&&e.settings.get("darkenedMode")===!0||"dark"===p(t)&&e.settings.get("darkenedMode")!==!0;)t=f(t,p(t));return t},function(e,t){var n=t;for(var o in e)e.hasOwnProperty(o)&&t>o&&n++;return n}),S=(o.handleSurrogatePairs=function(e,t){for(var n=u.ucs2.decode(e),o={},r=0;r<n.length;r++)n[r]<=65535||(o[r]=!0);for(var a in t)if(t.hasOwnProperty(a))for(var s=t[a],r=s.length-1;r>=0;r--)for(var i=0;i<s[r].length;i++)s[r][i]=A(o,s[r][i]);return t},o.loadBadges=function(){$("#bttv_volunteer_badges").length||$.getJSON("https://api.betterttv.net/2/badges").done(function(e){var t=$("<style />");t.attr("id","bttv_volunteer_badges"),e.types.forEach(function(e){t.append(".ember-chat .badges .bttv-"+e.name+' { background: url("'+e.svg+'"); background-size: 100%; }'),c.__badgeTypes[e.name]=e}),t.appendTo("head"),e.badges.forEach(function(e){c.__badges[e.name]=e.type})})},o.assignBadges=function(n,o){o=o||{};var r=[],a=t("../legacy-tags")(o);if(-1!==n.indexOf("staff")?r.push({type:"staff",name:"Staff",description:"Twitch Staff"}):-1!==n.indexOf("admin")?r.push({type:"admin",name:"Admin",description:"Twitch Admin"}):-1!==n.indexOf("global_mod")?r.push({type:"global-moderator",name:"GMod",description:"Twitch Global Moderator"}):-1!==n.indexOf("bot")?r.push({type:"bot",name:"Bot",description:"Channel Bot"}):-1===n.indexOf("owner")||a[o.from]?-1===n.indexOf("mod")||a[o.from]||r.push({type:"moderator",name:"Mod",description:"Channel Moderator"}):r.push({type:"broadcaster",name:"Host",description:"Channel Broadcaster"}),a[o.from]&&(a[o.from].mod===!0&&T(o.from)||a[o.from].mod===!1)){var s=a[o.from];s.color&&"action"!==o.style&&(o.color=s.color),s.nickname&&(o.bttvDisplayName=s.nickname),r.unshift({type:s.tagType,name:s.tagName,description:"Grandfathered BetterTTV Swag Tag"})}if(o.from in c.__badges){var i=c.__badges[o.from];r.push({type:"bttv-"+i,name:"",description:c.__badgeTypes[i].description})}return-1!==n.indexOf("turbo")&&r.push({type:"turbo",name:"",description:"Twitch Turbo"}),-1!==n.indexOf("subscriber")&&r.push({type:"subscriber",name:"",description:"Channel Subscriber"}),r.forEach(function(t){return e.settings.get("showJTVTags")===!1&&"Grandfathered BetterTTV Swag Tag"!==t.description?void(t.name=""):void(-1!==["moderator","broadcaster","admin","global-moderator","staff","bot"].indexOf(t.type)&&(t.type="old"+t.type))}),r},o.ban=function(e){return e&&""!==e?i()&&i().tmiRoom?i().tmiRoom.banUser(e):null:!1},o.timeout=function(e,t){return t=t||600,e&&""!==e?i()&&i().tmiRoom?i().tmiRoom.timeoutUser(e+" "+t):null:!1},o.unban=function(e){return e&&""!==e?i()&&i().tmiRoom?i().tmiRoom.unbanUser(e):null:!1}),E=o.massUnban=function(){if(!r.userData.isLoggedIn||r.userData.login!==e.getChannel())return void w("You're not the channel owner.");var t=[];w("Fetching banned users..."),$.ajax({url:"/settings/channel",cache:!1,timeoutLength:6e3,dataType:"html"}).done(function(e){e&&($(e).find("#banned_chatter_list .ban .obj").each(function(){var e=$(this).text().trim();-1===c.__unbannedUsers.indexOf(e)&&-1===t.indexOf(e)&&t.push(e)}),t.length>0?(w("Fetched "+t.length+" banned users."),w(t.length>10?"Starting purge process in 5 seconds. Get ready for a spam fest!":"Starting purge process in 5 seconds."),w("By my calculations, this block of users will take "+(.333*t.length).toFixed(1)+" minutes to unban."),t.length>70&&w("Twitch only provides up to 100 users at a time (some repeat), but this script will cycle through all of the blocks of users."),setTimeout(function(){var e=0;t.forEach(function(t){setTimeout(function(){S(t),c.__unbannedUsers.push(t)},e+=333)}),setTimeout(function(){w("This block of users has been purged. Checking for more.."),E()},e+=333)},5e3)):(w("You have no banned users."),c.__unbannedUsers=[]))})};o.translate=function(e,t,n){var o=window.cookie&&window.cookie.get("language")?window.cookie.get("language"):"en",r=$.param({target:o,q:n});$.getJSON("https://api.betterttv.net/2/translate?"+r).success(function(n){e.replaceWith(l.message(t,n.translation))}).error(function(t){e.text(t.responseJSON&&t.responseJSON.message?t.responseJSON.message:"Translation Error")})}}},{"../bots":1,"../features/channel-state":21,"../helpers/colors":45,"../helpers/debug":46,"../helpers/element":47,"../helpers/regex":49,"../keycodes":50,"../legacy-tags":51,"../vars":64,"./handlers":4,"./store":8,"./templates":10,"./tmi":11,punycode:66}],6:[function(e,t){t.exports=function(e){return'<a href="'+e+'" class="chat-preview" target="_blank">'+e+"</a>"}},{}],7:[function(t,n,o){var r=t("./tmi"),a=t("./store"),s=(o.getRooms=function(){return Object.keys(a.__rooms)},o.getRoom=function(e){if(!a.__rooms[e]){var n=t("./handlers");i(e),r().tmiRoom&&(delete r().tmiRoom._events.message,delete r().tmiRoom._events.clearchat,r().tmiRoom.on("message",s(e).chatHandler),r().tmiRoom.on("clearchat",n.clearChat))}return a.__rooms[e]}),i=o.newRoom=function(n){var o=t("./handlers"),r=null,i=e.getChatController().get("connectedPrivateGroupRooms"),c=e.getChatController().get("currentChannelRoom");if(c.get("id")===n)r=c;else for(var l=0;l<i.length;l++)if(i[l].get("id")===n){r=i[l];break}a.__rooms[n]={name:n,unread:0,emberRoom:r,active:function(){return e.getChatController()&&e.getChatController().currentRoom&&e.getChatController().currentRoom.get("id")===n?!0:!1},messages:[],playQueue:function(){a.__rooms[n].unread=0,o.countUnreadMessages();for(var e=0;e<a.__rooms[n].messages.length;e++){var t=a.__rooms[n].messages[e];o.onPrivmsg(n,t)}},queueMessage:function(t){a.__rooms[n].messages.length>e.settings.get("scrollbackAmount")&&a.__rooms[n].messages.shift(),a.__rooms[n].messages.push(t)},chatHandler:function(e){e.from&&"jtv"!==e.from&&s(n).queueMessage(e),s(n).active()?o.onPrivmsg(n,e):(a.__rooms[n].unread++,o.countUnreadMessages())}}}},{"./handlers":4,"./store":8,"./tmi":11}],8:[function(e,t,n){e("./tmi");n.__rooms={},n.__messageQueue=[],n.__reportedErrors=[],n.__subscriptions={},n.__unbannedUsers=[],n.__channelBots=[],n.__badgeTypes={},n.__badges={},n.displayNames={},n.trackTimeouts={},n.chatters={},n.tabCompleteHistory=[],n.suggestions={matchList:[],lastMatch:""},n.chatHistory=[],n.bttvEmotes={},n.autoCompleteEmotes={},n.__messageTimer=!1,n.currentRoom="",n.activeView=!0},{"./tmi":11}],9:[function(t,n){var o=t("../vars"),r=t("../helpers/debug"),a=t("../keycodes"),s=t("./store"),i=t("./handlers"),c=t("./helpers"),l=t("./rooms"),h=t("./templates"),u=t("../features/override-emotes"),d=t("../features/chat-load-settings"),p=(t("../features/css-loader"),t("../features/anon-chat")),f=n.exports=function(){var n=t("./tmi")();if(p(),e.settings.get("disableUsernameColors")===!0?$(".ember-chat .chat-room").addClass("no-name-colors"):$(".ember-chat .chat-room").removeClass("no-name-colors"),!s.isLoaded){if(e.getChatController().set("showList",!1),n.get("isLoading"))return r.log("chat is still loading"),void setTimeout(function(){f()},1e3);var g=e.storage.getObject("chatSettings");"undefined"==typeof g.showModIcons&&(g.showModIcons=!0,$(".ember-chat .chat-messages").removeClass("hideModIcons"),e.storage.putObject("chatSettings",g)),"undefined"==typeof g.showTimestamps&&(g.showTimestamps=!0,$(".ember-chat .chat-messages").removeClass("hideTimestamps"),e.storage.putObject("chatSettings",g)),g.darkMode===!0&&(g.darkMode=!1,$(".chat-container").removeClass("dark"),e.storage.putObject("chatSettings",g),e.settings.save("darkenedMode",!0)),s.isLoaded=!0,r.log("Loading chat listeners");
for(var m in n.tmiSession._rooms)n.tmiSession._rooms.hasOwnProperty(m)&&(delete n.tmiSession._rooms[m]._events.message,delete n.tmiSession._rooms[m]._events.clearchat,delete n.tmiSession._rooms[m]._events.notice);l.newRoom(e.getChannel()),n.tmiRoom.on("message",l.getRoom(e.getChannel()).chatHandler),n.tmiRoom.on("clearchat",i.clearChat),n.tmiRoom.on("notice",i.notice),n.tmiRoom.on("roomstate",c.parseRoomState),n.channel&&n.set("name",n.channel.get("display_name")),s.currentRoom=e.getChannel(),c.parseRoomState({tags:{"subs-only":n.get("subsOnly"),slow:n.get("slow"),r9k:n.get("r9k")}});var v=e.getChatController().get("connectedPrivateGroupRooms");v&&v.length>0&&v.forEach(function(e){l.newRoom(e.get("id")),e.tmiRoom.on("message",l.getRoom(e.get("id")).chatHandler),e.tmiRoom.on("clearchat",i.clearChat)}),u();for(var b=Object.keys(s.bttvEmotes),y=b.length-1;y>=0;y--){var w=b[y];s.bttvEmotes[w].channelEmote&&delete s.bttvEmotes[w]}if(s.__channelBots=[],$.getJSON("https://api.betterttv.net/2/channels/"+e.getChannel()).done(function(e){e.emotes.forEach(function(t){t.channelEmote=!0,t.urlTemplate=e.urlTemplate.replace("{{id}}",t.id),t.url=t.urlTemplate.replace("{{image}}","1x"),s.bttvEmotes[t.code]=t}),s.__channelBots=e.bots}),c.loadBadges(),d(),$("body").off("mouseover",".chat-line .message a").on("mouseover",".chat-line .message a",function(){var e=$(this),t=encodeURIComponent(e.attr("href"));$.getJSON("https://api.betterttv.net/2/link_resolver/"+t).done(function(t){t.tooltip&&e.is(":hover")&&(e.tipsy({trigger:"manual",gravity:$.fn.tipsy.autoNS,html:!0,title:function(){return t.tooltip}}),e.tipsy("show"))})}).off("mouseout",".chat-line .message a").on("mouseout",".chat-line .message a",function(){$(this).tipsy("hide"),$("div.tipsy").remove()}),$("body").off("mouseover",".chat-line .badges .badge, .chat-line .mod-icons a").on("mouseover",".chat-line .badges .badge, .chat-line .mod-icons a",function(){$(this).tipsy({trigger:"manual",gravity:"sw"}),$(this).tipsy("show")}).off("mouseout",".chat-line .badges .badge, .chat-line .mod-icons a").on("mouseout",".chat-line .badges .badge, .chat-line .mod-icons a",function(){$(this).tipsy("hide"),$("div.tipsy").remove()}),$("body").off("mouseover",".bttv-mod-card button").on("mouseover",".bttv-mod-card button",function(){$(this).tipsy({trigger:"manual",gravity:"s"}),$(this).tipsy("show")}).off("mouseout",".bttv-mod-card button").on("mouseout",".bttv-mod-card button",function(){$(this).tipsy("hide"),$("div.tipsy").remove()}),$("body").off("click",".chat-line .mod-icons .timeout").on("click",".chat-line .mod-icons .timeout",function(){c.timeout($(this).parents(".chat-line").data("sender")),$(this).parent().children(".ban").hide(),$(this).parent().children(".unban").show()}).off("click",".chat-line .mod-icons .ban").on("click",".chat-line .mod-icons .ban",function(){c.ban($(this).parents(".chat-line").data("sender")),$(this).parent().children(".ban").hide(),$(this).parent().children(".unban").show()}).off("click",".chat-line .mod-icons .unban").on("click",".chat-line .mod-icons .unban",function(){c.unban($(this).parents(".chat-line").data("sender")),$(this).parent().children(".ban").show(),$(this).parent().children(".unban").hide()}).off("click",".chat-line .badges .turbo, .chat-line .badges .subscriber").on("click",".chat-line .badges .turbo, .chat-line .badges .subscriber",function(){$(this).hasClass("turbo")?window.open("/products/turbo?ref=chat_badge","_blank"):$(this).hasClass("subscriber")&&window.open(Twitch.url.subscribe(e.getChannel(),"in_chat_subscriber_link"),"_blank")}),$("body").off("click",".chat-line .from").on("click",".chat-line .from",function(){var e=$(this).data("sender")||$(this).parent().data("sender");i.moderationCard(e+"",$(this))}),e.TwitchEmoteSets&&n.product&&n.product.emoticons)for(var y=0;y<n.product.emoticons.length;y++){var w=n.product.emoticons[y];if(w.state&&"active"===w.state&&!e.TwitchEmoteSets[w.emoticon_set]){e.io.giveEmoteTip(e.getChannel());break}}o.loadedDoubleClickTranslation||e.settings.get("dblclickTranslation")===!1||(o.loadedDoubleClickTranslation=!0,$("body").on("dblclick",".chat-line .message",function(){var e=$(this).parent().data("sender"),t=decodeURIComponent($(this).data("raw"));$(this).hasClass("timed-out")?$(this).replaceWith(h.message(e,t)):(c.translate($(this),e,t),$(this).text("Translating..")),$("div.tipsy").remove()}));var k=$(".ember-chat .chat-interface"),_=k.find("textarea"),C=k.find(".send-chat-button");_.off("keydown").off("keyup").off("mouseup"),C.off(),_.on("keyup",function(e){e.which!==a.Tab&&e.which!==a.Shift&&(c.tabCompletion(e),c.whisperReply(e))}),_.on("keydown",function(t){if(t.which===a.Enter){var n=_.val().trim(),o=!1;if(t.shiftKey||!n.length)return t.preventDefault();var r=k.find(".suggestions");if(r.length)return r.find(".highlighted").children().click(),t.preventDefault();"/"===n.charAt(0)&&(o=i.commands(n));var l=n.toLowerCase().split(" ");return l.indexOf("twitch")>-1&&l.indexOf("amazon")>-1&&l.indexOf("google")>-1&&c.serverMessage('<img src="https://cdn.betterttv.net/special/twitchtrollsgoogle.gif"/>'),o||c.sendMessage(n),e.settings.get("chatLineHistory")===!0&&(-1!==s.chatHistory.indexOf(n)&&s.chatHistory.splice(s.chatHistory.indexOf(n),1),s.chatHistory.unshift(n)),_.val(""),t.preventDefault()}var r=k.find(".suggestions");r.length&&t.which!==a.Shift&&r.remove(),(t.which===a.Tab&&!t.ctrlKey||/^(\/|.)w $/.test(n))&&(c.tabCompletion(t),t.preventDefault()),c.chatLineHistory(_,t)}),C.on("click",function(){var t=_.val().trim(),n=!1;t.length&&("/"===t.charAt(0)&&(n=i.commands(t)),n||c.sendMessage(t),e.settings.get("chatLineHistory")===!0&&(-1!==s.chatHistory.indexOf(t)&&s.chatHistory.splice(s.chatHistory.indexOf(t),1),s.chatHistory.unshift(t)),_.val(""))}),$(".ember-chat .chat-messages .chat-line").remove(),$.getJSON("https://api.betterttv.net/2/channels/"+encodeURIComponent(e.getChannel())+"/history").done(function(t){t.messages.length&&t.messages.forEach(function(t){var n=[];t.user.name===t.channel.name&&n.push("owner"),e.chat.helpers.isIgnored(t.user.name)||(t=e.chat.templates.privmsg(!1,!1,!1,!1,{message:t.message,time:new Date(t.date.replace("T"," ").replace(/\.[0-9]+Z/," GMT")).toLocaleTimeString().replace(/^(\d{0,2}):(\d{0,2}):(.*)$/i,"$1:$2"),nickname:t.user.displayName,sender:t.user.name,badges:e.chat.helpers.assignBadges(n),color:e.chat.helpers.calculateColor(t.user.color),emotes:t.parsedEmotes}),$(".ember-chat .chat-messages .tse-content .chat-lines").append(t))})}).always(function(){c.serverMessage("<center><small>BetterTTV v"+e.info.version+" Loaded.</small></center>"),c.serverMessage("Welcome to "+c.lookupDisplayName(e.getChannel())+"'s chat room!",!0),e.chat.helpers.scrollChat()}),e.io.joinChannel(),s.chatters={},s.chatters[e.getChannel()]={lastWhisper:0},s.__messageTimer||(s.__messageTimer=setInterval(i.shiftQueue,500)),$(window).off("blur focus").on("blur focus",function(e){var t=$(this).data("prevType");if(t!=e.type)switch(e.type){case"blur":s.activeView=!1;break;case"focus":$(".chat-interface textarea").focus(),s.activeView=!0}$(this).data("prevType",e.type)}),$(window).off("keydown").on("keydown",function(t){var n=t.keyCode||t.which;if($(".bttv-mod-card").length&&e.settings.get("modcardsKeybinds")===!0){var o=$(".bttv-mod-card").data("user");switch(n){case a.Esc:$(".bttv-mod-card").remove();break;case a.t:c.timeout(o),$(".bttv-mod-card").remove();break;case a.p:c.timeout(o,1),$(".bttv-mod-card").remove();break;case a.a:c.sendMessage("!permit "+o),$(".bttv-mod-card").remove();break;case a.u:c.sendMessage("/unban "+o),$(".bttv-mod-card").remove();break;case a.b:c.ban(o),$(".bttv-mod-card").remove();break;case a.i:c.sendMessage("/ignore "+o),$(".bttv-mod-card").remove();break;case a.w:t.preventDefault();var r=$(".ember-chat .chat-interface").find("textarea");r.val("/w "+o+" "),r.focus(),$(".bttv-mod-card").remove()}}}),$(".tse-content").on("dblclick",".chat-line .from",function(){if(e.settings.get("dblClickAutoComplete")!==!1){var t=$(this).text();t&&$(".ember-chat .chat-interface").find("textarea").val(t+", ")}})}}},{"../features/anon-chat":13,"../features/chat-load-settings":22,"../features/css-loader":28,"../features/override-emotes":43,"../helpers/debug":46,"../keycodes":50,"../vars":64,"./handlers":4,"./helpers":5,"./rooms":7,"./store":8,"./templates":10,"./tmi":11}],10:[function(t,n,o){{var r=t("./tmi"),a=t("./store"),s=o.badge=function(t,n,o){return'<div class="'+t+(e.settings.get("alphaTags")&&-1!==["admin","global-moderator","staff","broadcaster","moderator","turbo","ign"].indexOf(t)?" alpha"+(e.settings.get("darkenedMode")?"":" invert"):"")+' badge" title="'+o+'">'+n+"</div> "},i=o.badges=function(e){var t='<span class="badges">';return e.forEach(function(e){t+=s(e.type,e.name,e.description)}),t+="</span>"},c=o.from=function(t,n){return"<span "+(n?'style="color: '+n+';" ':"")+'class="from">'+u(e.storage.getObject("nicknames")[t.toLowerCase()]||t)+'</span><span class="colon">:</span>'+("jtv"!==t?"&nbsp;<wbr></wbr>":"")},l=o.timestamp=function(e){return'<span class="timestamp"><small>'+e+"</small></span>"},h=o.modicons=function(){return'<span class="mod-icons"><a class="timeout" title="Timeout">Timeout</a><a class="ban" title="Ban">Ban</a><a class="unban" title="Unban" style="display: none;">Unban</a></span>'},u=o.escape=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")},d=o.linkify=function(e){var t=/(?:https?:\/\/)?(?:[-a-zA-Z0-9@:%_\+~#=]+\.)+[a-z]{2,6}\b(?:[-a-zA-Z0-9@:%_\+.~#?&\/=]*)/gi;return e.replace(t,function(e){if(/\x02/.test(e))return e;if(e.indexOf("@")>-1&&(-1===e.indexOf("/")||e.indexOf("@")<e.indexOf("/")))return'<a href="mailto:'+e+'">'+e+"</a>";var t=e.replace(/^(?!(?:https?:\/\/|mailto:))/i,"http://");return'<a href="'+t+'" target="_blank">'+e+"</a>"})},p=o.emoticonBTTV=function(e){var t=e.channel?'data-channel="'+e.channel+'" ':"";return'<img class="emoticon bttv-emo-'+e.id+'" src="'+e.urlTemplate.replace("{{image}}","1x")+'" srcset="'+e.urlTemplate.replace("{{image}}","2x")+' 2x" '+t+'data-regex="'+encodeURIComponent(e.code)+'" />'},f=o.emoticon=function(t,n){return 15>t&&e.settings.get("showMonkeyEmotes")===!0?'<img class="emoticon ttv-emo-'+t+'" src="'+g(t)+'" data-id="'+t+'" data-regex="'+encodeURIComponent(n)+'" />':'<img class="emoticon ttv-emo-'+t+'" src="https://static-cdn.jtvnw.net/emoticons/v1/'+t+'/1.0" srcset="https://static-cdn.jtvnw.net/emoticons/v1/'+t+'/2.0 2x" data-id="'+t+'" data-regex="'+encodeURIComponent(n)+'" />'},g=(o.emoticonCss=function(e,t){var n="";return e.height>18&&(n="margin: -"+(e.height-18)/2+"px 0px"),".emo-"+t+' {background-image: url("'+e.url+'");height: '+e.height+"px;width: "+e.width+"px;"+n+"}"},o.jtvEmoticonize=function(e){var t=["https://cdn.betterttv.net/emotes/jtv/happy.gif","https://cdn.betterttv.net/emotes/jtv/sad.gif","https://cdn.betterttv.net/emotes/mw.png","https://cdn.betterttv.net/emotes/jtv/angry.gif","https://cdn.betterttv.net/emotes/jtv/bored.gif","https://cdn.betterttv.net/emotes/jtv/drunk.gif","https://cdn.betterttv.net/emotes/jtv/cool.gif","https://cdn.betterttv.net/emotes/jtv/surprised.gif","https://cdn.betterttv.net/emotes/jtv/horny.gif","https://cdn.betterttv.net/emotes/jtv/skeptical.gif","https://cdn.betterttv.net/emotes/jtv/wink.gif","https://cdn.betterttv.net/emotes/jtv/raspberry.gif","https://cdn.betterttv.net/emotes/jtv/winkberry.gif","https://cdn.betterttv.net/emotes/jtv/pirate.gif"];return t[e-1]}),m=o.emoticonize=function(e,t){if(!t)return[e];var n=[],o=[];return Object.keys(t).forEach(function(e){for(var n=t[e],r=n.length-1;r>=0;r--)o.push({id:e,first:n[r][0],last:n[r][1]})}),o.sort(function(e,t){return t.first-e.first}),o.forEach(function(t){var o=e.slice(t.first,t.last+1);n.unshift(e.slice(t.last+1)),n.unshift([f(t.id,o)]),e=e.slice(0,t.first)}),n.unshift(e),n},v=o.bttvEmoticonize=function(n,o,a){if(a.restrictions){if(a.restrictions.channels.length&&-1===a.restrictions.channels.indexOf(e.getChannel()))return o;if(a.restrictions.games.length&&r().channel&&-1===a.restrictions.games.indexOf(r().channel.game))return o;var s=t("./helpers").getEmotes(n);if(a.restrictions.emoticonSet&&-1===s.indexOf(a.restrictions.emoticonSet))return o}return o.replace(a.code,p(a))},b=o.bttvMessageTokenize=function(t,n){for(var o=n.split(" "),r=0;r<o.length;r++){var s=o[r];if(e.settings.get("chatImagePreview")===!0){var i=new RegExp("(https?://.)([a-z-_0-9/:.%+]*.(jpg|jpeg|png|gif))","i");if(i.test(s)){s=e.chat.imagePreview(s),o[r]=s;continue}}var c=s.replace(/(^[~!@#$%\^&\*\(\)]+|[~!@#$%\^&\*\(\)]+$)/g,""),l=null;a.bttvEmotes.hasOwnProperty(s)?l=a.bttvEmotes[s]:a.bttvEmotes.hasOwnProperty(c)&&(l=a.bttvEmotes[c]),l&&l.urlTemplate&&e.settings.get("bttvEmotes")===!0&&("png"===l.imageType||"gif"===l.imageType&&e.settings.get("bttvGIFEmotes")===!0)?s=v(t,s,l):(s=u(s),s=d(s)),o[r]=s}return o.join(" ")},y=(o.moderationCard=function(e,n,o){var r=t("../templates/moderation-card");return r({user:e,top:n,left:o})},o.suggestions=function(e,n){var o=t("../templates/chat-suggestions");return o({suggestions:e,index:n})},o.message=function(e,t,n,o){o=o||!1;var r=encodeURIComponent(t);if("jtv"!==e){for(var a=m(t,n),s=0;s<a.length;s++)a[s]="string"==typeof a[s]?b(e,a[s]):a[s][0];t=a.join(" ")}return'<span class="message" '+(o?'style="color: '+o+'" ':"")+'data-raw="'+r+'" data-emotes="'+(n?encodeURIComponent(JSON.stringify(n)):"false")+'">'+t+"</span>"}),w=(o.privmsg=function(e,t,n,o,r){return'<div class="chat-line'+(e?" highlight":"")+(t?" action":"")+(n?" admin":"")+'" data-sender="'+r.sender+'">'+l(r.time)+" "+(o?h():"")+" "+i(r.badges)+c(r.nickname,r.color)+y(r.sender,r.message,r.emotes,t&&!e?r.color:!1)+"</div>"},o.whisperName=function(e,t,n,o,r,a){return'<span style="color: '+r+';" class="from" data-sender="'+e+'">'+u(n)+'</span><svg class="svg-whisper-arrow" height="10px" version="1.1" width="16px"><polyline points="6 2, 10 6, 6 10, 6 2"></polyline></svg><span style="color: '+a+';" class="from" data-sender="'+t+'">'+u(o)+'</span><span class="colon">:</span>&nbsp;<wbr></wbr>'});o.whisper=function(e){return'<div class="chat-line whisper" data-sender="'+e.sender+'">'+l(e.time)+" "+w(e.sender,e.receiver,e.from,e.to,e.fromColor,e.toColor)+y(e.sender,e.message,e.emotes,!1)+"</div>"}}},{"../templates/chat-suggestions":58,"../templates/moderation-card":60,"./helpers":5,"./store":8,"./tmi":11}],11:[function(t,n){n.exports=function(){return e.getChatController()?e.getChatController().currentRoom:!1}},{}],12:[function(t){var n=(t("./keycodes"),t("./helpers/debug")),o=t("./vars"),r=t("./twitch-api"),a=t("./socketio"),s=t("./storage"),i=t("./settings");e.info={version:"6.8",release:41,versionString:function(){return e.info.version+"R"+e.info.release}},e.TwitchAPI=r,e.vars=o,e.storage=new s,e.settings=new i,e.getChannel=function(){return window.Ember&&window.App&&"channel.index"===App.__container__.lookup("controller:application").get("currentRouteName")?App.__container__.lookup("controller:channel").get("id"):e.getChatController()&&e.getChatController().currentRoom?e.getChatController().currentRoom.id:window.PP&&PP.channel?PP.channel:""},e.getChatController=function(){return window.Ember&&window.App&&App.__container__.lookup("controller:chat")?App.__container__.lookup("controller:chat"):!1},e.notify=function(t,n,o,r,a,s){var n=n||"Notice",o=o||"",r=r||"https://cdn.betterttv.net/style/logos/bttv_logo.png",t=t||"",a=a||"bttv_"+t,a="bttv_"+a.toLowerCase().replace(/[^\w_]/g,""),s=s||!1;if(!$("body#chat").length){var i=function(t,n,o,r,a,s){var i=new window.Notification(n,{icon:r,body:t,tag:a});s===!1&&(i.onshow=function(){setTimeout(function(){i.close()},1e4)}),""!==o&&(i.onclick=function(){window.open(o),i.close()}),e.storage.pushObject("bttvNotifications",a,{expire:Date.now()+6e4}),setTimeout(function(){e.storage.spliceObject("bttvNotifications",a)},6e4)};if(e.settings.get("desktopNotifications")===!0&&(window.Notification&&"granted"===Notification.permission||window.webkitNotifications&&0===webkitNotifications.checkPermission())){var c=e.storage.getObject("bttvNotifications");for(var l in c)if(c.hasOwnProperty(l)){var h=c[l];if(l===a){if(!(h.expire<Date.now()))return;e.storage.spliceObject("bttvNotifications",l)}}i(t,n,o,r,a,s)}else t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br /><br />").replace(/Click here(.*)./,'<a style="color: white;" target="_blank" href="'+o+'">Click here$1.</a>'),$.gritter.add({title:n,image:r,text:t,sticky:s})}},e.chat=t("./chat"),String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var c=t("./features/clear-clutter"),l=t("./features/channel-reformat"),h=t("./features/brand"),u=t("./features/beta-chat"),d=t("./features/check-messages"),p=t("./features/directory-functions"),f=t("./features/check-following"),g=t("./features/check-broadcast-info"),m=t("./features/handle-background"),v=t("./features/darken-page"),b=t("./features/split-chat"),y=t("./features/flip-dashboard"),w=t("./features/format-dashboard"),k=t("./features/dashboard-channelinfo"),_=t("./features/giveaway-compatibility"),C=t("./features/handle-twitchchat-emotes"),x=t("./features/emoticon-text-in-clipboard"),T=t("./features/create-settings");enableImagePreview=t("./features/image-preview").enablePreview,enableTheatreMode=t("./features/auto-theatre-mode"),hostButtonBelowVideo=t("./features/host-btn-below-video");var A=function(){n.log("Modifying Chat Functionality"),e.getChatController()&&e.getChannel()&&e.chat.takeover()},S=function(t){if(t=t||0,!(t>9)){if("undefined"==typeof window.jQuery)return n.log("jQuery is undefined."),void setTimeout(function(){S(t+1)},1e3);var o=window.jQuery;e.jQuery=o,E()}},E=function(){if(window.Ember){var t=0,r=function(e,n){var n=n||0;n>5&&e(!1),setTimeout(function(){0===t?e(!0):r(e,++n)},1e3)};Ember.subscribe("render",{before:function(){t++},after:function(n,a,s){if(t--,s.template)switch("channel.index"!==App.__container__.lookup("controller:application").get("currentRouteName")&&$("#main_col").removeAttr("style"),s.template){case"shared/right-column":r(function(t){t&&(e.chat.store.isLoaded=!1,u(),A())});break;case"channel/index":r(function(t){t&&(m(),c(),l(),hostButtonBelowVideo(),App.__container__.lookup("controller:channel").get("theatreMode")===!1&&e.settings.get("autoTheatreMode")===!0&&enableTheatreMode(),$(window).trigger("resize"),setTimeout(function(){$(window).trigger("resize")},3e3))});break;case"channel/profile":r(function(e){e&&(o.emotesLoaded=!1,u(),A(),l(),$(window).trigger("resize"))});break;case"directory/following":r(function(e){e&&p()})}}})}$(document).ready(function(){T(),e.settings.load(),n.log("BTTV v"+e.info.versionString()),n.log("CALL init "+document.URL),e.io=new a,c(),l(),g(),h(),v(),b(),y(),w(),d(),f(),_(),k(),p(),C(),x(),hostButtonBelowVideo(),e.settings.get("chatImagePreview")===!0&&enableImagePreview(),e.settings.get("autoTheatreMode")===!0&&enableTheatreMode(),$(window).trigger("resize"),setTimeout(function(){l(),o.userData.isLoggedIn=Twitch.user.isLoggedIn(),o.userData.login=Twitch.user.login(),$(window).trigger("resize")},3e3),setTimeout(A,3e3),setTimeout(p,3e3),function(e,t,n,o,r,a,s){e.GoogleAnalyticsObject=r,e[r]=e[r]||function(){(e[r].q=e[r].q||[]).push(arguments)},e[r].l=1*new Date,a=t.createElement(n),s=t.getElementsByTagName(n)[0],a.async=1,a.src=o,s.parentNode.insertBefore(a,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","__bttvga"),__bttvga("create","UA-39733925-4",{cookieName:"__bttvga"}),__bttvga("send","pageview"),function(e){e.gritter={},e.gritter.options={position:"top-left",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3},e.gritter.add=function(e){try{return t.add(e||{})}catch(n){var o="Gritter Error: "+n;"undefined"!=typeof console&&console.error?console.error(o,e):alert(o)}},e.gritter.remove=function(e,n){t.removeSpecific(e,n||{})},e.gritter.removeAll=function(e){t.stop(e||{})};var t={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<div class="gritter-close"></div>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(n){if("string"==typeof n&&(n={text:n}),!n.text)throw'You must supply "text" parameter.';this._is_setup||this._runSetup();var o=n.title,r=n.text,a=n.image||"",s=n.sticky||!1,i=n.class_name||e.gritter.options.class_name,c=e.gritter.options.position,l=n.time||"";this._verifyWrapper(),this._item_count++;var h=this._item_count,u=this._tpl_item;e(["before_open","after_open","before_close","after_close"]).each(function(o,r){t["_"+r+"_"+h]=e.isFunction(n[r])?n[r]:function(){}}),this._custom_timer=0,l&&(this._custom_timer=l);var d=""!=a?'<img src="'+a+'" class="gritter-image" />':"",p=""!=a?"gritter-with-image":"gritter-without-image";if(o=o?this._str_replace("[[title]]",o,this._tpl_title):"",u=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[o,r,this._tpl_close,d,this._item_count,p,i],u),this["_before_open_"+h]()===!1)return!1;e("#gritter-notice-wrapper").addClass(c).append(u);var f=e("#gritter-item-"+this._item_count);return f.fadeIn(this.fade_in_speed,function(){t["_after_open_"+h](e(this))}),s||this._setFadeTimer(f,h),e(f).bind("mouseenter mouseleave",function(n){"mouseenter"==n.type?s||t._restoreItemIfFading(e(this),h):s||t._setFadeTimer(e(this),h),t._hoverState(e(this),n.type)}),e(f).find(".gritter-close").click(function(){t.removeSpecific(h,{},null,!0)}),h},_countRemoveWrapper:function(t,n,o){n.remove(),this["_after_close_"+t](n,o),0==e(".gritter-item-wrapper").length&&e("#gritter-notice-wrapper").remove()},_fade:function(e,n,o,r){var o=o||{},a="undefined"!=typeof o.fade?o.fade:!0,s=o.speed||this.fade_out_speed,i=r;this["_before_close_"+n](e,i),r&&e.unbind("mouseenter mouseleave"),a?e.animate({opacity:0},s,function(){e.animate({height:0},300,function(){t._countRemoveWrapper(n,e,i)})}):this._countRemoveWrapper(n,e)},_hoverState:function(e,t){"mouseenter"==t?(e.addClass("hover"),e.find(".gritter-close").show()):(e.removeClass("hover"),e.find(".gritter-close").hide())},removeSpecific:function(t,n,o,r){if(!o)var o=e("#gritter-item-"+t);this._fade(o,t,n||{},r)},_restoreItemIfFading:function(e,t){clearTimeout(this["_int_id_"+t]),e.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in e.gritter.options)this[opt]=e.gritter.options[opt];this._is_setup=1},_setFadeTimer:function(e,n){var o=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+n]=setTimeout(function(){t._fade(e,n)},o)},stop:function(t){var n=e.isFunction(t.before_close)?t.before_close:function(){},o=e.isFunction(t.after_close)?t.after_close:function(){},r=e("#gritter-notice-wrapper");n(r),r.fadeOut(function(){e(this).remove(),o()})},_str_replace:function(e,t,n,o){var r=0,a=0,s="",i="",c=0,l=0,h=[].concat(e),u=[].concat(t),d=n,p=u instanceof Array,f=d instanceof Array;for(d=[].concat(d),o&&(this.window[o]=0),r=0,c=d.length;c>r;r++)if(""!==d[r])for(a=0,l=h.length;l>a;a++)s=d[r]+"",i=p?void 0!==u[a]?u[a]:"":u[0],d[r]=s.split(h[a]).join(i),o&&d[r]!==s&&(this.window[o]+=(s.length-d[r].length)/h[a].length);return f?d:d[0]},_verifyWrapper:function(){0==e("#gritter-notice-wrapper").length&&e("body").append(this._tpl_wrap)}}}($),function(e){e.fn.drags=function(t){if(t=e.extend({handle:"",cursor:"move",el:""},t),""===t.handle)var n=this;else var n=this.find(t.handle);return n.css("cursor",t.cursor).on("mousedown",function(n){if(""===t.handle)var o=e(this).addClass("bttv-draggable");else if(""===t.el)var o=e(this).addClass("active-handle").parent().addClass("bttv-draggable");else{e(this).addClass("active-handle");var o=e(t.el).addClass("bttv-draggable")}var r=o.css("z-index"),a=o.outerHeight(),s=o.outerWidth(),i=o.offset().top+a-n.pageY,c=o.offset().left+s-n.pageX;o.css("z-index",1e3).parents().on("mousemove",function(t){e(".bttv-draggable").offset({top:t.pageY+i-a,left:t.pageX+c-s}).on("mouseup",function(){e(this).removeClass("bttv-draggable").css("z-index",r)})}),n.preventDefault()}).on("mouseup",function(){""===t.handle?e(this).removeClass("bttv-draggable"):(e(this).removeClass("active-handle"),e(t.el).removeClass("bttv-draggable"))})}}(jQuery),function(e){e.fn.konami=function(t){var n=[],o={left:37,up:38,right:39,down:40,a:65,b:66},r=e.extend({code:["up","up","down","down","left","right","left","right","b","a"],callback:function(){}},t),a=r.code,s=[];$.each(a,function(e){void 0!==a[e]&&void 0!==o[a[e]]?s.push(o[a[e]]):void 0!==a[e]&&"number"==typeof a[e]&&s.push(a[e])}),$(document).keyup(function(e){var t=e.keyCode?e.keyCode:e.charCode;n.push(t),n.toString().indexOf(s)>=0&&(n=[],r.callback($(this)))})}}($),$(window).konami({callback:function(){$("#bttvSettingsPanel .konami").each(function(){$(this).show()})}})})};return-1!==document.URL.indexOf("receiver.html")||-1!==document.URL.indexOf("cbs_ad_local.html")?void n.log("HTML file called by Twitch."):location.pathname.match(/^\/(.*)\/popout/)?void n.log("Popout player detected."):window.Twitch&&window.Twitch.video&&window.Twitch.api&&window.Twitch.user?void(window.BTTVLOADED!==!0&&(n.log("BTTV LOADED "+document.URL),BTTVLOADED=!0,S())):void n.log("window.Twitch not detected.")},{"./chat":2,"./features/auto-theatre-mode":15,"./features/beta-chat":16,"./features/brand":17,"./features/channel-reformat":19,"./features/check-broadcast-info":23,"./features/check-following":24,"./features/check-messages":25,"./features/clear-clutter":26,"./features/create-settings":27,"./features/darken-page":29,"./features/dashboard-channelinfo":30,"./features/directory-functions":31,"./features/emoticon-text-in-clipboard":33,"./features/flip-dashboard":34,"./features/format-dashboard":35,"./features/giveaway-compatibility":36,"./features/handle-background":37,"./features/handle-twitchchat-emotes":38,"./features/host-btn-below-video":39,"./features/image-preview":40,"./features/split-chat":44,"./helpers/debug":46,"./keycodes":50,"./settings":53,"./socketio":54,"./storage":55,"./twitch-api":63,"./vars":64}],13:[function(t,n){var o=(t("../helpers/debug"),t("../vars")),r=window.location.search&&window.location.search.indexOf("bttvAnonChat=true")>-1;n.exports=function(t){if(o.userData.isLoggedIn){var n=!1;n=r?!0:"boolean"==typeof t?t:e.settings.get("anonChat");var a=e.chat.tmi();if(a){var s=a.tmiSession;if(s){var i=a.tmiRoom;if(i)try{var c=s._connections.prod;if(!c)return;var l=c._opts;n?l.nickname===o.userData.login&&(l.nickname="justinfan12345",i._showAdminMessage("BetterTTV: [Anon Chat] Logging you out of chat.."),e.chat.store.ignoreDC=!0,c._send("QUIT")):l.nickname!==o.userData.login&&(l.nickname=o.userData.login,i._showAdminMessage("BetterTTV: [Anon Chat] Logging you back into chat.."),e.chat.store.ignoreDC=!0,c._send("QUIT"))}catch(h){i._showAdminMessage("BetterTTV: [Anon Chat] We encountered an error anonymizing your chat. You won't be hidden in this channel.")}}}}}},{"../helpers/debug":46,"../vars":64}],14:[function(t,n){var o,r=t("../helpers/debug");n.exports=function(){e.settings.get("highlightFeedback")===!0&&(o||(r.log("loading audio feedback sound"),o=new Audio("https://cdn.betterttv.net/style/sounds/ts-tink.ogg")),o.load(),o.play())}},{"../helpers/debug":46}],15:[function(e,t){e("../helpers/debug");t.exports=function(){window.Ember&&window.App&&"channel.index"===App.__container__.lookup("controller:application").get("currentRouteName")&&App.__container__.lookup("controller:channel").send("toggleTheatre")}},{"../helpers/debug":46}],16:[function(t,n){var o=t("../helpers/debug"),r=t("../vars");n.exports=function(){if(e.settings.get("bttvChat")===!0&&r.userData.isLoggedIn){if($("body#chat").length||$('body[data-page="ember#chat"]').length)return;if(o.log("Running Beta Chat"),!r.betaChatLoaded){r.betaChatLoaded=!0,$.getJSON("https://chat.betterttv.net/login.php?onsite=true&verify=true&callback=?",function(e){e.status===!0?o.log("Logged into BTTV Chat"):($.getJSON("https://chat.betterttv.net/login.php?onsite=true&user="+r.userData.login+"&callback=?"),o.log("Not logged into BTTV Chat")),setTimeout(function(){var e=document.createElement("script");e.setAttribute("src","https://chat.betterttv.net/chat/cometchatjs.php"),e.setAttribute("type","text/javascript"),$("body").append(e)},5e3)});var t=document.createElement("link");t.setAttribute("href","https://chat.betterttv.net/chat/cometchatcss.php"),t.setAttribute("type","text/css"),t.setAttribute("id","arrowchat_css"),t.setAttribute("rel","stylesheet"),$("head").append(t)}if(!e.getChannel())return;$("body").append("<style>.ember-chat .chat-interface { height: 140px !important; } .ember-chat .chat-messages { bottom: 140px; } .ember-chat .chat-settings { bottom: 80px; } .ember-chat .emoticon-selector { bottom: 142px !important; }</style>")}}},{"../helpers/debug":46,"../vars":64}],17:[function(t,n){var o=t("../helpers/debug"),r=t("./beta-chat");n.exports=function(){if(o.log("Branding Site with Better & Importing Styles"),$("#header_logo").length){$("#header_logo").html('<img alt="TwitchTV" src="https://cdn.betterttv.net/style/logos/black_twitch_logo.png">');var t=$("<img />");t.attr("src","https://cdn.betterttv.net/style/logos/logo_icon.png"),t.css({"z-index":9e3,"margin-left":"-82px","margin-top":"-10px","float":"left",height:18,position:"absolute"}),$("#header_logo").append(t)}if($("#large_nav #logo").length){var t=$("<img />");t.attr("src","https://cdn.betterttv.net/style/logos/logo_icon.png"),t.css({"z-index":9e3,"margin-left":"-76px","margin-top":"-16px","float":"left",position:"absolute"}),$("#large_nav #logo").append(t)}$(".column .content #you").append('<a class="bttvSettingsIcon" href="#"></a>'),$(".bttvSettingsIcon").click(function(e){e.preventDefault(),$("#chat_settings_dropmenu").hide(),$("#bttvSettingsPanel").show("slow")});var n=document.createElement("link");n.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv.css?"+e.info.versionString()),n.setAttribute("type","text/css"),n.setAttribute("rel","stylesheet"),$("body").append(n),e.settings.get("showChatIndentation")!==!1&&($addCSS=$("<style></style>"),$addCSS.attr("id","bttvChatIndentation"),$addCSS.html("#chat_line_list .line p { padding-left: 16px;text-indent: -16px; }"),$("body").append($addCSS)),$("body#chat").css("overflow-y","hidden"),$("#chat_loading_spinner").attr("src","data:image/gif;base64,R0lGODlhFgAWAPMGANfX1wAAADc3N1tbW6Ojo39/f2tra8fHx9nZ2RsbG+np6SwsLEtLS4eHh7q6ugAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hoiQ3JlYXRlZCB3aXRoIENoaW1wbHkuY29tIgAh+QQJCgAGACwAAAAAFgAWAAAEbNCESY29OEvBRdDgFXReGI7dZ2oop65YWypIjSgGbSOW/CGAIICnEAIOPdLPSDQiNykDUNgUPn1SZs6ZjE6D1eBVmaVurV1XGXwWp0vfYfv4XpqLaKg6HqbrZzs4OjZ1MBlYhiJkiYWMfy+GEQAh+QQJCgAGACwAAAAAFgAWAAAEctDIKYO9NKe9lwlCKAQZlQzo4IEiWUpnuorjC6fqR7tvjM4tgwJBJN5kuqACwGQef8kQadkEPHMsqbBqNfiwu231CtRSm+Ro7ez04sprbjobH7uR9Kn8Ds2L0XxgSkVGgXA8JV+HNoZqiBocCYuMJX4vEQAh+QQJCgAAACwAAAAAFgAWAAAEcxDISWu4uNLEOwhCKASSGA5AMqxD8pkkIBR0gaqsC4rxXN+s1otXqtlSQR2s+EPmhqGeEfjcRZk06kpJlE2dW+gIe8SFrWNv0yxES9dJ8TsLbi/VdDb3ii/H3WRadl0+eX93hX5ViCaCe2kaKR0ccpGWlREAIfkECQoAAQAsAAAAABYAFgAABHUwyEmrvTisxHlmQigw2mAOiWSsaxMwRVyQy4mqRE64sEzbqYBBt3vJZqVTcKjjHX9KXNPoS5qWRGe1FhVmqTHoVZrThq0377R35o7VZTDSnWbG2XMguYgX1799aFhrT4J7ZnldLC1yfkEXICKOGRcbHY+UlBEAIfkECQoAAQAsAAAAABYAFgAABHIwyEmrvThrOoQXTFYYpFEEQ6EWgkS8rxMUMHGmaxsQR3/INNhtxXL5frPaMGf0AZUooo7nTAqjzN3xecWpplvra/lt9rhjbFlbDaa9RfZZbFPHqXN3HQ5uQ/lmSHpkdzVoe1IiJSZ2OhsTHR8hj5SVFREAIfkECQoAAQAsAAAAABYAFgAABGowyEmrvTjrzWczIJg5REk4QWMShoQAMKAExGEfRLq2QQzPtVtOZeL5ZLQbTleUHIHK4c7pgwqZJWM1eSVmqTGrTdrsbYNjLAv846a9a3PYvYRr5+j6NPDCR9U8FyQmKHYdHiEih4uMjRQRACH5BAkKAAEALAAAAAAWABYAAARkMMhJq7046807d0QYSkhZKoFiIqhzvAchATSNIjWABC4sBznALbfrvX7BYa0Ii81yShrT96xFdbwmEhrALbNUINcrBR+rti7R7BRb1V9jOwkvy38rVmrV0nokICI/f4SFhocSEQAh+QQJCgABACwAAAAAFgAWAAAEWjDISau9OOvNu7dIGCqBIiKkeUoH4AIk8gJIOR/sHM+1cuev3av3C7SCAdnQ9sIZdUke0+U8uoQuYhN4jS592ydSmZ0CqlAyzYweS8FUyQlVOqXmn7x+z+9bIgA7"),r()
}},{"../helpers/debug":46,"./beta-chat":16}],18:[function(e,t){{var n=e("../../helpers/debug"),o=e("../../vars"),r=[".dynamic-player",".dynamic-target-player"],a=[".dynamic-player object",".dynamic-player video",".dynamic-player iframe",".dynamic-target-player object",".dynamic-target-player video",".dynamic-target-player iframe"],s=function(e){return r.join(", ")+", "+a.join(", ")+" { width: 100% !important; height: "+e+"px !important; }"},i=function(){for(var e=0;e<a.length;e++){var t=a[e];if($(t).length)return.5625*$(t).width()+30}return-1};t.exports=function(){if(0!==$("#main_col #channel").length&&0!==$("#right_col").length){n.log("Page resized");var e=$("#hostmode").length,t=$("#bttvPlayerStyle");t.length||(t=$("<style></style>"),t.attr("id","bttvPlayerStyle"),$("body").append(t)),$("#main_col").css(0==o.chatWidth?{marginRight:"0px"}:{marginRight:$("#right_col").width()+"px"});var r=$(window).height(),a=i();if(-1!==a){var c;if(e){var l=$(".hostmode-title-container").outerHeight(!0),h=$(".target-meta").outerHeight(!0),u=$("#hostmode .channel-actions").outerHeight(!0),d=$(".close-hostmode").outerHeight(!0);c=l+h+u+d+33,$(".target-frame").css("height",$(window).height())}else{var h=$("#broadcast-meta").outerHeight(!0),u=$(".stats-and-actions").outerHeight();c=h+u}var p=c+a;t.html($(window).height()>p?s(a):s(r-c)),e||$("#channel_panels").masonry("reload")}}}}},{"../../helpers/debug":46,"../../vars":64}],19:[function(t,n){var o=t("../../helpers/debug"),r=t("../../keycodes"),a=t("../../vars"),s=t("./handle-resize"),i=t("./twitchcast");n.exports=function(){if(0!==$("#main_col #channel").length&&0!==$("#right_col").length){if(o.log("Reformatting Channel Page"),i(),!a.loadedChannelResize){a.loadedChannelResize=!0;var t=!1;$(document).keydown(function(e){e.keyCode===r.r&&e.altKey&&$(window).trigger("resize")}),$(document).mouseup(function(n){t!==!1&&(chatWidthStartingPoint&&chatWidthStartingPoint===n.pageX?"none"!==$("#right_col").css("display")&&($("#right_col").css({display:"none"}),$("#right_close").removeClass("open").addClass("closed"),a.chatWidth=0):a.chatWidth=$("#right_col").width(),e.settings.save("chatWidth",a.chatWidth),t=!1,s())}),$(document).on("mousedown","#right_close, #right_col .resizer",function(n){n.preventDefault(),t=n.pageX,chatWidthStartingPoint=n.pageX,"none"===$("#right_col").css("display")&&($("#right_col").css({display:"inherit"}),$("#right_close").removeClass("closed").addClass("open"),t=!1,$("#right_col").width()<340&&$("#right_col").width($("#right_col .top").width()),a.chatWidth=$("#right_col").width(),e.settings.save("chatWidth",a.chatWidth),s())}),$(document).mousemove(function(e){t&&(a.chatWidth+t-e.pageX<340?($("#right_col").width(340),$("#right_col #chat").width(340),$("#right_col .top").width(340)):a.chatWidth+t-e.pageX>541?($("#right_col").width(541),$("#right_col #chat").width(541),$("#right_col .top").width(541)):($("#right_col").width(a.chatWidth+t-e.pageX),$("#right_col #chat").width(a.chatWidth+t-e.pageX),$("#right_col .top").width(a.chatWidth+t-e.pageX)),s())}),$(window).off("fluid-resize"),$(window).off("resize").resize(function(){o.log("Debug: Resize Called"),setTimeout(s,1e3)})}e.settings.get.chatWidth&&e.settings.get.chatWidth<0&&e.settings.save("chatWidth",0);var n=e.storage.getObject("TwitchCache:Layout");n.resource&&n.resource.isRightColumnClosedByUserAction===!0&&(e.settings.save("chatWidth",0),"0"==$("#right_col").width()&&$("#right_col").width("340px"),n.resource.isRightColumnClosedByUserAction=!1,e.storage.putObject("TwitchCache:Layout",n)),0===$("#right_col .resizer").length&&$("#right_col").append("<div class='resizer' onselectstart='return false;' title='Drag to enlarge chat =D'></div>"),$("#right_col:before").css("margin-left","-1"),$("#right_col .bottom #controls #control_buttons .primary_button").css({"float":"right",marginRight:"-1px"}),$("#right_nav").css({"margin-left":"auto","margin-right":"auto",width:"321px","float":"none",border:"none"}),$("#right_col .top").css("border-bottom","1px solid rgba(0, 0, 0, 0.25)"),$("#right_close").unbind("click"),$("#right_close").removeAttr("data-ember-action"),$("#left_close").off("click").click(function(){$(window).trigger("resize")}),null!==e.settings.get("chatWidth")?(a.chatWidth=e.settings.get("chatWidth"),0==a.chatWidth?($("#right_col").css({display:"none"}),$("#right_close").removeClass("open").addClass("closed")):($("#right_col").width(a.chatWidth),$("#right_col #chat").width(a.chatWidth),$("#right_col .top").width(a.chatWidth)),$(window).trigger("resize")):("0"==$("#right_col").width()&&$("#right_col").width("340px"),a.chatWidth=$("#right_col").width(),e.settings.save("chatWidth",$("#right_col").width()))}}},{"../../helpers/debug":46,"../../keycodes":50,"../../vars":64,"./handle-resize":18,"./twitchcast":20}],20:[function(t,n){n.exports=function(){if(!$(".archive_info").length){var t='<iframe id="twitchcast" src="https://nightdev.com/twitchcast/?ontwitch={{hostname}}&channel={{channel}}" width="100%" height="100%" style="position: absolute;top: 0px;left: 0px;border: none;"></iframe>',n=function(){if($("#player object").length)try{$("#player object")[0].pauseVideo()}catch(n){}$("#player").append(t.replace("{{hostname}}",encodeURIComponent(window.location.protocol+"//"+window.location.host)).replace("{{channel}}",e.getChannel()));var o=function(){$("#twitchcast").remove(),window.removeEventListener("message",o,!1)};window.addEventListener("message",o,!1)},o=function(){if(!$("#twitchcast_button").length){var e=$("<div/>");e.attr("id","twitchcast_button"),e.click(n),$("#player").append(e)}},r=function(e){return window.chrome?window.chrome.cast&&window.chrome.cast.isAvailable?e(!1):void setTimeout(function(){r(e)},1e3):e(!0)};if(e.settings.get("twitchCast")){if(!$("#chromecast_sender").length){var a=$("<script/>");a.attr("id","chromecast_sender"),a.attr("src","https://www.gstatic.com/cv/js/sender/v1/cast_sender.js"),$("head").append(a)}r(function(e){e||o()})}else $("#chromecast_sender").remove(),$("#twitchcast_button").remove()}}},{}],21:[function(t,n){var o=(t("../helpers/debug"),t("../vars")),r=t("../templates/channel-state"),a=(t("../chat/helpers"),"#bttv-channel-state-contain"),s=".chat-container .chat-header:first",i=".chat-interface .chat-buttons-container .send-chat-button",c=function(e){var t=new Date(0);for(t.setSeconds(e),t=t.toISOString().substr(11,8),t=t.split(":");"00"===t[0];)t.shift();return 1===t.length&&"0"===t[0].charAt(0)&&(t[0]=parseInt(t[0])),t.join(":")},l=function(t){e.chat.store.chatCountDown&&clearInterval(e.chat.store.chatCountDown);var n=t;e.chat.store.chatCountDown=setInterval(function(){var e=$(i);return 0===n?void h():(e.find("span").text("Chat in "+c(n)),void n--)},1e3)},h=function(){e.chat.store.chatCountDown&&clearInterval(e.chat.store.chatCountDown),e.chat.store.chatCountDown=!1,$(i).find("span").text("Chat")};n.exports=function(t){var n=$(a);switch(n.length||($(s).append(r()),n=$(a),n.children().each(function(){$(this).hide(),$(this).hasClass("slow")?($(this).find(".slow-time").tipsy({gravity:$.fn.tipsy.autoNS}),$(this).find("svg").tipsy({gravity:$.fn.tipsy.autoNS})):$(this).tipsy({gravity:$.fn.tipsy.autoNS})})),t.type){case"roomstate":if("slow"in t.tags){var i=t.tags.slow;e.chat.store.slowTime=i,n.find(".slow-time").attr("original-title",i+" seconds").text(c(i)),0===i?(n.find(".slow").hide(),n.find(".slow-time").hide()):(n.find(".slow").show(),n.find(".slow-time").show())}if("r9k"in t.tags){var u=t.tags.r9k;u===!0?n.find(".r9k").show():n.find(".r9k").hide()}if("subs-only"in t.tags){var u=t.tags["subs-only"];u===!0?n.find(".subs-only").show():n.find(".subs-only").hide()}break;case"outgoing_message":if(!o.userData.isLoggedIn||e.chat.helpers.isModerator(o.userData.login))return;e.chat.store.slowTime>0?l(e.chat.store.slowTime):h();break;case"notice":if(!("msg-id"in t.tags))return;var d=t.tags["msg-id"];if("msg_slowmode"===d||"msg_timedout"===d){var p=/([0-9]+)/.exec(t.message);if(!p)return;var f=parseInt(p[1]);l(f)}else"msg_banned"===d&&l(86400)}}},{"../chat/helpers":5,"../helpers/debug":46,"../templates/channel-state":56,"../vars":64}],22:[function(t,n){var o=t("../helpers/debug"),r=t("../vars"),a=t("../helpers/element").remove,s=t("./darken-page"),i=t("./split-chat");n.exports=function(){if($(".ember-chat .chat-settings").length&&!$(".ember-chat .chat-settings .bttvChatSettings").length){o.log("Loading BetterTTV Chat Settings"),$(".ember-chat .chat-settings .clear-chat").remove();var n=t("../templates/chat-settings")(),c=$("<div></div>");c.attr("class","bttvChatSettings"),c.html(n),$(".ember-chat .chat-interface .chat-settings").append(c),$(".openSettings").click($('body[data-page="ember#chat"]').length?function(t){t.preventDefault(),e.settings.popup()}:function(e){e.preventDefault(),$(".chat-option-buttons .settings").click(),$("#bttvSettingsPanel").show("slow")}),$(".blackChatLink").click(function(e){if(e.preventDefault(),r.blackChat)r.blackChat=!1,$("#blackChat").remove(),s(),i(),$(".blackChatLink").text("Black Chat (Chroma Key)");else{r.blackChat=!0,$("#darkTwitch").remove(),$("#splitChat").remove();var t=document.createElement("link");t.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv-blackchat.css"),t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("id","blackChat"),t.innerHTML="",$("body").append(t),$(".blackChatLink").text("Unblacken Chat")}}),$(".clearChat").click(function(e){e.preventDefault(),a(".chat-line")}),$(".toggleDarkenTTV").change(function(t){t.preventDefault(),e.settings.get("darkenedMode")===!0?(e.settings.save("darkenedMode",!1),$(this).prop("checked",!1)):(e.settings.save("darkenedMode",!0),$(this).prop("checked",!0))}),$(".flipDashboard").click(function(t){t.preventDefault(),e.settings.get("flipDashboard")===!0?e.settings.save("flipDashboard",!1):e.settings.save("flipDashboard",!0)}),$(".setBlacklistKeywords").click(function(t){t.preventDefault();var n=prompt("Type some blacklist keywords. Messages containing keywords will be filtered from your chat. Use spaces in the field to specify multiple keywords. Place {} around a set of words to form a phrase. Wildcards are supported.",e.settings.get("blacklistKeywords"));null!=n&&(n=n.trim().replace(/\s\s+/g," "),e.settings.save("blacklistKeywords",n))}),$(".setHighlightKeywords").click(function(t){t.preventDefault();var n=prompt("Type some highlight keywords. Messages containing keywords will turn red to get your attention. Use spaces in the field to specify multiple keywords. Place {} around a set of words to form a phrase, and () around a word to specify a username. Wildcards are supported.",e.settings.get("highlightKeywords"));null!=n&&(n=n.trim().replace(/\s\s+/g," "),e.settings.save("highlightKeywords",n))}),$(".setScrollbackAmount").click(function(t){t.preventDefault();var n=prompt("What is the maximum amount of lines that you want your chat to show? Twitch default is 150. Leave the field blank to disable.",e.settings.get("scrollbackAmount"));null!=n&&""===n?e.settings.save("scrollbackAmount",150):null!=n&&isNaN(n)!==!0&&n>0?e.settings.save("scrollbackAmount",parseInt(n)):e.settings.save("scrollbackAmount",150)})}}},{"../helpers/debug":46,"../helpers/element":47,"../templates/chat-settings":57,"../vars":64,"./darken-page":29,"./split-chat":44}],23:[function(t,n){var o=t("../helpers/debug"),r=n.exports=function(){if(window.App&&window.App.__container__){var t=window.App.__container__.lookup("controller:channel");if(!t)return setTimeout(r,6e4);!t.get("model");var n=t.get("model");if(Ember.isEmpty(n))return setTimeout(r,6e4);var a=n.get("hostModeTarget"),s=a?a:n;o.log("Check Channel Title/Game"),e.TwitchAPI.get("channels/"+s.id,{},{version:3}).done(function(t){if(t.game&&(s.set("game",t.game),s.set("rollbackData.game",t.game)),t.status&&(s.set("status",t.status),!a)){var n=$("#broadcast-meta .title");n.data("status")!==t.status&&(n.data("status",t.status),t.status=t.status.replace(/</g,"&lt;").replace(/>/g,"&gt;"),t.status=e.chat.templates.linkify(t.status),n.find(".real").html(t.status),n.find(".over").html(t.status))}t.views&&s.set("views",t.views),t.followers&&s.set("followersTotal",t.followers),setTimeout(r,6e4+5e3*Math.random())})}}},{"../helpers/debug":46}],24:[function(t,n){var o=t("../helpers/debug"),r=t("../vars"),a=n.exports=function(){if(o.log("Check Following List"),$("#bttv-small-nav-count").length||($count=$("<div/>"),$count.addClass("js-total"),$count.attr("id","bttv-small-nav-count"),$count.insertBefore('#small_nav li[data-name="following"] a[href="/directory/following"] .filter_icon:first')),!$("body#chat").length&&!$('body[data-page="ember#chat"]').length&&r.userData.isLoggedIn){var t=function(n,o,r,a){var o=o||[],r=r||[],a=a||0;e.TwitchAPI.get("streams/followed?limit=100&offset="+a).done(function(e){e.streams&&e.streams.length>0?(e.streams.forEach(function(e){-1===r.indexOf(e.channel.name)&&(r.push(e.channel.name),o.push(e))}),100===e.streams.length?t(function(e){n(e)},o,r,a+100):n(o)):n(o)})};t(function(t){if(0===r.liveChannels.length)r.liveChannels.push("loaded"),t.forEach(function(e){var t=e.channel;-1===r.liveChannels.indexOf(t.name)&&r.liveChannels.push(t.name)});else if(t.length>0){var n=[];t.forEach(function(t){var a=t.channel;n.push(a.name),-1===r.liveChannels.indexOf(a.name)&&(o.log(a.name+" is now streaming"),null==a.game&&(a.game="on Twitch"),e.notify(a.display_name+" just started streaming "+a.game+".\nClick here to head to "+a.display_name+"'s channel.",a.display_name+" is Now Streaming",a.url,a.logo,"channel_live_"+a.name))}),r.liveChannels=n}$('#nav_personal li[data-name="following"] a[href="/directory/following"] .js-total').length||$('#nav_personal li[data-name="following"] a[href="/directory/following"]').append('<span class="total_count js-total" style="display: none;"></span>'),$('#left_col li[data-name="following"] a[href="/directory/following"] .js-total').text(t.length),$('#left_col li[data-name="following"] a[href="/directory/following"] .js-total').css("display","inline"),setTimeout(a,6e4+5e3*Math.random())})}}},{"../helpers/debug":46,"../vars":64}],25:[function(t,n){{var o=t("../helpers/debug");t("../vars")}n.exports=function(){if(o.log("Check for New Messages"),!$("body#chat").length){var t=[],n=["less than a minute ago","1 minute ago"],r=function(){e.settings.get("alertOtherMessages")!==!1&&$.get("/messages/other",function(o){var r=$(o).find("#message-list .unread");r.each(function(){var o=$(this),r=o.children("div.from_to_user"),a=o.children("div.message_data"),s=location.protocol+"//"+location.host+o.data("url"),i=o.data("url").match(/\/message\/show\/([a-z0-9]+)/)[1],c=r.children(".prof").children("img").attr("src"),l=r.children(".capital").text().trim().capitalize(),h=a.children(".time_ago").text().trim();-1===t.indexOf(s)&&-1!==n.indexOf(h)&&(t.push(s),e.notify(l+" just sent you a Message!\nClick here to view it.","Twitch Message Received",s,c,"new_message_"+i))})})};setInterval(r,3e4+5e3*Math.random()),r()}}},{"../helpers/debug":46,"../vars":64}],26:[function(t,n){var o=t("../helpers/debug"),r=t("../helpers/element").remove;n.exports=function(){o.log("Clearing Clutter"),$('li[data-name="kabam"]').attr("style","display: none !important"),r("#nav_advertisement"),e.settings.get("showFeaturedChannels")!==!0&&(r("#nav_games"),r("#nav_streams"),r("#nav_related_streams"),$("body").append("<style>#nav_games, #nav_streams, #nav_related_streams { display: none; }</style>"))}},{"../helpers/debug":46,"../helpers/element":47}],27:[function(t,n){var o=(t("../helpers/debug"),t("../vars"),t("../helpers/element").remove,t("./darken-page"),t("./split-chat"),t("../templates/settings-panel"));n.exports=function(){var t=document.createElement("div");t.setAttribute("id","bttvSettingsPanel"),t.style.display="none",t.innerHTML=o(),$("body").append(t),/\?bttvSettings=true/.test(window.location)&&($("#left_col").remove(),$("#main_col").remove(),setTimeout(function(){$("#bttvSettingsPanel").hide(function(){$("#bttvSettingsPanel").show()})},1e3)),$.get("https://cdn.betterttv.net/privacy.html",function(e){e&&$("#bttvPrivacy .tse-content").html(e)}),$.get("https://cdn.betterttv.net/changelog.html?"+e.info.versionString(),function(e){e&&$("#bttvChangelog .tse-content").html(e)}),$("#bttvBackupButton").click(function(){e.settings.backup()}),$("#bttvImportInput").change(function(){e.settings.import(this)}),$("#bttvSettingsPanel .scroll").TrackpadScrollEmulator({scrollbarHideStrategy:"rightAndBottom"}),$("#bttvSettingsPanel #close").click(function(){$("#bttvSettingsPanel").hide("slow")}),$("#bttvSettingsPanel .nav a").click(function(e){e.preventDefault();var t=$(this).attr("href");$("#bttvSettingsPanel .nav a").each(function(){var e=$(this).attr("href");$(e).hide(),$(this).parent("li").removeClass("active")}),"#bttvChannel"===t&&$(t).children("iframe").attr("src","https://manage.betterttv.net/"),$(t).fadeIn(),$(this).parent("li").addClass("active")})}},{"../helpers/debug":46,"../helpers/element":47,"../templates/settings-panel":62,"../vars":64,"./darken-page":29,"./split-chat":44}],28:[function(t,n){function o(t,n){if(e.settings.get(n)){var o=document.createElement("link");o.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv-"+t+".css?"+e.info.versionString()),o.setAttribute("type","text/css"),o.setAttribute("rel","stylesheet"),o.setAttribute("id",n),$("body").append(o)}}function r(e){$("#"+e).remove()}t("../helpers/debug");n.exports.load=o,n.exports.unload=r},{"../helpers/debug":46}],29:[function(t,n){var o=t("../helpers/debug"),r=t("./handle-background");n.exports=function(){var t=$("body");if(setTimeout(r,1e3),e.settings.get("darkenedMode")===!0&&t.attr("data-page")){o.log("Darkening Page");var n=$("body").data("page").split("#")[0],a=$("body").data("page").split("#")[1]||"none",s=["ember","message","dashboards","chat","chapter","archive","channel","user","bookmark"];if(-1!==s.indexOf(n)){if("dashboards"===n&&"show"!==a||"legal"===a)return;var i=document.createElement("link");i.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv-dark.css?"+e.info.versionString()),i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("id","darkTwitch"),$("body").append(i),$("#main_col .content #stats_and_actions #channel_stats #channel_viewer_count").css("display","none"),$('#main_col .messages img[src="http://www-cdn.jtvnw.net/images/xarth/g/g18_trash-00000080.png"]').attr("src","https://cdn.betterttv.net/style/icons/delete.png"),$('#main_col .messages img[src="http://www-cdn.jtvnw.net/images/xarth/g/g16_trash-00000020.png"]').attr("src","https://cdn.betterttv.net/style/icons/delete.png").attr("width","16").attr("height","16")}}}},{"../helpers/debug":46,"./handle-background":37}],30:[function(t,n){var o=t("../helpers/debug"),r=t("../vars");n.exports=function a(){if($("#dash_main").length){if(o.log("Updating Dashboard Channel Info"),e.TwitchAPI.get("streams/"+e.getChannel()).done(function(e){e.stream?($("#channel_viewer_count").text(Twitch.display.commatize(e.stream.viewers)),e.stream.channel.views&&$("#views_count span").text(Twitch.display.commatize(e.stream.channel.views)),e.stream.channel.followers&&$("#followers_count span").text(Twitch.display.commatize(e.stream.channel.followers))):$("#channel_viewer_count").text("Offline")}),e.TwitchAPI.get("channels/"+e.getChannel()+"/follows?limit=1").done(function(e){e._total&&$("#followers_count span").text(Twitch.display.commatize(e._total))}),!$("#chatters_count").length){var t=$("<div/>"),n=$("<span/>");t.attr("class","stat"),t.attr("id","chatters_count"),n.text("0"),n.attr("tooltipdata","Chatters"),t.append(n),$("#followers_count").after(t)}$.getJSON("https://tmi.twitch.tv/group/user/"+e.getChannel()+"/chatters?callback=?",function(e){e.data&&e.data.chatter_count&&$("#chatters_count span").text(Twitch.display.commatize(e.data.chatter_count))}),r.dontCheckSubs!==!0&&$.get("/broadcast/dashboard/partnership",function(t){var n=$(t).find("div.wrapper"),a=/Your channel currently has ([0-9,]+) paying subscribers and ([0-9,]+) total active subscribers/;if(n){var s=n.text();if(s.match(a)){var i=a.exec(s),c=i[2];if(!$("#subs_count").length){var n=$("<div/>"),l=$("<span/>");n.attr("class","stat"),n.attr("id","subs_count"),l.text("0"),l.attr("tooltipdata","Active Subscribers"),n.append(l),$("#chatters_count").after(n),e.TwitchAPI.get("chat/"+e.getChannel()+"/badges").done(function(e){e.subscriber&&$("#subs_count").css("background-image","url("+e.subscriber.image+")")})}$("#subs_count span").text(Twitch.display.commatize(c))}else r.dontCheckSubs=!0,o.log("Dashboard Info -> Channel doesn't have subscribers.")}else o.warn("Dashboard Info -> Error loading partnership page.")}),setTimeout(a,6e4+5e3*Math.random())}}},{"../helpers/debug":46,"../vars":64}],31:[function(t,n){var o=t("../helpers/debug"),r=t("../vars");n.exports=function(){e.settings.get("showDirectoryLiveTab")===!0&&$('h2.title:contains("Following")').length&&$('a.active:contains("Overview")').length&&(o.log("Changing Directory View"),$('a[href="/directory/following/live"]').click()),r.watchScroll||(r.watchScroll=$("#main_col .tse-scroll-content").scroll(function(){var e=$("#main_col .tse-scroll-content")[0].scrollHeight-$("#main_col .tse-scroll-content").height(),t=$("#main_col .tse-scroll-content").scrollTop(),n=e-t;if(251>n){if($("#directory-list a.list_more .spinner").length)return;$("#directory-list a.list_more").click()}}))}},{"../helpers/debug":46,"../vars":64}],32:[function(t,n){var o=(t("../helpers/debug"),t("../templates/embedded-poll")),r=t("../chat/helpers"),a=null,s=null;n.exports=function(t){var n=/strawpoll\.me\/([0-9]+)/g.exec(t.message);if(e.settings.get("embeddedPolling")&&n&&r.isModerator(t.from)){var i=n[1],c=$("#bttv-poll-contain");c.length&&i==s||c.length&&c.children(".frame").is(":visible")||(c.length&&c.remove(),$(".ember-chat .chat-room").append(o({pollId:i})),c=$("#bttv-poll-contain"),null!==a&&clearTimeout(a),a=setTimeout(function(){c&&!c.children(".frame").is(":visible")&&c.remove()},3e4),c.children(".close").on("click",function(){c.remove()}),c.children(".title").on("click",function(){c.children(".frame").show(),c.children(".title").text("Thanks!"),c.css("height","450px")}),c.slideDown(200),s=i)}}},{"../chat/helpers":5,"../helpers/debug":46,"../templates/embedded-poll":59}],33:[function(e,t){t.exports=function(){if("oncopy"in document){var e=function(t){if(!t.clipboardData||!t.clipboardData.setData)return void document.removeEventListener("copy",e);var n="img.emoticon",o=function(e,t){var n=decodeURIComponent($(t).data("regex"));$(t).after(n).remove()},r=$(window.getSelection().getRangeAt(0).cloneContents());(r.children().is(n)||r.children().find(n).length)&&(r.children().filter(n).each(o),r.children().find(n).each(o),r=r.text().replace(/\s+/g," ").trim(),t.clipboardData.setData("text/plain",r),t.preventDefault())};document.addEventListener("copy",e)}}},{}],34:[function(t,n){var o=t("../helpers/debug");n.exports=function(){$("#dash_main").length&&(e.settings.get("flipDashboard")===!0?(o.log("Flipping Dashboard"),$("#dash_main .dash-chat-column").css({"float":"left",right:"initial"}),$("#dash_main #controls_column").css({"float":"right",left:"20px"})):($("#dash_main .dash-chat-column").css({"float":"none",right:"0px"}),$("#dash_main #controls_column").css({"float":"left",left:"0px"})))}},{"../helpers/debug":46}],35:[function(e,t){var n=e("../helpers/debug");t.exports=function(){$("#dash_main").length&&(n.log("Formatting Dashboard"),$("#dash_main #controls_column .dash-hostmode-contain").appendTo("#dash_main #controls_column"),$("#dash_main #controls_column .dash-player-contain").appendTo("#dash_main #controls_column"),$("#dash_main #commercial_buttons").appendTo("#dash_main .dash-broadcast-contain"),$("#commercial_options .dropmenu_action[data-length=150]").text("2m 30s"),$("#controls_column #form_submit button").attr("class","primary_button"))}},{"../helpers/debug":46}],36:[function(t,n){var o=t("../helpers/debug");n.exports=function(){$("#dash_main").length&&(o.log("Giveaway Plugin Dashboard Compatibility"),$(".tga_modal").appendTo("#bttvDashboard"),$(".tga_button").click(function(){e.settings.get("flipDashboard")===!0?($("#chat").width("330px"),$(".tga_modal").css("right","0px")):($("#chat").width("330px"),$(".tga_modal").css("right","inherit"))}),$('button[data-action="close"]').click(function(){$("#chat").width("500px")}))}},{"../helpers/debug":46}],37:[function(t,n){n.exports=function o(t){var t=t||!1,n="custom-bg";if(0===$("#"+n).length){var r=$("<canvas />");r.attr("id",n),$("#channel").prepend(r)}if(window.App&&App.__container__.lookup("controller:Channel")&&App.__container__.lookup("controller:Channel").get("content.panels")){if(App.__container__.lookup("controller:Channel").get("content.panels.content").forEach(function(e){var t=e.get("data").link,o=/^https?:\/\/cdn.betterttv.net\//;if(t&&-1!==t.indexOf("#BTTV#")){for(var r={},a=t.split("#BTTV#")[1],s=a.split("="),i=0;i<s.length;i+=2)s[i+1]&&o.test(s[i+1])&&(r[s[i]]=s[i+1]);r.bg&&$("#"+n).attr("image",r.bg)}}),t)$("#"+n).addClass("tiled");else if($("#"+n).attr("image")){var a=new Image;a.onload=function(){a.naturalWidth<$("#main_col").width()&&setTimeout(function(){o(!0)},2e3)},a.src=$("#"+n).attr("image")}var s=$("#"+n),i=s[0];if(i&&i.getContext){var c=i.getContext("2d"),l=$("#"+n).attr("image");if(l)if(s.css({width:"100%","background-position":"center top"}),s.hasClass("tiled"))s.css({"background-image":'url("'+l+'")'}).attr("width",200).attr("height",200),i=c.createLinearGradient(0,0,0,200),e.settings.get("darkenedMode")===!0?(i.addColorStop(0,"rgba(20,20,20,0.4)"),i.addColorStop(1,"rgba(20,20,20,1)")):(i.addColorStop(0,"rgba(245,245,245,0.65)"),i.addColorStop(1,"rgba(245,245,245,1)")),c.fillStyle=i,c.fillRect(0,0,200,200);else{var h=document.createElement("IMG");h.onload=function(){var t,n=this.width,o=this.height;s.attr("width",n).attr("height",o),c.drawImage(h,0,0),e.settings.get("darkenedMode")===!0?o>n?(t=c.createLinearGradient(0,0,0,n),t.addColorStop(0,"rgba(20,20,20,0.4)"),t.addColorStop(1,"rgba(20,20,20,1)"),c.fillStyle=t,c.fillRect(0,0,n,n),c.fillStyle="rgb(20,20,20)",c.fillRect(0,n,n,o-n)):(t=c.createLinearGradient(0,0,0,o),t.addColorStop(0,"rgba(20,20,20,0.4)"),t.addColorStop(1,"rgba(20,20,20,1)"),c.fillStyle=t,c.fillRect(0,0,n,o)):o>n?(t=c.createLinearGradient(0,0,0,n),t.addColorStop(0,"rgba(245,245,245,0.65)"),t.addColorStop(1,"rgba(245,245,245,1)"),c.fillStyle=t,c.fillRect(0,0,n,n),c.fillStyle="rgb(245,245,245)",c.fillRect(0,n,n,o-n)):(t=c.createLinearGradient(0,0,0,o),t.addColorStop(0,"rgba(245,245,245,0.65)"),t.addColorStop(1,"rgba(245,245,245,1)"),c.fillStyle=t,c.fillRect(0,0,n,o))},h.src=l}else $(i).css("background-image",""),c.clearRect(0,0,i.width,i.height)}}}},{}],38:[function(t,n){var o=t("../helpers/debug");n.exports=function(){if(e.settings.get("clickTwitchEmotes")===!0){o.log("Injecting Twitch Chat Emotes Script");var t=document.createElement("script");t.setAttribute("src","https://cdn.betterttv.net/js/twitchemotes.js?"+e.info.versionString()),t.setAttribute("type","text/javascript"),t.setAttribute("id","clickTwitchEmotes"),$("body").append(t)}var n=0,r=setInterval(function(){return n++,n>29?void clearInterval(r):void(window.emoteMenu&&(clearInterval(r),o.log("Hooking into Twitch Chat Emotes Script"),window.emoteMenu.registerEmoteGetter("BetterTTV",e.chat.emotes)))},1e3)}},{"../helpers/debug":46}],39:[function(t,n){var o=(t("../helpers/debug"),t("../vars"));n.exports=function(){if(e.settings.get("hostButton")===!0&&o.userData.isLoggedIn){var t=e.chat,n=t.tmi();if(n){var r=t.helpers,a=n.tmiSession?n.tmiSession.userId:0,s=n.tmiRoom?n.tmiRoom.ownerId:0;if(n.tmiSession&&n.tmiSession._tmiApi){var i=$("#bttv-host-button");i.length||(i=$("<span><span></span></span>"),i.addClass("button").addClass("action"),i.attr("id","bttv-host-button"),i.insertBefore("#channel .channel-actions .theatre-button"),i.click(function(){var t=i.text();if("Unhost"===t)try{n.tmiSession._connections.prod._send("PRIVMSG #"+o.userData.login+" :/unhost"),r.serverMessage("BetterTTV: We sent a /unhost to your channel."),i.children("span").text("Host")}catch(a){r.serverMessage("BetterTTV: There was an error unhosting the channel. You may need to unhost it from your channel.")}else try{n.tmiSession._connections.prod._send("PRIVMSG #"+o.userData.login+" :/host "+e.getChannel()),r.serverMessage("BetterTTV: We sent a /host to your channel. Please note you can only host 3 times per 30 minutes."),i.children("span").text("Unhost")}catch(a){r.serverMessage("BetterTTV: There was an error hosting the channel. You may need to host it from your channel.")}})),n.tmiSession._tmiApi.get("/hosts",{host:a}).then(function(e){e.hosts&&e.hosts.length&&i.children("span").text(e.hosts[0].target_id===s?"Unhost":"Host")})}}}}},{"../helpers/debug":46,"../vars":64}],40:[function(e,t,n){e("../helpers/debug"),n.enablePreview=function(){$(document).on({mouseenter:function(){var e=this.href;$(this).tipsy({trigger:"manual",gravity:$.fn.tipsy.autoNS,html:!0,title:function(){return'<iframe id="chat_preview" marginwidth="0" marginheight="0" hspace="0" vspace="0" frameborder="0" width="200px" scrolling="no" src="https://api.betterttv.net/2/image_embed/'+encodeURIComponent(e)+'"></iframe>'}}),$(this).tipsy("show")},mouseleave:function(){$(this).tipsy("hide"),$("div.tipsy").remove()}},"a.chat-preview")},n.disablePreview=function(){$(document).off("mouseenter mouseleave mousemove","a.chat-preview")}},{"../helpers/debug":46}],41:[function(t,n,o){var r=t("../vars"),a=t("../helpers/regex").escapeRegExp;o.blacklistFilter=function(t){var n=[],o=[],s=e.settings.get("blacklistKeywords"),i=/\{.+?\}/g,c=s.match(i);if(c)for(var l=0;l<c.length;l++){var h=c[l];s=s.replace(h,"").replace(/\s\s+/g," ").trim(),n.push(h.replace(/(^\{|\}$)/g,"").trim())}""!==s&&(s=s.split(" "),s.forEach(function(e){/^\([a-z0-9_\-\*]+\)$/i.test(e)?o.push(e.replace(/(\(|\))/g,"")):n.push(e)}));for(var l=0;l<n.length;l++){var u=a(n[l]).replace(/\*/g,"[^ ]*"),d=new RegExp(u,"i");if(d.test(t.message)&&r.userData.login!==t.from)return!0}for(var l=0;l<o.length;l++){var p=a(o[l]).replace(/\*/g,"[^ ]*"),f=new RegExp("^"+p+"$","i");if(f.test(t.from))return!0}return!1},o.highlighting=function(n){var o=t("../features/audible-feedback"),s=[],i=[],c=e.settings.get("highlightKeywords"),l=/\{.+?\}/g,h=c.match(l);if(h)for(var u=0;u<h.length;u++){var d=h[u];c=c.replace(d,"").replace(/\s\s+/g," ").trim(),s.push(d.replace(/(^\{|\}$)/g,"").trim())}""!==c&&(c=c.split(" "),c.forEach(function(e){/^\([a-z0-9_\-\*]+\)$/i.test(e)?i.push(e.replace(/(\(|\))/g,"")):s.push(e)}));for(var u=0;u<s.length;u++){var p=a(s[u]).replace(/\*/g,"[^ ]*"),f=new RegExp("(\\s|^|@)"+p+"([!.,:';?/]|\\s|$)","i");if(r.userData.isLoggedIn&&r.userData.login!==n.from&&f.test(n.message))return e.settings.get("desktopNotifications")===!0&&e.chat.store.activeView===!1&&(e.notify("You were mentioned in "+e.chat.helpers.lookupDisplayName(e.getChannel())+"'s channel."),o()),!0}for(var u=0;u<i.length;u++){var g=a(i[u]).replace(/\*/g,"[^ ]*"),m=new RegExp("^"+g+"$","i");if(m.test(n.from))return!0}return!1}},{"../features/audible-feedback":14,"../helpers/regex":49,"../vars":64}],42:[function(t,n){n.exports=function(t,n){t.messages=$.makeArray($('.chat-room .chat-messages .chat-line[data-sender="'+t.name+'"]')).reverse();var o=e.chat.templates.moderationCard(t,n.offset().top,$(".chat-lines").offset().left);$(".ember-chat .moderation-card").remove(),$(".ember-chat").append(o);var r=$('.ember-chat .moderation-card[data-user="'+t.name+'"]');r.find(".close-button").click(function(){r.remove()}),r.find(".user-messages .label").click(function(){r.find(".user-messages .chat-messages").toggle("fast");var e=$(this).find(".triangle");e.hasClass("open")?e.removeClass("open").addClass("closed"):e.removeClass("closed").addClass("open")}),r.find(".permit").click(function(){e.chat.helpers.sendMessage("!permit "+t.name),r.remove(),$("div.tipsy").remove()
}),r.find(".timeout").click(function(){e.chat.helpers.timeout(t.name,$(this).data("time")),r.remove(),$("div.tipsy").remove()}),r.find(".ban").click(function(){e.chat.helpers.ban(t.name),r.remove(),$("div.tipsy").remove()}),r.find(".mod-card-profile").click(function(){window.open(Twitch.url.profile(t.name),"_blank")}),r.find(".mod-card-message").click(function(){window.open(Twitch.url.compose(t.name),"_blank")}),r.find(".mod-card-edit").click(function(){var n=prompt("Enter the new nickname for "+t.display_name+". (Leave blank to reset...)");if(n.length){if(n=n.trim(),!n.length)return;e.storage.pushObject("nicknames",t.name,n),r.find("h3.name a").text(n),$('.chat-line[data-sender="'+t.name+'"] .from').text(n)}else e.storage.spliceObject("nicknames",t.name),r.find("h3.name a").text(t.display_name),$('.chat-line[data-sender="'+t.name+'"] .from').text(t.display_name)}),e.chat.helpers.isIgnored(t.name)&&(r.find(".mod-card-ignore .svg-ignore").hide(),r.find(".mod-card-ignore .svg-unignore").show()),r.find(".mod-card-ignore").click(function(){"none"!==r.find(".mod-card-ignore .svg-unignore").css("display")?(e.chat.helpers.sendMessage("/unignore "+t.name),r.find(".mod-card-ignore .svg-ignore").show(),r.find(".mod-card-ignore .svg-unignore").hide()):(e.chat.helpers.sendMessage("/ignore "+t.name),r.find(".mod-card-ignore .svg-ignore").hide(),r.find(".mod-card-ignore .svg-unignore").show())}),e.chat.helpers.isModerator(t.name)&&(r.find(".mod-card-mod .svg-add-mod").hide(),r.find(".mod-card-mod .svg-remove-mod").show()),r.find(".mod-card-mod").click(function(){"none"!==r.find(".mod-card-mod .svg-remove-mod").css("display")?(e.chat.helpers.sendMessage("/unmod "+t.name),r.find(".mod-card-mod .svg-add-mod").show(),r.find(".mod-card-mod .svg-remove-mod").hide()):(e.chat.helpers.sendMessage("/mod "+t.name),r.find(".mod-card-mod .svg-add-mod").hide(),r.find(".mod-card-mod .svg-remove-mod").show())}),e.TwitchAPI.get("users/:login/follows/channels/"+t.name).done(function(){r.find(".mod-card-follow").text("Unfollow")}).fail(function(){r.find(".mod-card-follow").text("Follow")}),r.find(".mod-card-follow").text("Unfollow").click(function(){"Unfollow"===r.find(".mod-card-follow").text()?(e.TwitchAPI.del("users/:login/follows/channels/"+t.name).done(function(){e.chat.helpers.serverMessage("User was unfollowed successfully.",!0)}).fail(function(){e.chat.helpers.serverMessage("There was an error following this user.",!0)}),r.find(".mod-card-follow").text("Follow")):(e.TwitchAPI.put("users/:login/follows/channels/"+t.name).done(function(){e.chat.helpers.serverMessage("User was followed successfully.",!0)}).fail(function(){e.chat.helpers.serverMessage("There was an error following this user.",!0)}),r.find(".mod-card-follow").text("Unfollow"))}),r.drags({handle:".drag-handle",el:r}),$('.chat-line[data-sender="'+t.name+'"]').addClass("bttv-user-locate"),r.on("remove",function(){$('.chat-line[data-sender="'+t.name+'"]').removeClass("bttv-user-locate")})}},{}],43:[function(t,n){var o=t("../helpers/debug"),r=t("../vars");n.exports=function(){if(!r.emotesLoaded){o.log("Loading BetterTTV Emoticons");var t=function(t){r.emotesLoaded=!0,t.emotes.forEach(function(n){n.urlTemplate=t.urlTemplate.replace("{{id}}",n.id),n.url=n.urlTemplate.replace("{{image}}","1x"),e.chat.store.bttvEmotes[n.code]=n}),$("body").on("mouseover",".chat-line .emoticon",function(){r.hoveringEmote=$(this),$(this).tipsy({trigger:"manual",gravity:"se",live:!1,html:!0,fallback:function(){var t=r.hoveringEmote;if(t&&t.data("regex")){var n=decodeURIComponent(t.data("regex"));return e.TwitchEmoteIDToChannel&&t.data("id")&&e.TwitchEmoteIDToChannel[t.data("id")]?"Emote: "+n+"<br />Channel: "+e.TwitchEmoteIDToChannel[t.data("id")]:t.data("channel")&&"BetterTTV Emotes"===t.data("channel")?"Emote: "+n+"<br />BetterTTV Emoticon":t.data("channel")?"Emote: "+n+"<br />Channel: "+t.data("channel"):n}return"Kappab"}}),$(this).tipsy("show");var t=$(this);e.TwitchEmoteIDToChannel&&t.data("id")&&e.TwitchEmoteIDToChannel[t.data("id")]?$(this).css("cursor","pointer"):t.data("channel")&&$(this).css("cursor","pointer")}).on("mouseout",".chat-line .emoticon",function(){$(this).tipsy("hide");var t=$(this);e.TwitchEmoteIDToChannel&&t.data("id")&&e.TwitchEmoteIDToChannel[t.data("id")]?$(this).css("cursor","normal"):t.data("channel")&&$(this).css("cursor","normal"),$("div.tipsy").remove()}).on("click",".chat-line .emoticon",function(){var t=$(this);t.data("channel")&&"BetterTTV Emotes"===t.data("channel")||(e.TwitchEmoteIDToChannel&&t.data("id")&&e.TwitchEmoteIDToChannel[t.data("id")]?window.open("http://www.twitch.tv/"+e.TwitchEmoteIDToChannel[t.data("id")],"_blank"):t.data("channel")&&window.open("http://www.twitch.tv/"+$(this).data("channel"),"_blank"))})};$.getJSON("https://api.betterttv.net/2/emotes/ids").done(function(t){e.TwitchEmoteIDToChannel=t.ids}),$.getJSON("https://api.betterttv.net/2/emotes/sets").done(function(t){e.TwitchEmoteSets=t.sets}),$.getJSON("https://api.betterttv.net/2/emotes").done(function(e){t(e)})}}},{"../helpers/debug":46,"../vars":64}],44:[function(t,n){var o=t("../helpers/debug");n.exports=function(){if(e.settings.get("splitChat")!==!1){o.log("Splitting Chat");var t=document.createElement("link");e.settings.get("darkenedMode")===!0?t.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv-split-chat-dark.css"):t.setAttribute("href","https://cdn.betterttv.net/style/stylesheets/betterttv-split-chat.css"),t.setAttribute("type","text/css"),t.setAttribute("rel","stylesheet"),t.setAttribute("id","splitChat"),$("body").append(t)}}},{"../helpers/debug":46}],45:[function(e,t,n){{var o=(n.calculateColorBackground=function(e){e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16),r=(299*t+587*n+114*o)/1e3;return r>=128?"dark":"light"},n.calculateColorReplacement=function(e,t){var n,a,s,i,c,l,h="light"===t,u=h?.1:-.1;return e=String(e).replace(/[^0-9a-f]/gi,""),e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),s=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),c=parseInt(e.substr(4,2),16),a=o(s,i,c),l=h?1-(1-u)*(1-a[2]):(1+u)*a[2],l=Math.min(Math.max(0,l),1),n=r(a[0],a[1],l),s=n[0].toString(16),i=n[1].toString(16),c=n[2].toString(16),"#"+("00"+s).substr(s.length)+("00"+i).substr(i.length)+("00"+c).substr(c.length)},n.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var o,r,a=Math.max(e,t,n),s=Math.min(e,t,n),i=Math.min(Math.max(0,(a+s)/2),1),c=Math.min(Math.max(0,a-s),1);if(0===c)o=r=c;else{switch(r=i>.5?c/(2*(1-i)):c/(2*i),r=Math.min(Math.max(0,r),1),a){case e:o=Math.min(Math.max(0,(t-n)/c+(n>t?6:0)),6);break;case t:o=Math.min(Math.max(0,(n-e)/c+2),6);break;case n:o=Math.min(Math.max(0,(e-t)/c+4),6)}o/=6}return[o,r,i]}),r=n.hslToRgb=function(e,t,n){var o,r,a,s,i,c;return 0===t?o=r=a=Math.round(Math.min(Math.max(0,255*n),255)):(s=function(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+(t-e)*(2/3-n)*6:e},i=.5>n?n*(1+t):n+t-n*t,c=2*n-i,o=Math.round(Math.min(Math.max(0,255*s(c,i,e+1/3)),255)),r=Math.round(Math.min(Math.max(0,255*s(c,i,e)),255)),a=Math.round(Math.min(Math.max(0,255*s(c,i,e-1/3)),255))),[o,r,a]};n.getRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:{r:0,g:0,b:0}},n.getHex=function(e){var t=function(e){return("0"+parseInt(e).toString(16)).slice(-2)};return"#"+t(e.r)+t(e.g)+t(e.b)}}},{}],46:[function(t,n){n.exports={log:function(){if(window.console&&console.log&&!e.settings.get("consoleLog")!=!0){var t=Array.prototype.slice.call(arguments);console.log.apply(console.log,["BTTV:"].concat(t))}}}},{}],47:[function(e,t,n){n.remove=function(e){$(e).each(function(){$(this).hide()})},n.display=function(e){$(e).each(function(){$(this).show()})}},{}],48:[function(e,t){var n=n||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},o=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,a=function(n){var o=t.createEvent("MouseEvents");o.initMouseEvent("click",!0,!1,e,0,0,0,0,0,!1,!1,!1,!1,0,null),n.dispatchEvent(o)},s=e.webkitRequestFileSystem,i=e.requestFileSystem||s||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},l="application/octet-stream",h=0,u=500,d=function(t){var o=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};e.chrome?o():setTimeout(o,u)},p=function(e,t,n){t=[].concat(t);for(var o=t.length;o--;){var r=e["on"+t[o]];if("function"==typeof r)try{r.call(e,n||e)}catch(a){c(a)}}},f=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["i?",e],{type:e.type}):e},g=function(t,c){t=f(t);var u,g,m,v=this,b=t.type,y=!1,w=function(){p(v,"writestart progress write writeend".split(" "))},k=function(){if((y||!u)&&(u=n().createObjectURL(t)),g)g.location.href=u;else{var o=e.open(u,"_blank");void 0==o&&"undefined"!=typeof safari&&(e.location.href=u)}v.readyState=v.DONE,w(),d(u)},_=function(e){return function(){return v.readyState!==v.DONE?e.apply(this,arguments):void 0}},C={create:!0,exclusive:!1};return v.readyState=v.INIT,c||(c="download"),r?(u=n().createObjectURL(t),o.href=u,o.download=c,a(o),v.readyState=v.DONE,w(),void d(u)):(e.chrome&&b&&b!==l&&(m=t.slice||t.webkitSlice,t=m.call(t,0,t.size,l),y=!0),s&&"download"!==c&&(c+=".download"),(b===l||s)&&(g=e),i?(h+=t.size,void i(e.TEMPORARY,h,_(function(e){e.root.getDirectory("saved",C,_(function(e){var n=function(){e.getFile(c,C,_(function(e){e.createWriter(_(function(n){n.onwriteend=function(t){g.location.href=e.toURL(),v.readyState=v.DONE,p(v,"writeend",t),d(e)},n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&k()},"writestart progress write abort".split(" ").forEach(function(e){n["on"+e]=v["on"+e]}),n.write(t),v.abort=function(){n.abort(),v.readyState=v.DONE},v.readyState=v.WRITING}),k)}),k)};e.getFile(c,{create:!1},_(function(e){e.remove(),n()}),_(function(e){e.code===e.NOT_FOUND_ERR?n():k()}))}),k)}),k)):void k())},m=g.prototype,v=function(e,t){return new g(e,t)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t){return navigator.msSaveOrOpenBlob(f(e),t)}:(m.abort=function(){var e=this;e.readyState=e.DONE,p(e,"abort")},m.readyState=m.INIT=0,m.WRITING=1,m.DONE=2,m.error=m.onwritestart=m.onprogress=m.onwrite=m.onabort=m.onerror=m.onwriteend=null,v)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);"undefined"!=typeof t&&t.exports?t.exports.saveAs=n:"undefined"!=typeof define&&null!==define&&null!=define.amd&&define([],function(){return n})},{}],49:[function(e,t,n){n.escapeRegExp=function(e){return e.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&")},n.getEmoteFromRegEx=function(e){return decodeURI(e.source).replace("&gt\\;",">").replace("&lt\\;","<").replace(/\(\?![^)]*\)/g,"").replace(/\(([^|])*\|?[^)]*\)/g,"$1").replace(/\[([^|])*\|?[^\]]*\]/g,"$1").replace(/[^\\]\?/g,"").replace(/^\\b|\\b$/g,"").replace(/\\/g,"")}},{}],50:[function(e,t){t.exports={LeftClick:1,Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,Capslock:20,Esc:27,Space:32,Pageup:33,Pagedown:34,End:35,Home:36,LeftArrow:37,UpArrow:38,RightArrow:39,DownArrow:40,Insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"0numpad":96,"1numpad":97,"2numpad":98,"3numpad":99,"4numpad":100,"5numpad":101,"6numpad":102,"7numpad":103,"8numpad":104,"9numpad":105,Multiply:106,Plus:107,Minut:109,Dot:110,Slash1:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,Equal:187,Comma:188,Slash:191,Backslash:220}},{}],51:[function(e,t){t.exports=function(e){return{night:{mod:!0,tagType:"broadcaster",tagName:"<span style='color:#FFD700;'>Creator</span>",color:"#000;text-shadow: 0 0 10px #FFD700"},gspwar:{mod:!1,tagType:"admin",tagName:"EH?"},nightmare:{mod:!1,tagType:"broadcaster",tagName:"MLG"},sour:{mod:!1,tagType:"brown",tagName:"<span style='color:#FFE600;'>Saucy</span>",color:e.color+";text-shadow: 0 0 10px #FFD700"},yorkyyork:{mod:!1,tagType:"broadcaster",tagName:"Nerd"},striker035:{mod:!0,tagType:"admin",tagName:"MotherLover"},dog:{mod:!0,tagType:"bot",tagName:"Smelly"},jruxdev:{mod:!0,tagType:"bot",tagName:"MuttonChops"},totally_cereal:{mod:!0,tagType:"staff",tagName:"Fruity"},virtz:{mod:!0,tagType:"staff",tagName:"Perv"},unleashedbeast:{mod:!0,tagType:"admin",tagName:"<span style='color:black;'>Surface</span>"},kona:{mod:!0,tagType:"broadcaster",tagName:"KK"},norfolk:{mod:!0,tagType:"broadcaster",tagName:"Creamy"},leftyben:{mod:!0,tagType:"lefty",tagName:"&nbsp;"},nokz:{mod:!0,tagType:"staff",tagName:"N47"},blindfolded:{mod:!0,tagType:"broadcaster",tagName:"iLag"},jagrawr:{mod:!0,tagType:"admin",tagName:"Jag"},snorlaxitive:{mod:!0,tagType:"purple",tagName:"King"},excalibur:{mod:!0,tagType:"staff",tagName:"Boss"},chez_plastic:{mod:!0,tagType:"staff",tagName:"Frenchy"},frontiersman72:{mod:!0,tagType:"admin",tagName:"TMC"},dckay14:{mod:!0,tagType:"admin",tagName:"Ginger"},harksa:{mod:!0,tagType:"orange",tagName:"Feet"},lltherocksaysll:{mod:!0,tagType:"broadcaster",tagName:"BossKey"},melissa_loves_everyone:{mod:!0,tagType:"purple",tagName:"Chubby",nickname:"Bunny"},redvaloroso:{mod:!0,tagType:"broadcaster",tagName:"Dio"},slapage:{mod:!0,tagType:"bot",tagName:"I aM"},eternal_nightmare:{mod:!0,tagType:"broadcaster",tagName:"Spencer",nickname:"Nickiforek"},iivii_beauty:{mod:!0,tagType:"purple",tagName:"Crave"},theefrenzy:{mod:!0,tagType:"staff",tagName:"Handsome"},gennousuke69:{mod:!0,tagType:"admin",tagName:"Evil"},zebbazombies:{mod:!0,tagType:"moderator",tagName:"Hugs"},nobama12345:{mod:!0,tagType:"broadcaster",tagName:"SeAor"},uleet:{mod:!0,tagType:"moderator",tagName:"Taco"},mrimjustaminorthreat:{mod:!0,tagType:"staff",tagName:"<span style='color:pink;'>Major</span>",nickname:"mrimjustamajorthreat"},sournothardcore:{mod:!0,tagType:"brown",tagName:"<span style='color:#FFE600 !important;'>Saucy</span>",color:e.color+";text-shadow: 0 0 10px #FFD700"},mac027:{mod:!0,tagType:"admin",tagName:"Hacks"},vaughnwhiskey:{mod:!0,tagType:"admin",tagName:"Bacon"},socaldesigner:{mod:!0,tagType:"broadcaster",tagName:"Legend"},perfectorzy:{mod:!0,tagType:"moderator",tagName:"Jabroni Ave"},pantallideth1:{mod:!0,tagType:"staff",tagName:"Windmill"},mmjc:{mod:!0,tagType:"admin",tagName:"m&m"},hawkeyye:{mod:!0,tagType:"broadcaster",tagName:"EnVy",nickname:"Hawkeye"},the_chopsticks:{mod:!0,tagType:"admin",tagName:"oZn"},bacon_donut:{mod:!0,tagType:"bacon",tagName:"&#8203;",nickname:"Donut"},tacos:{mod:!0,tagType:"taco",tagName:"&#8203;"},sauce:{mod:!0,tagType:"purple",tagName:"Drippin' Dat"},thejokko:{mod:!0,tagType:"purple",tagName:"Swede"},missmiarose:{mod:!0,tagType:"admin",tagName:"Lovely"},r3lapse:{mod:!0,tagType:"staff",tagName:"Kershaw"},im_tony_:{mod:!0,tagType:"admin",tagName:"oZn"},tips_:{mod:!0,tagType:"staff",tagName:"241"},"1danny1032":{mod:!0,tagType:"admin",tagName:"1Bar"},cvagts:{mod:!0,tagType:"staff",tagName:"SRL"},thesabe:{mod:!0,tagType:"orange",tagName:"<span style='color:blue;'>Sabey</span>"},kerviel_:{mod:!0,tagType:"staff",tagName:"Almighty"},ackleyman:{mod:!0,tagType:"orange",tagName:"Ack"}}}},{}],52:[function(t,n){var o=e.chat,r=e.vars,a=t("./features/beta-chat"),s=t("./features/channel-reformat"),i=t("./features/split-chat"),c=t("./features/darken-page"),l=t("./features/handle-background"),h=t("./features/flip-dashboard"),u=t("./features/css-loader"),d=(t("./features/auto-theatre-mode"),t("./features/host-btn-below-video")),p=t("./features/anon-chat"),f=t("./features/handle-twitchchat-emotes"),g=t("./helpers/element").display,m=t("./helpers/element").remove,v=t("./features/image-preview");n.exports=[{name:"Anon Chat",description:"Join channels without appearing in chat","default":!1,storageKey:"anonChat",toggle:function(){p()},load:function(){p()}},{name:"Alpha Chat Badges",description:"Removes the background from chat badges","default":!1,storageKey:"alphaTags"},{name:"Automatic Theatre Mode",description:"Automatically enables theatre mode","default":!1,storageKey:"autoTheatreMode"},{name:"BetterTTV Chat",description:"A tiny chat bar for personal messaging friends (reloads page when turning off)","default":!1,storageKey:"bttvChat",toggle:function(e){e===!0?a():window.location.reload()}},{name:"BetterTTV Emotes",description:"BetterTTV adds extra cool emotes for you to use","default":!0,storageKey:"bttvEmotes"},{name:"BetterTTV GIF Emotes",description:"We realize not everyone likes GIFs, but some people do.","default":!1,storageKey:"bttvGIFEmotes"},{name:"Blue Buttons",description:"Blue is better than purple, so we make it an option.","default":!1,storageKey:"showBlueButtons",toggle:function(e){e===!0?u.load("blue-buttons","showBlueButtons"):u.unload("showBlueButtons")},load:function(){u.load("blue-buttons","showBlueButtons")}},{name:"Chat Image Preview",description:"Preview chat images on mouse over","default":!0,storageKey:"chatImagePreview",toggle:function(e){e===!0?v.enablePreview():v.disablePreview()}},{name:"DarkenTTV",description:"A sleek, grey theme which will make you love the site even more","default":!1,storageKey:"darkenedMode",toggle:function(t){t===!0?(c(),e.settings.get("splitChat")!==!1&&($("#splitChat").remove(),i())):($("#darkTwitch").remove(),l(),e.settings.get("splitChat")!==!1&&($("#splitChat").remove(),i()))},load:function(){var t=!1;window.App&&App.__container__.lookup("controller:Layout")&&App.__container__.lookup("controller:Layout").addObserver("isTheatreMode",function(){this.get("isTheatreMode")===!0?(t=e.settings.get("darkenedMode"),t===!1&&(e.settings.save("darkenedMode",!0),e.storage.put("bttv_darkenedMode",!1))):t===!1&&e.settings.save("darkenedMode",!1)})}},{name:"Default to Live Channels",description:'BetterTTV can click on "Channels" for you in the Following Overview automatically',"default":!1,storageKey:"showDirectoryLiveTab"},{name:"Desktop Notifications",description:"BetterTTV can send you desktop notifications when you are tabbed out of Twitch","default":!1,storageKey:"desktopNotifications",toggle:function(t){t===!0?window.Notification?"default"===Notification.permission||window.webkitNotifications&&1===webkitNotifications.checkPermission()?Notification.requestPermission(function(){"granted"===Notification.permission||window.webkitNotifications&&0===webkitNotifications.checkPermission()?(e.settings.save("desktopNotifications",!0),e.notify("Desktop notifications are now enabled.")):e.notify("You denied BetterTTV permission to send you notifications.")}):"granted"===Notification.permission||window.webkitNotifications&&0===webkitNotifications.checkPermission()?(e.settings.save("desktopNotifications",!0),e.notify("Desktop notifications are now enabled.")):"denied"===Notification.permission||window.webkitNotifications&&2===webkitNotifications.checkPermission()?Notification.requestPermission(function(){"granted"===Notification.permission||window.webkitNotifications&&0===webkitNotifications.checkPermission()?(e.settings.save("desktopNotifications",!0),e.notify("Desktop notifications are now enabled.")):e.notify("You denied BetterTTV permission to send you notifications.")}):e.notify("Your browser is not capable of desktop notifications."):e.notify("Your browser is not capable of desktop notifications."):e.notify("Desktop notifications are now disabled.")}},{name:"Double-Click Translation",description:"Double-clicking on chat lines translates them with Google Translate","default":!0,storageKey:"dblclickTranslation",toggle:function(e){e===!0?$("body").on("dblclick",".chat-line",function(){o.helpers.translate($(this).find(".message"),$(this).data("sender"),$(this).find(".message").data("raw")),$(this).find(".message").text("Translating.."),$("div.tipsy").remove()}):$("body").unbind("dblclick")}},{name:"Disable Host Mode",description:"Disables hosted channels on Twitch","default":!1,storageKey:"disableHostMode",toggle:function(e){try{window.App.set("enableHostMode",!e)}catch(t){}},load:function(){try{window.App.set("enableHostMode",!e.settings.get("disableHostMode"))}catch(t){}}},{name:"Disable Name Colors",description:"Disables colors in chat (useful for those who may suffer from color blindness)","default":!1,storageKey:"disableUsernameColors",toggle:function(e){e===!0?$(".ember-chat .chat-room").addClass("no-name-colors"):$(".ember-chat .chat-room").removeClass("no-name-colors")}},{name:"Disable Whispers",description:"Disables the Twitch whisper feature and hides any whispers you receive","default":!1,storageKey:"disableWhispers"},{name:"Double-Click Auto-Complete",description:"Double-clicking a username in chat copies it into the chat text box","default":!1,storageKey:"dblClickAutoComplete"},{name:"Embedded Polling",description:"See polls posted by the broadcaster embedded right into chat","default":!0,storageKey:"embeddedPolling"},{name:"Emote Menu",description:"Get a more advanced emote menu for Twitch. (Made by Ryan Chatham)","default":!1,storageKey:"clickTwitchEmotes",toggle:function(e){e===!0?f():($("#emote-menu-button").remove(),$("#clickTwitchEmotes").remove())}},{name:"Featured Channels",description:"The left sidebar is too cluttered, so BetterTTV removes featured channels by default","default":!1,storageKey:"showFeaturedChannels",toggle:function(e){e===!0?(g("#nav_games"),g("#nav_streams"),g("#nav_related_streams")):(m("#nav_games"),m("#nav_streams"),m("#nav_related_streams"))}},{name:"Hide Group Chat",description:"Hides the group chat bar above chat","default":!1,storageKey:"groupChatRemoval",toggle:function(e){e===!0?u.load("hide-group-chat","groupChatRemoval"):u.unload("groupChatRemoval")},load:function(){u.load("hide-group-chat","groupChatRemoval")}},{name:"Host Button",description:"Places a Host/Unhost button below the video player","default":!1,storageKey:"hostButton",toggle:function(e){e===!0?d():$("#bttv-host-button").remove()}},{name:"JTV Chat Badges",description:"BetterTTV can replace the chat badges with the ones from JTV","default":!1,storageKey:"showJTVTags"},{name:"JTV Monkey Emotes",description:"BetterTTV replaces the robot emoticons with the old JTV monkey faces","default":!1,storageKey:"showMonkeyEmotes"},{name:"Mod Card Keybinds",description:"Enable keybinds when you click on a username: P(urge), T(imeout), B(an), W(whisper)","default":!1,storageKey:"modcardsKeybinds"},{name:"Other Messages Alert",description:'BetterTTV can alert you when you receive a message to your "Other" messages folder',"default":!1,storageKey:"alertOtherMessages"},{name:"Play Sound on Highlight/Whisper",description:"Get audio feedback for messages directed at you (BETA)","default":!1,storageKey:"highlightFeedback"},{name:"Remove Deleted Messages",description:"Completely removes timed out messages from view","default":!1,storageKey:"hideDeletedMessages"},{name:"Show Deleted Messages",description:"Turn this on to change <message deleted> back to users' messages.","default":!1,storageKey:"showDeletedMessages"},{name:"Split Chat",description:"Easily distinguish between messages from different users in chat","default":!1,storageKey:"splitChat",toggle:function(e){e===!0?i():$("#splitChat").remove()}},{name:"Tab Completion Tooltip",description:"Shows a tooltip with suggested names when using tab completion","default":!1,storageKey:"tabCompletionTooltip"},{name:"TwitchCast",description:"Watch a Twitch stream via Chromecast (Google Chrome only)","default":!1,storageKey:"twitchCast",toggle:function(){s()}},{"default":"",storageKey:"blacklistKeywords",toggle:function(e){var t=/\{.+?\}/g,n=e.match(t),r=[];if(n)for(s=0;s<n.length;s++){var a=n[s];e=e.replace(a,"").replace(/\s\s+/g," ").trim(),r.push('"'+a.replace(/(^\{|\}$)/g,"").trim()+'"')}e=""===e?r:e.split(" ").concat(r);for(var s=0;s<e.length;s++)/^\([a-z0-9_\-\*]+\)$/i.test(e[s])&&(e[s]=e[s].replace(/(\(|\))/g,""));var i=e.join(", ");""===i?o.helpers.serverMessage("Blacklist Keywords list is empty",!0):o.helpers.serverMessage("Blacklist Keywords are now set to: "+i,!0)}},{"default":!0,storageKey:"chatLineHistory",toggle:function(e){e===!0?o.helpers.serverMessage("Chat line history enabled.",!0):o.helpers.serverMessage("Chat line history disabled.",!0)}},{"default":340,storageKey:"chatWidth"},{"default":!1,storageKey:"consoleLog"},{"default":!1,storageKey:"flipDashboard",toggle:function(e){e===!0?($("#flipDashboard").text("Unflip Dashboard"),h()):($("#flipDashboard").text("Flip Dashboard"),h())}},{"default":r.userData.isLoggedIn?r.userData.login:"",storageKey:"highlightKeywords",toggle:function(e){var t=/\{.+?\}/g,n=e.match(t),r=[];if(n)for(s=0;s<n.length;s++){var a=n[s];e=e.replace(a,"").replace(/\s\s+/g," ").trim(),r.push('"'+a.replace(/(^\{|\}$)/g,"").trim()+'"')}e=""===e?r:e.split(" ").concat(r);for(var s=0;s<e.length;s++)/^\([a-z0-9_\-\*]+\)$/i.test(e[s])&&(e[s]=e[s].replace(/(\(|\))/g,""));var i=e.join(", ");""===i?o.helpers.serverMessage("Highlight Keywords list is empty",!0):o.helpers.serverMessage("Highlight Keywords are now set to: "+i,!0)}},{"default":150,storageKey:"scrollbackAmount",toggle:function(e){150===e?o.helpers.serverMessage("Chat scrollback is now set to: default (150)",!0):o.helpers.serverMessage("Chat scrollback is now set to: "+e,!0)}}]},{"./features/anon-chat":13,"./features/auto-theatre-mode":15,"./features/beta-chat":16,"./features/channel-reformat":19,"./features/css-loader":28,"./features/darken-page":29,"./features/flip-dashboard":34,"./features/handle-background":37,"./features/handle-twitchchat-emotes":38,"./features/host-btn-below-video":39,"./features/image-preview":40,"./features/split-chat":44,"./helpers/element":47}],53:[function(t,n){function o(){this._settings={},this.prefix="bttv_"}var r=t("./helpers/debug"),a=t("./helpers/filesaver").saveAs;o.prototype._parseSetting=function(e){return null==e?null:"true"===e?!0:"false"===e?!1:""===e?"":isNaN(e)===!1?parseInt(e):e},o.prototype.load=function(){var n=this,o=t("./settings-list"),r=t("./templates/setting-switch"),a='         <div class="option">             Think something is missing here? Send in a <a href="https://github.com/night/BetterTTV/issues/new?labels=enhancement" target="_blank">feature request</a>!         </div>     ';o.forEach(function(t){if(n._settings[t.storageKey]=t,n._settings[t.storageKey].value=null!==e.storage.get(n.prefix+t.storageKey)?n._parseSetting(e.storage.get(n.prefix+t.storageKey)):t.default,t.name){var o=r(t);$("#bttvSettings .options-list").append(o),n._settings[t.storageKey].value===!0?$("#"+t.storageKey+"True").prop("checked",!0):$("#"+t.storageKey+"False").prop("checked",!0)}t.hidden&&($("#bttvSettingsPanel .bttvOption-"+t.storageKey).css("display","none"),$("#bttvSettingsPanel .bttvOption-"+t.storageKey).addClass("konami")),t.load&&t.load()}),$("#bttvSettings .options-list").append(a),$(".option input:radio").change(function(e){n.save(e.target.name,n._parseSetting(e.target.value))});var s=e.storage.getObject("bttvNotifications");for(var i in s)if(s.hasOwnProperty(i)){var c=s[i];c.expire<Date.now()&&e.storage.spliceObject("bttvNotifications",i)}var l=function(e){if(e.origin===window.location.protocol+"//"+window.location.host&&e.data){if("string"!=typeof e.data)return;var t=e.data.split(" ");if("bttv_setting"===t[0]){var o=t[1],r=n._parseSetting(t[2]);n.set(o,r)}}};window.addEventListener("message",l,!1)},o.prototype.backup=function(){var e={},t=this;Object.keys(this._settings).forEach(function(n){var o=t._settings[n].value;e[n]=o}),e=new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8;"}),a(e,"bttv_settings.backup")},o.prototype.import=function(t){var n=this,o=function(e,t){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.readAsText(e.files[0])},a=function(e){try{JSON.parse(e)}catch(t){return!1}return!0};o(t,function(t){if(a(t)){var o=JSON.parse(t),s=0;Object.keys(o).forEach(function(e){try{n.set(e,o[e]),s++}catch(t){r.log("Import Error: "+e+" does not exist in settings list. Ignoring...")}}),e.notify("BetterTTV imported "+s+" settings, and will now refresh in a few seconds."),setTimeout(function(){window.location.reload()},3e3)}else e.notify("You uploaded an invalid file.")})},o.prototype.get=function(e){return e in this._settings?this._settings[e].value:null},o.prototype.set=function(t,n){this._settings[t].value=n,e.storage.put(this.prefix+t,n)},o.prototype.save=function(e,t){if(/\?bttvSettings=true/.test(window.location))window.opener.postMessage("bttv_setting "+e+" "+t,window.location.protocol+"//"+window.location.host);else try{window.__bttvga&&__bttvga("send","event","BTTV","Change Setting: "+e+"="+t),window!==window.top&&window.parent.postMessage("bttv_setting "+e+" "+t,window.location.protocol+"//"+window.location.host),this.set(e,t),this._settings[e].toggle&&this._settings[e].toggle(t)}catch(n){r.log(n)}},o.prototype.popup=function(){var e=window.location.protocol+"//"+window.location.host+"/settings?bttvSettings=true";window.open(e,"BetterTTV Settings","width=800,height=500,top=500,left=800,scrollbars=no,location=no,directories=no,status=no,menubar=no,toolbar=no,resizable=no")},n.exports=o},{"./helpers/debug":46,"./helpers/filesaver":48,"./settings-list":52,"./templates/setting-switch":61}],54:[function(t,n){function o(){this.socket=r("https://sockets.betterttv.net/",{reconnection:!0,reconnectionDelay:3e4,reconnectionDelayMax:3e5}),this._lookedUpUsers=[],this._connected=!1;var t=this;this.socket.on("connect",function(){a.log("SocketClient: Connected to BetterTTV Socket Server"),t._connected=!0}),this.socket.on("disconnect",function(){a.log("SocketClient: Disconnected from BetterTTV Socket Server"),t._connected=!1}),this.socket.on("alert",function(t){"chat"===t.type?e.chat.helpers.serverMessage(t.message):"growl"===t.type&&e.notify(t.message.text,t.message.title,t.message.url,t.message.image,t.message.tag,t.message.permanent)}),this.socket.on("new_subscriber",function(t){t.channel===e.getChannel()&&(e.chat.helpers.notifyMessage("subscriber",e.chat.helpers.lookupDisplayName(t.user)+" just subscribed!"),e.chat.store.__subscriptions[t.user]=["night"],e.chat.helpers.reparseMessages(t.user))}),this.socket.on("commercial",function(t){t.channel===e.getChannel()&&s.userData.isLoggedIn&&e.chat.helpers.isModerator(s.userData.login)&&e.chat.helpers.notifyMessage("bot",t.message)})}var r=t("socket.io-client"),a=t("./helpers/debug"),s=t("./vars");o.prototype.lookupUser=function(t){this._connected&&this.socket.connected&&(this._lookedUpUsers.indexOf(t)>-1||(this._lookedUpUsers.push(t),this.socket.emit("lookup_user",t,function(n){n&&(e.chat.store.__subscriptions[t]=["night"],n.glow&&e.chat.store.__subscriptions[t].push("_glow"),e.chat.helpers.reparseMessages(t))})))},o.prototype.joinChannel=function(){if(this._connected&&this.socket.connected&&e.getChannel().length&&(this.socket.emit("join_channel",e.getChannel()),"night"===e.getChannel())){var t=document.createElement("style");t.type="text/css",t.innerHTML='.badge.subscriber { background-image: url("https://cdn.betterttv.net/tags/supporter.png") !important; }',e.jQuery(".ember-chat .chat-room").append(t)}},o.prototype.giveEmoteTip=function(e){this._connected&&this.socket.connected&&this.socket.emit("give_emote_tip",e,function(t){a.log("SocketClient: Gave an emote tip about "+e+" (success: "+t+")")})},n.exports=o},{"./helpers/debug":46,"./vars":64,"socket.io-client":67}],55:[function(e,t){function n(){if(this._localStorageSupport=!0,window.localStorage)try{window.localStorage.setItem("bttv_test","it works!"),window.localStorage.removeItem("bttv_test")}catch(e){r.log("window.localStorage detected, but unable to save. Defaulting to cookies."),this._localStorageSupport=!1}else r.log("window.localStorage not detected. Defaulting to cookies."),this._localStorageSupport=!1
}var o=e("cookies-js"),r=e("./helpers/debug");n.prototype.exists=function(e){return this.get(e)?!0:!1},n.prototype.get=function(e){return this._localStorageSupport?window.localStorage.getItem(e):o.get(e)},n.prototype.getArray=function(e){return this.exists(e)||this.putArray(e,[]),JSON.parse(this.get(e))},n.prototype.getObject=function(e){return this.exists(e)||this.putObject(e,{}),JSON.parse(this.get(e))},n.prototype.put=function(e,t){this._localStorageSupport?window.localStorage.setItem(e,t):o.set(e,t,{expires:1/0})},n.prototype.pushArray=function(e,t){var n=this.getArray(e);n.push(t),this.putArray(e,n)},n.prototype.pushObject=function(e,t,n){var o=this.getObject(e);o[t]=n,this.putObject(e,o)},n.prototype.putArray=function(e,t){this.put(e,JSON.stringify(t))},n.prototype.putObject=function(e,t){this.put(e,JSON.stringify(t))},n.prototype.spliceArray=function(e,t){var n=this.getArray(e);-1!==n.indexOf(t)&&n.splice(n.indexOf(t),1),this.putArray(e,n)},n.prototype.spliceObject=function(e,t){var n=this.getObject(e);delete n[t],this.putObject(e,n)},t.exports=n},{"./helpers/debug":46,"cookies-js":65}],56:[function(e,t){function n(){var e=[];return e.push('<div id="bttv-channel-state-contain"><div title="Robot9000 Enabled" class="r9k"><svg width="26px" height="22px" version="1.1" viewBox="0 0 26 22" x="0px" y="0px"><path clip-rule="evenodd" fill-rule="evenodd" fill="#d3d3d3" stroke="none" d="M2.98763607,10.2134233 C2.98763607,9.87789913 2.97951867,9.53696837 2.96328363,9.19062081 C2.94704859,8.84427325 2.93351959,8.3951105 2.92269623,7.84311909 L3.97796866,7.84311909 L3.97796866,9.25556065 L4.01043858,9.25556065 C4.08620211,9.04991679 4.1944341,8.85239341 4.33513779,8.66298459 C4.47584149,8.47357577 4.64630687,8.30311039 4.84653905,8.15158334 C5.04677123,8.00005628 5.27947001,7.87829529 5.54464235,7.78629672 C5.8098147,7.69429815 6.11015847,7.64829956 6.44568266,7.64829956 C6.74873677,7.64829956 7.01390514,7.68076916 7.24119573,7.74570932 L7.03014124,8.80098176 C6.88943755,8.74686495 6.68379677,8.71980695 6.41321274,8.71980695 C6.00192502,8.71980695 5.65017106,8.79827515 5.35794031,8.95521388 C5.06570956,9.11215262 4.82218758,9.3123818 4.62736708,9.55590742 C4.43254658,9.79943305 4.2891392,10.0618956 4.19714063,10.343303 C4.10514206,10.6247104 4.05914347,10.8952904 4.05914347,11.155051 L4.05914347,15.4410806 L2.98763607,15.4410806 L2.98763607,10.2134233 Z M14.1735239,7.30736539 C14.1735239,6.93937111 14.1112905,6.60385195 13.9868218,6.30079784 C13.8623532,5.99774372 13.6864762,5.73798695 13.4591856,5.52151973 C13.231895,5.30505251 12.9613151,5.13458713 12.6474376,5.01011847 C12.3335601,4.88564982 11.9872178,4.82341643 11.6084001,4.82341643 C11.2295825,4.82341643 10.8832401,4.88564982 10.5693626,5.01011847 C10.2554852,5.13458713 9.98490519,5.30505251 9.75761461,5.52151973 C9.53032403,5.73798695 9.35444705,5.99774372 9.22997839,6.30079784 C9.10550974,6.60385195 9.04327635,6.93937111 9.04327635,7.30736539 C9.04327635,7.67535967 9.10550974,8.01087883 9.22997839,8.31393294 C9.35444705,8.61698705 9.53032403,8.87944962 9.75761461,9.10132853 C9.98490519,9.32320743 10.2554852,9.49367281 10.5693626,9.61272978 C10.8832401,9.73178676 11.2295825,9.79131435 11.6084001,9.79131435 C11.9872178,9.79131435 12.3335601,9.73178676 12.6474376,9.61272978 C12.9613151,9.49367281 13.231895,9.32320743 13.4591856,9.10132853 C13.6864762,8.87944962 13.8623532,8.61698705 13.9868218,8.31393294 C14.1112905,8.01087883 14.1735239,7.67535967 14.1735239,7.30736539 L14.1735239,7.30736539 Z M13.0046067,10.5056526 L12.9721368,10.4731827 C12.7881397,10.603063 12.5419119,10.7004718 12.2334461,10.765412 C11.9249803,10.8303521 11.6408713,10.8628217 11.3811107,10.8628217 C10.8832361,10.8628217 10.4205443,10.7735304 9.99302154,10.5949449 C9.56549877,10.4163594 9.19480422,10.1701317 8.88092674,9.85625419 C8.56704927,9.54237672 8.3208215,9.16897636 8.14223604,8.73604192 C7.96365058,8.30310747 7.87435919,7.82688672 7.87435919,7.30736539 C7.87435919,6.77702069 7.96635638,6.29538835 8.15035352,5.8624539 C8.33435066,5.42951946 8.59410743,5.0561191 8.92963162,4.74224162 C9.26515582,4.42836415 9.66020257,4.18484218 10.1147837,4.0116684 C10.5693649,3.83849462 11.0672321,3.75190903 11.6084001,3.75190903 C12.1495682,3.75190903 12.6474353,3.83849462 13.1020165,4.0116684 C13.5565976,4.18484218 13.9516444,4.42836415 14.2871686,4.74224162 C14.6226928,5.0561191 14.8824496,5.42951946 15.0664467,5.8624539 C15.2504438,6.29538835 15.342441,6.77702069 15.342441,7.30736539 C15.342441,7.9459437 15.247738,8.50333843 15.0583292,8.97956632 C14.8689204,9.45579421 14.6335158,9.92660336 14.3521084,10.3920079 L11.251231,15.4410806 L9.87125933,15.4410806 L13.0046067,10.5056526 Z M18.3621437,11.2686958 L21.95007,7.84311909 L23.5573311,7.84311909 L19.7745853,11.3174006 L23.9632051,15.4410806 L22.3072391,15.4410806 L18.3621437,11.4472803 L18.3621437,15.4410806 L17.2906363,15.4410806 L17.2906363,3.16745045 L18.3621437,3.16745045 L18.3621437,11.2686958 Z"></path></svg></div><div title="Subscribers-Only Mode Enabled" class="subs-only"><svg width="26px" height="22px" version="1.1" viewBox="0 0 26 22" x="0px" y="0px"><path clip-rule="evenodd" fill-rule="evenodd" fill="#d3d3d3" stroke="none" d="M9.27481618,13.6268381 C9.27481619,15.0585936 21.1132816,15.0078128 21.1132816,13.6268381 C21.1132816,12.2458633 16.9215274,13.7446739 16.6289064,11.3913143 C16.3362854,9.03795478 17.8113514,9.06502765 17.8113514,7.74195776 C17.8113514,6.41888788 16.1631438,5.44732696 15.194049,5.3492647 C14.2249543,5.25120244 12.5834099,6.17624082 12.5834099,7.74195772 C12.5834099,9.30767461 13.8025847,9.44785699 13.6895682,11.3913143 C13.5765516,13.3347717 9.27481616,12.1950825 9.27481618,13.6268381 Z"></path><path clip-rule="evenodd" fill-rule="evenodd" fill="#d3d3d3" stroke="none" d="M9.05269623,4.02031837 C9.41269803,4.02031837 9.78602763,4.06698457 10.1726962,4.16031837 C10.5593648,4.25365217 10.8993614,4.41698387 11.1926962,4.65031837 L10.2326962,5.82031837 C10.0726954,5.68031767 9.88936393,5.57865202 9.68269623,5.51531837 C9.47602853,5.45198472 9.26603063,5.41365177 9.05269623,5.40031837 L9.05269623,6.99031837 L10.0126962,7.27031837 C10.4526984,7.40365237 10.8043616,7.62198352 11.0676962,7.92531837 C11.3310309,8.22865322 11.4626962,8.61364937 11.4626962,9.08031837 C11.4626962,9.43365347 11.3993635,9.74365037 11.2726962,10.0103184 C11.1460289,10.2769864 10.9726973,10.5036508 10.7526962,10.6903184 C10.5326951,10.876986 10.276031,11.0236512 9.98269623,11.1303184 C9.68936143,11.2369856 9.37936453,11.3069849 9.05269623,11.3403184 L9.05269623,12.0403184 L8.39269623,12.0403184 L8.39269623,11.3403184 C7.95269403,11.3403184 7.51436508,11.280319 7.07769623,11.1603184 C6.64102738,11.0403178 6.25603123,10.8303199 5.92269623,10.5303184 L6.98269623,9.34031837 C7.15603043,9.55365277 7.36602833,9.70531792 7.61269623,9.79531837 C7.85936413,9.88531882 8.11936153,9.94031827 8.39269623,9.96031837 L8.39269623,8.27031837 L7.66269623,8.05031837 C7.15602703,7.89031757 6.77103088,7.66531982 6.50769623,7.37531837 C6.24436158,7.08531692 6.11269623,6.68698757 6.11269623,6.18031837 C6.11269623,5.86698347 6.17602893,5.58365297 6.30269623,5.33031837 C6.42936353,5.07698377 6.59769518,4.86031927 6.80769623,4.68031837 C7.01769728,4.50031747 7.26102818,4.35365227 7.53769623,4.24031837 C7.81436428,4.12698447 8.09936143,4.05365187 8.39269623,4.02031837 L8.39269623,3.32031837 L9.05269623,3.32031837 L9.05269623,4.02031837 Z M8.39269623,5.43031837 C8.20602863,5.47031857 8.03936363,5.54031787 7.89269623,5.64031837 C7.74602883,5.74031887 7.67269623,5.89698397 7.67269623,6.11031837 C7.67269623,6.26365247 7.70269593,6.38365127 7.76269623,6.47031837 C7.82269653,6.55698547 7.89269583,6.62531812 7.97269623,6.67531837 C8.05269663,6.72531862 8.13269583,6.76031827 8.21269623,6.78031837 C8.29269663,6.80031847 8.35269603,6.81698497 8.39269623,6.83031837 L8.39269623,5.43031837 Z M9.05269623,9.94031837 C9.15269673,9.92031827 9.25436238,9.89198522 9.35769623,9.85531837 C9.46103008,9.81865152 9.55269583,9.77031867 9.63269623,9.71031837 C9.71269663,9.65031807 9.77769598,9.57865212 9.82769623,9.49531837 C9.87769648,9.41198462 9.90269623,9.31365227 9.90269623,9.20031837 C9.90269623,9.09365117 9.88436308,9.00365207 9.84769623,8.93031837 C9.81102938,8.85698467 9.76269653,8.79531862 9.70269623,8.74531837 C9.64269593,8.69531812 9.57269663,8.65198522 9.49269623,8.61531837 C9.41269583,8.57865152 9.32936333,8.54365187 9.24269623,8.51031837 L9.05269623,8.44031837 L9.05269623,9.94031837 Z"></path></svg></div><div class="slow"><div title="0 seconds" class="slow-time">0:00</div><svg width="26px" height="22px" version="1.1" viewBox="0 0 26 22" x="0px" y="0px" title="Slow Mode Enabled"><path clip-rule="evenodd" fill-rule="evenodd" fill="#d3d3d3" stroke="none" d="M17.1477712,15.2881724 C18.1841482,15.2990242 18.3714659,13.1141401 18.984666,13.0696235 C20.7929233,12.9383492 21.27411,12.5312339 22.0061575,11.9392359 C23.1373692,11.0244387 19.9060764,12.1089751 19.4762501,10.2570139 C19.0464238,8.40505269 20.0193482,10.024402 20.0193482,10.024402 C20.0193482,10.024402 21.8187185,4.26759557 15.5617966,4.00868857 C9.30487476,3.74978158 10.4161868,9.36314385 10.4161868,9.36314385 C10.4161868,9.36314385 11.2540951,8.34295601 11.2540951,9.63941257 C11.2540951,10.1964047 9.76901904,10.6570445 8.53287358,9.63941257 C7.29672813,8.62178061 8.11686902,7.37127839 7.67827778,6.69569265 C7.23968654,6.02010691 3.76038497,5.06926224 3.24213373,5.95824564 C2.72388249,6.84722904 5.76831809,8.74663617 5.96217543,9.63941257 C6.15603277,10.532189 7.03943787,12.1288651 7.49294803,12.5678492 C7.94645819,13.0068332 5.92939735,14.4797566 6.69153143,14.5326896 C7.45366552,14.5856225 9.47706304,12.9278239 10.0844223,12.7478364 C10.6917815,12.5678489 13.1392341,12.9471552 14.5871877,13.023578 C15.3550569,13.064106 16.1113943,15.2773206 17.1477712,15.2881724 Z M4.84344721,6.76429629 C5.04601701,6.76429629 5.21023228,6.60974074 5.21023228,6.41908681 C5.21023228,6.22843288 5.04601701,6.07387733 4.84344721,6.07387733 C4.6408774,6.07387733 4.47666213,6.22843288 4.47666213,6.41908681 C4.47666213,6.60974074 4.6408774,6.76429629 4.84344721,6.76429629 Z M11.7028228,7.36314163 C11.7326095,6.35178988 13.3449525,4.92929352 15.0963754,4.98088076 C16.8477983,5.032468 18.7948736,6.68625403 18.7749376,7.36314154 C18.7550016,8.04002904 16.952545,5.71526454 15.0963754,5.66059204 C13.2402058,5.60591954 11.673036,8.37449337 11.7028228,7.36314163 Z"></path></svg></div></div>'),e.join("")}t.exports=n},{}],57:[function(t,n){function o(t){var n=[],o=t||{};return function(e,t,o){n.push('<div class="list-header">BetterTTV</div><div class="chat-menu-content">'),e('body[data-page="ember#chat"]').length&&n.push('<p><a href="#" class="g18_gear-00000080 blackChatLink">Black Chat (Chroma Key)</a></p>'),(e("#dash_main").length||t!==t.top)&&(n.push('<p><a href="#" class="g18_gear-00000080 flipDashboard">'),n.push(o.settings.get("flipDashboard")?"Unflip Dashboard":"Flip Dashboard"),n.push("</a></p>")),n.push('<p><input type="checkbox"'+jade.attr("checked",o.settings.get("darkenedMode"),!0,!1)+' class="toggleDarkenTTV"/>Dark Mode</p><p><a href="#" class="g18_gear-00000080 setBlacklistKeywords">Set Blacklist Keywords</a></p><p><a href="#" class="g18_gear-00000080 setHighlightKeywords">Set Highlight Keywords</a></p><p><a href="#" class="g18_gear-00000080 setScrollbackAmount">Set Scrollback Amount</a></p><p><a href="#" class="g18_trash-00000080 clearChat">Clear My Chat</a></p><p><a href="#" style="display: block;margin-top: 8px;text-align: center;" class="button-simple dark openSettings">BetterTTV Settings</a></p></div>')}.call(this,"$"in o?o.$:"undefined"!=typeof $?$:void 0,"window"in o?o.window:"undefined"!=typeof window?window:void 0,"bttv"in o?o.bttv:"undefined"!=typeof e?e:void 0),n.join("")}n.exports=o},{}],58:[function(e,t){function n(e){var t,n=[],o=e||{};return function(e,o){n.push('<div class="suggestions">'),function(){var r=e;if("number"==typeof r.length)for(var a=0,s=r.length;s>a;a++){var i=r[a],c=a===o?["highlighted"]:[];n.push("<div"+jade.cls([c],[!0])+'><div class="suggestion"><span>'+jade.escape(null==(t=i)?"":t)+"</span></div></div>")}else{var s=0;for(var a in r){s++;var i=r[a],c=a===o?["highlighted"]:[];n.push("<div"+jade.cls([c],[!0])+'><div class="suggestion"><span>'+jade.escape(null==(t=i)?"":t)+"</span></div></div>")}}}.call(this),n.push("</div>")}.call(this,"suggestions"in o?o.suggestions:"undefined"!=typeof suggestions?suggestions:void 0,"index"in o?o.index:"undefined"!=typeof index?index:void 0),n.join("")}t.exports=n},{}],59:[function(e,t){function n(e){var t=[],n=e||{};return function(e){t.push('<div id="bttv-poll-contain"><div class="title">New poll available! <span style="text-decoration: underline;">Vote now!</span></div><div class="close"><svg height="16px" version="1.1" viewbox="0 0 16 16" width="16px" x="0px" y="0px" class="svg-close"><path clip-rule="evenodd" d="M13.657,3.757L9.414,8l4.243,4.242l-1.415,1.415L8,9.414l-4.243,4.243l-1.414-1.415L6.586,8L2.343,3.757l1.414-1.414L8,6.586l4.242-4.243L13.657,3.757z" fill-rule="evenodd"></path></svg></div><iframe'+jade.attr("src","https://strawpoll.me/embed_2/"+e,!0,!1)+' class="frame"></iframe></div>')}.call(this,"pollId"in n?n.pollId:"undefined"!=typeof pollId?pollId:void 0),t.join("")}t.exports=n},{}],60:[function(t,n){function o(n){var o,r=[],a=n||{};return function(e,t,n,a,s,i,c){var l=e("../vars");r.push("<div"+jade.attr("data-user",t.name,!0,!1)+jade.attr("style","top: "+n+"px;left: "+a+"px;",!0,!1)+' class="bttv-mod-card ember-view moderation-card"><div class="close-button"><svg height="16px" version="1.1" viewbox="0 0 16 16" width="16px" x="0px" y="0px" class="svg-close"><path clip-rule="evenodd" d="M13.657,3.757L9.414,8l4.243,4.242l-1.415,1.415L8,9.414l-4.243,4.243l-1.414-1.415L6.586,8L2.343,3.757l1.414-1.414L8,6.586l4.242-4.243L13.657,3.757z" fill-rule="evenodd"></path></svg></div><div'+jade.attr("style","background-color: "+(t.profile_banner_background_color?t.profile_banner_background_color:"#000"),!0,!1)+' class="card-header"><img'+jade.attr("src",t.logo?t.logo:"https://www-cdn.jtvnw.net/images/xarth/404_user_300x300.png",!0,!1)+' class="channel_logo"/><div class="drag-handle"></div><h3 class="name"><a'+jade.attr("href",s.url.profile(t.name),!0,!1)+' target="_blank">'+jade.escape(null==(o=i.storage.getObject("nicknames")[t.name.toLowerCase()]||t.display_name)?"":o)+'</a><svg style="margin-left: 5px;" height="10px" width="10px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-edit mod-card-edit"><path clip-rule="evenodd" fill-rule="evenodd" d="M6.414,12.414L3.586,9.586l8-8l2.828,2.828L6.414,12.414z M4.829,14H2l0,0v-2.828l0.586-0.586l2.828,2.828L4.829,14z"></path></svg></h3>'),i.storage.getObject("nicknames")[t.name.toLowerCase()]&&r.push('<h4 class="real-name">'+jade.escape(null==(o=t.display_name)?"":o)+"</h4>"),r.push('<h4 class="created-at">'+jade.escape(null==(o="Created "+c.parse(t.created_at).toString("MMM d, yyyy"))?"":o)+'</h4><div class="channel_background_cover"></div>'),t.profile_banner&&r.push("<img"+jade.attr("src",t.profile_banner,!0,!1)+' class="channel_background"/>'),r.push('<div class="channel-stats"><span class="stat">'+jade.escape(null==(o=s.display.commatize(t.views))?"":o)+'<svg height="16px" version="1.1" viewbox="1 1 16 16" width="16px" x="0px" y="0px" class="svg-glyph_views"><path clip-rule="evenodd" d="M11,13H5L1,9V8V7l4-4h6l4,4v1v1L11,13z M8,5C6.344,5,5,6.343,5,8c0,1.656,1.344,3,3,3c1.657,0,3-1.344,3-3C11,6.343,9.657,5,8,5z M8,9C7.447,9,7,8.552,7,8s0.447-1,1-1s1,0.448,1,1S8.553,9,8,9z" fill-rule="evenodd"></path></svg></span><span class="stat">'+jade.escape(null==(o=s.display.commatize(t.followers))?"":o)+'<svg height="16px" version="1.1" viewbox="0 0 16 16" width="16px" x="0px" y="0px" class="svg-glyph_followers"><path clip-rule="evenodd" d="M8,13.5L1.5,7V4l2-2h3L8,3.5L9.5,2h3l2,2v3L8,13.5z" fill-rule="evenodd"></path></svg></span></div></div>'),t.name!=l.userData.login&&(r.push('<div class="interface"><div class="btn-wrapper"><button class="button-simple primary mod-card-follow">Follow</button><button style="height: 30px;vertical-align: top;" title="View user\'s profile" class="button-simple dark mod-card-profile"><img src="https://www-cdn.jtvnw.net/images/xarth/g/g18_person-00000080.png" style="margin-top: 6px;"/></button><button style="height: 30px;vertical-align: top;" title="Send user a message" class="button-simple dark mod-card-message"><img src="https://www-cdn.jtvnw.net/images/xarth/g/g18_mail-00000080.png" style="margin-top: 6px;"/></button><button title="Add/Remove user from ignores" class="button-simple dark mod-card-ignore"><svg height="16px" width="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-ignore"><path clip-rule="evenodd" fill-rule="evenodd" d="M13,11.341V16l-3.722-3.102C8.863,12.959,8.438,13,8,13c-3.866,0-7-2.462-7-5.5C1,4.462,4.134,2,8,2s7,2.462,7,5.5C15,8.996,14.234,10.35,13,11.341z M11,7H5v1h6V7z"></path></svg><svg style="display: none;" height="16px" width="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-unignore"><path clip-rule="evenodd" fill-rule="evenodd" d="M13,11.341V16l-3.722-3.102C8.863,12.959,8.438,13,8,13c-3.866,0-7-2.462-7-5.5C1,4.462,4.134,2,8,2s7,2.462,7,5.5C15,8.996,14.234,10.35,13,11.341z"></path></svg></button>'),l.userData.isLoggedIn&&(i.chat.helpers.isOwner(l.userData.login)||i.chat.helpers.isStaff(l.userData.login)||i.chat.helpers.isAdmin(l.userData.login))&&r.push('<button title="Add/Remove this user as a moderator" class="button-simple dark mod-card-mod"><svg height="16px" width="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-add-mod"><path clip-rule="evenodd" fill-rule="evenodd" d="M15,7L1,16l4.666-7H1l14-9l-4.667,7H15z"></path></svg><svg style="display: none;" height="16px" width="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-remove-mod"><path clip-rule="evenodd" fill-rule="evenodd" d="M 1.7692223,7.3226542 14.725057,7.3226542 14.725057,8.199533 1.7692223,8.199533 z M 15,0 5.4375,6.15625 10.90625,6.15625 15,0 z M 5.375,9.40625 1,16 11.25,9.40625 5.375,9.40625 z"></path></svg></button>'),!l.userData.isLoggedIn||!i.chat.helpers.isModerator(l.userData.login)||i.chat.helpers.isModerator(t.name)&&l.userData.login!==i.getChannel()||r.push('<span class="mod-controls"><button title="!permit this user" class="permit button-simple light"><svg height="16px" width="16px" version="1.1" viewBox="0 0 16 16" x="0px" y="0px" class="svg-permit"><path clip-rule="evenodd" fill-rule="evenodd" d="M 13.71875,3.75 A 0.750075,0.750075 0 0 0 13.28125,4 L 5.71875,11.90625 3.59375,9.71875 A 0.750075,0.750075 0 1 0 2.53125,10.75 L 5.21875,13.53125 A 0.750075,0.750075 0 0 0 6.28125,13.5 L 14.34375,5.03125 A 0.750075,0.750075 0 0 0 13.71875,3.75 z M 4.15625,5.15625 C 2.1392444,5.1709094 0.53125,6.2956115 0.53125,7.6875 0.53125,8.1957367 0.75176764,8.6679042 1.125,9.0625 A 1.60016,1.60016 0 0 1 2.15625,8.25 C 2.0893446,8.0866555 2.0625,7.9078494 2.0625,7.71875 2.0625,6.9200694 2.7013192,6.25 3.5,6.25 L 7.15625,6.25 C 7.1438569,5.1585201 6.6779611,5.1379224 4.15625,5.15625 z M 9.625,5.15625 C 8.4334232,5.1999706 8.165545,5.4313901 8.15625,6.25 L 9.96875,6.25 11.03125,5.15625 C 10.471525,5.1447549 9.9897684,5.1428661 9.625,5.15625 z M 14.28125,6.40625 13.3125,7.40625 C 13.336036,7.5094042 13.34375,7.6089314 13.34375,7.71875 13.34375,8.5174307 12.67368,9.125 11.875,9.125 L 11.65625,9.125 10.65625,10.1875 C 10.841425,10.189327 10.941084,10.186143 11.15625,10.1875 13.17327,10.200222 14.78125,9.0793881 14.78125,7.6875 14.78125,7.2160918 14.606145,6.7775069 14.28125,6.40625 z M 4.40625,7.1875 C 4.0977434,7.1875 3.84375,7.4414933 3.84375,7.75 3.84375,8.0585065 4.0977434,8.3125 4.40625,8.3125 L 8,8.3125 9.0625,7.1875 4.40625,7.1875 z M 4.125,9.125 5.15625,10.1875 C 5.5748133,10.180859 5.9978157,10.155426 6.25,10.125 L 7.15625,9.1875 C 7.1572971,9.1653754 7.1553832,9.1481254 7.15625,9.125 L 4.125,9.125 z"></path></svg></button></span><br/><span class="mod-controls"><button style="width:44px;" data-time="1" title="Clear this user\'s chat" class="timeout button-simple light">Purge</button><button data-time="600" title="Temporary 10 minute ban" class="timeout button-simple light"><img src="/images/xarth/g/g18_timeout-00000080.png"/></button><button style="width:30px;" data-time="3600" title="Temporary 1 hour ban" class="timeout button-simple light">1hr</button><button style="width:30px;" data-time="28800" title="Temporary 8 hour ban" class="timeout button-simple light">8hr</button><button style="width:38px;" data-time="86400" title="Temporary 24 hour ban" class="timeout button-simple light">24hr</button><button title="Permanent Ban" class="ban button-simple light"><img src="/images/xarth/g/g18_ban-00000080.png"/></button></span>'),r.push('</div><br/><div class="user-messages"><div class="label"><span>Chat Messages</span><div class="triangle closed"></div></div><div class="message-list chat-messages">'),function(){var e=t.messages;if("number"==typeof e.length)for(var n=0,a=e.length;a>n;n++){var s=e[n];r.push("<div>"+(null==(o=s.outerHTML)?"":o)+"</div>")}else{var a=0;for(var n in e){a++;var s=e[n];r.push("<div>"+(null==(o=s.outerHTML)?"":o)+"</div>")}}}.call(this),r.push("</div></div></div>")),r.push("</div>")}.call(this,"require"in a?a.require:"undefined"!=typeof t?t:void 0,"user"in a?a.user:"undefined"!=typeof user?user:void 0,"top"in a?a.top:"undefined"!=typeof top?top:void 0,"left"in a?a.left:"undefined"!=typeof left?left:void 0,"Twitch"in a?a.Twitch:"undefined"!=typeof Twitch?Twitch:void 0,"bttv"in a?a.bttv:"undefined"!=typeof e?e:void 0,"Date"in a?a.Date:"undefined"!=typeof Date?Date:void 0),r.join("")}n.exports=o},{"../vars":64}],61:[function(e,t){function n(e){var t,n=[],o=e||{};return function(e,o,r){n.push("<div"+jade.cls(["option","bttvOption-"+e],[null,!0])+'><span style="font-weight:bold;font-size:14px;color:#D3D3D3;">'+jade.escape(null==(t=o)?"":t)+"</span>&nbsp;&nbsp;&mdash;&nbsp;&nbsp;"+jade.escape(null==(t=r)?"":t)+'<div class="bttv-switch"><input type="radio"'+jade.attr("name",e,!0,!1)+' value="false"'+jade.attr("id",""+e+"False",!0,!1)+' class="bttv-switch-input bttv-switch-off"/><label'+jade.attr("for",""+e+"False",!0,!1)+' class="bttv-switch-label bttv-switch-label-off">Off</label><input type="radio"'+jade.attr("name",e,!0,!1)+' value="true"'+jade.attr("id",""+e+"True",!0,!1)+' class="bttv-switch-input"/><label'+jade.attr("for",""+e+"True",!0,!1)+' class="bttv-switch-label bttv-switch-label-on">On</label><span class="bttv-switch-selection"></span></div></div>')}.call(this,"storageKey"in o?o.storageKey:"undefined"!=typeof storageKey?storageKey:void 0,"name"in o?o.name:"undefined"!=typeof name?name:void 0,"description"in o?o.description:"undefined"!=typeof description?description:void 0),n.join("")}t.exports=n},{}],62:[function(t,n){function o(t){var n,o=[],r=t||{};return function(e){o.push('<div id="header"><span id="logo"><img height="45px" src="https://cdn.betterttv.net/style/logos/settings_logo.png"/></span><ul class="nav"><li><a href="#bttvAbout">About</a></li><li class="active"><a href="#bttvSettings">Settings</a></li><li><a href="#bttvChannel" target="_blank">Channel</a></li><li><a href="#bttvChangelog">Changelog</a></li><li><a href="#bttvPrivacy">Privacy Policy</a></li><li><a href="#bttvBackup">Backup/Import</a></li></ul><span id="close">&times;</span></div><div id="bttvSettings" style="height:425px;" class="scroll scroll-dark"><div class="tse-content options-list"><h2 class="option">Here you can manage the various BetterTTV options. Click On or Off to toggle settings.</h2></div></div><div id="bttvAbout" style="display:none;"><div class="aboutHalf"><img src="https://cdn.betterttv.net/style/logos/mascot.png" class="bttvAboutIcon"/><h1>BetterTTV v '+jade.escape(null==(n=e.info.versionString())?"":n)+'</h1><h2>from your friends at <a href="https://www.nightdev.com" target="_blank">NightDev</a></h2><br/></div><div class="aboutHalf"><h1 style="margin-top: 100px;">Think this addon is awesome?</h1><br/><br/><h2><a target="_blank" href="https://chrome.google.com/webstore/detail/ajopnjidmegmdimjlfnijceegpefgped">Drop a Review on the Chrome Webstore</a></h2><br/><h2>or maybe</h2><br/><h2><a target="_blank" href="https://streamtip.com/t/night">Support the Developer</a></h2><br/></div></div><div id="bttvChannel" style="display:none;"><iframe frameborder="0" width="100%" height="425"></iframe></div><div id="bttvPrivacy" style="display:none;height:425px;" class="scroll scroll-dark"><div class="tse-content"></div></div><div id="bttvChangelog" style="display:none;height:425px;" class="scroll scroll-dark"><div class="tse-content"></div></div><div id="bttvBackup" style="display:none;height:425px;padding:25px;"><h1 style="padding-bottom:15px;">Backup Settings</h1><button id="bttvBackupButton" class="primary_button"><span>Download</span></button><h1 style="padding-top:25px;padding-bottom:15px;">Import Settings</h1><input id="bttvImportInput" type="file" style="height: 25px;width: 250px;"/></div><div id="footer"><span>BetterTTV &copy; <a href="https://www.nightdev.com" target="_blank">NightDev, LLC</a> 2015</span><span style="float:right;"><a href="https://community.nightdev.com/c/betterttv" target="_blank">Get Support</a> | <a href="https://github.com/night/BetterTTV/issues/new?labels=bug" target="_blank">Report a Bug</a> | <a href="https://streamtip.com/t/night" target="_blank">Support the Developer</a></span></div>')}.call(this,"bttv"in r?r.bttv:"undefined"!=typeof e?e:void 0),o.join("")}n.exports=o},{}],63:[function(t,n){n.exports={_ref:null,_headers:function(t,n){t.setRequestHeader("Client-ID","6x8avioex0zt85ht6py4sq55z6avsea"),e.TwitchAPI._ref.call(Twitch.api,t,n)},_call:function(e,t,n,o){var r=(this._takeover(),window.Twitch.api[e].call(this,t,n,o));return this._untakeover(),r},_takeover:function(){window.Twitch.api._beforeSend&&(this._ref=window.Twitch.api._beforeSend,window.Twitch.api._beforeSend=this._headers)},_untakeover:function(){this._ref&&(window.Twitch.api._beforeSend=this._ref,this._ref=null)},get:function(e,t,n){return this._call("get",e,t,n)},post:function(e,t,n){return this._call("post",e,t,n)},put:function(e,t,n){return this._call("put",e,t,n)},del:function(e,t,n){return this._call("del",e,t,n)}}},{}],64:[function(e,t){t.exports={userData:{isLoggedIn:window.Twitch&&Twitch.user?Twitch.user.isLoggedIn():!1,login:window.Twitch&&Twitch.user?Twitch.user.login():""},settings:{},liveChannels:[],blackChat:!1}},{}],65:[function(e,t,n){!function(e,o){"use strict";var r=function(e){if("object"!=typeof e.document)throw new Error("Cookies.js requires a `window` with a `document` object");var t=function(e,n,o){return 1===arguments.length?t.get(e):t.set(e,n,o)};return t._document=e.document,t._cacheKeyPrefix="cookey.",t._maxExpireDate=new Date("Fri, 31 Dec 9999 23:59:59 UTC"),t.defaults={path:"/",secure:!1},t.get=function(e){return t._cachedDocumentCookie!==t._document.cookie&&t._renewCache(),t._cache[t._cacheKeyPrefix+e]},t.set=function(e,n,r){return r=t._getExtendedOptions(r),r.expires=t._getExpiresDate(n===o?-1:r.expires),t._document.cookie=t._generateCookieString(e,n,r),t},t.expire=function(e,n){return t.set(e,o,n)},t._getExtendedOptions=function(e){return{path:e&&e.path||t.defaults.path,domain:e&&e.domain||t.defaults.domain,expires:e&&e.expires||t.defaults.expires,secure:e&&e.secure!==o?e.secure:t.defaults.secure}},t._isValidDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t._getExpiresDate=function(e,n){if(n=n||new Date,"number"==typeof e?e=1/0===e?t._maxExpireDate:new Date(n.getTime()+1e3*e):"string"==typeof e&&(e=new Date(e)),e&&!t._isValidDate(e))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return e},t._generateCookieString=function(e,t,n){e=e.replace(/[^#$&+\^`|]/g,encodeURIComponent),e=e.replace(/\(/g,"%28").replace(/\)/g,"%29"),t=(t+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),n=n||{};var o=e+"="+t;return o+=n.path?";path="+n.path:"",o+=n.domain?";domain="+n.domain:"",o+=n.expires?";expires="+n.expires.toUTCString():"",o+=n.secure?";secure":""},t._getCacheFromString=function(e){for(var n={},r=e?e.split("; "):[],a=0;a<r.length;a++){var s=t._getKeyValuePairFromCookieString(r[a]);n[t._cacheKeyPrefix+s.key]===o&&(n[t._cacheKeyPrefix+s.key]=s.value)}return n},t._getKeyValuePairFromCookieString=function(e){var t=e.indexOf("=");return t=0>t?e.length:t,{key:decodeURIComponent(e.substr(0,t)),value:decodeURIComponent(e.substr(t+1))}},t._renewCache=function(){t._cache=t._getCacheFromString(t._document.cookie),t._cachedDocumentCookie=t._document.cookie},t._areEnabled=function(){var e="cookies.js",n="1"===t.set(e,1).get(e);return t.expire(e),n},t.enabled=t._areEnabled(),t},a="object"==typeof e.document?r(e):r;"function"==typeof define&&define.amd?define(function(){return a}):"object"==typeof n?("object"==typeof t&&"object"==typeof t.exports&&(n=t.exports=a),n.Cookies=a):e.Cookies=a}("undefined"==typeof window?this:window)},{}],66:[function(e,t,n){(function(e){!function(o){function r(e){throw RangeError(j[e])}function a(e,t){for(var n=e.length;n--;)e[n]=t(e[n]);return e}function s(e,t){return a(e.split(D),t).join(".")}function i(e){for(var t,n,o=[],r=0,a=e.length;a>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&a>r?(n=e.charCodeAt(r++),56320==(64512&n)?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),r--)):o.push(t);return o}function c(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=N(e>>>10&1023|55296),e=56320|1023&e),t+=N(e)}).join("")}function l(e){return 10>e-48?e-22:26>e-65?e-65:26>e-97?e-97:_}function h(e,t){return e+22+75*(26>e)-((0!=t)<<5)}function u(e,t,n){var o=0;for(e=n?R(e/$):e>>1,e+=R(e/t);e>O*x>>1;o+=_)e=R(e/O);return R(o+(O+1)*e/(e+T))}function d(e){var t,n,o,a,s,i,h,d,p,f,g=[],m=e.length,v=0,b=S,y=A;for(n=e.lastIndexOf(E),0>n&&(n=0),o=0;n>o;++o)e.charCodeAt(o)>=128&&r("not-basic"),g.push(e.charCodeAt(o));for(a=n>0?n+1:0;m>a;){for(s=v,i=1,h=_;a>=m&&r("invalid-input"),d=l(e.charCodeAt(a++)),(d>=_||d>R((k-v)/i))&&r("overflow"),v+=d*i,p=y>=h?C:h>=y+x?x:h-y,!(p>d);h+=_)f=_-p,i>R(k/f)&&r("overflow"),i*=f;t=g.length+1,y=u(v-s,t,0==s),R(v/t)>k-b&&r("overflow"),b+=R(v/t),v%=t,g.splice(v++,0,b)}return c(g)}function p(e){var t,n,o,a,s,c,l,d,p,f,g,m,v,b,y,w=[];for(e=i(e),m=e.length,t=S,n=0,s=A,c=0;m>c;++c)g=e[c],128>g&&w.push(N(g));for(o=a=w.length,a&&w.push(E);m>o;){for(l=k,c=0;m>c;++c)g=e[c],g>=t&&l>g&&(l=g);for(v=o+1,l-t>R((k-n)/v)&&r("overflow"),n+=(l-t)*v,t=l,c=0;m>c;++c)if(g=e[c],t>g&&++n>k&&r("overflow"),g==t){for(d=n,p=_;f=s>=p?C:p>=s+x?x:p-s,!(f>d);p+=_)y=d-f,b=_-f,w.push(N(h(f+y%b,0))),d=R(y/b);w.push(N(h(d,0))),s=u(n,v,o==a),n=0,++o}++n,++t}return w.join("")}function f(e){return s(e,function(e){return M.test(e)?d(e.slice(4).toLowerCase()):e})}function g(e){return s(e,function(e){return B.test(e)?"xn--"+p(e):e})}var m="object"==typeof n&&n,v="object"==typeof t&&t&&t.exports==m&&t,b="object"==typeof e&&e;(b.global===b||b.window===b)&&(o=b);var y,w,k=2147483647,_=36,C=1,x=26,T=38,$=700,A=72,S=128,E="-",M=/^xn--/,B=/[^ -~]/,D=/\x2E|\u3002|\uFF0E|\uFF61/g,j={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},O=_-C,R=Math.floor,N=String.fromCharCode;if(y={version:"1.2.4",ucs2:{decode:i,encode:c},decode:d,encode:p,toASCII:g,toUnicode:f},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return y});else if(m&&!m.nodeType)if(v)v.exports=y;else for(w in y)y.hasOwnProperty(w)&&(m[w]=y[w]);else o.punycode=y}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],67:[function(e,t){t.exports=e("./lib/")},{"./lib/":68}],68:[function(e,t,n){function o(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),a=o.source,l=o.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(i("ignoring socket cache for %s",a),n=s(a,t)):(c[l]||(i("new io instance for %s",a),c[l]=s(a,t)),n=c[l]),n.socket(o.path)
}var r=e("./url"),a=e("socket.io-parser"),s=e("./manager"),i=e("debug")("socket.io-client");t.exports=n=o;var c=n.managers={};n.protocol=a.protocol,n.connect=o,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":69,"./socket":71,"./url":72,debug:76,"socket.io-parser":112}],69:[function(e,t){function n(e,t){return this instanceof n?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new n(e,t)}var o=(e("./url"),e("engine.io-client")),r=e("./socket"),a=e("component-emitter"),s=e("socket.io-parser"),i=e("./on"),c=e("component-bind"),l=(e("object-component"),e("debug")("socket.io-client:manager")),h=e("indexof"),u=e("backo2");t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},n.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},a(n.prototype),n.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},n.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},n.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=o(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=i(t,"open",function(){n.onopen(),e&&e()}),a=i(t,"error",function(t){if(l("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var o=new Error("Connection error");o.data=t,e(o)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;l("connect attempt will timeout after %d",s);var c=setTimeout(function(){l("connect attempt timed out after %d",s),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(r),this.subs.push(a),this},n.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(i(e,"data",c(this,"ondata"))),this.subs.push(i(this.decoder,"decoded",c(this,"ondecoded"))),this.subs.push(i(e,"error",c(this,"onerror"))),this.subs.push(i(e,"close",c(this,"onclose")))},n.prototype.ondata=function(e){this.decoder.add(e)},n.prototype.ondecoded=function(e){this.emit("packet",e)},n.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},n.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new r(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~h(n.connected,t)||n.connected.push(t)})}return t},n.prototype.destroy=function(e){var t=h(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},n.prototype.packet=function(e){l("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},n.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(e){l("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},n.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":70,"./socket":71,"./url":72,backo2:73,"component-bind":74,"component-emitter":75,debug:76,"engine.io-client":77,indexof:108,"object-component":109,"socket.io-parser":112}],70:[function(e,t){function n(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=n},{}],71:[function(e,t,n){function o(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=e("socket.io-parser"),a=e("component-emitter"),s=e("to-array"),i=e("./on"),c=e("component-bind"),l=e("debug")("socket.io-client:socket"),h=e("has-binary");t.exports=n=o;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},d=a.prototype.emit;a(o.prototype),o.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[i(e,"open",c(this,"onopen")),i(e,"packet",c(this,"onpacket")),i(e,"close",c(this,"onclose"))]}},o.prototype.open=o.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},o.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},o.prototype.emit=function(e){if(u.hasOwnProperty(e))return d.apply(this,arguments),this;var t=s(arguments),n=r.EVENT;h(t)&&(n=r.BINARY_EVENT);var o={type:n,data:t};return"function"==typeof t[t.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),this},o.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},o.prototype.onopen=function(){l("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},o.prototype.onclose=function(e){l("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},o.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},o.prototype.onevent=function(e){var t=e.data||[];l("emitting event %j",t),null!=e.id&&(l("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},o.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=s(arguments);l("sending ack %j",o);var a=h(o)?r.BINARY_ACK:r.ACK;t.packet({type:a,id:e,data:o})}}},o.prototype.onack=function(e){l("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},o.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},o.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},o.prototype.ondisconnect=function(){l("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},o.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},o.prototype.close=o.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":70,"component-bind":74,"component-emitter":75,debug:76,"has-binary":106,"socket.io-parser":112,"to-array":116}],72:[function(e,t){(function(n){function o(e,t){var o=e,t=t||n.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(a("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),a("parse %s",e),o=r(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/",o.id=o.protocol+"://"+o.host+":"+o.port,o.href=o.protocol+"://"+o.host+(t&&t.port==o.port?"":":"+o.port),o}var r=e("parseuri"),a=e("debug")("socket.io-client:url");t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:76,parseuri:110}],73:[function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},{}],74:[function(e,t){var n=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var o=n.call(arguments,2);return function(){return t.apply(e,o.concat(n.call(arguments)))}}},{}],75:[function(e,t){function n(e){return e?o(e):void 0}function o(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){o.off(e,n),t.apply(this,arguments)}var o=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var o,r=0;r<n.length;r++)if(o=n[r],o===t||o.fn===t){n.splice(r,1);break}return this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var o=0,r=n.length;r>o;++o)n[o].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],76:[function(e,t){function n(e){return n.enabled(e)?function(t){t=o(t);var r=new Date,a=r-(n[e]||r);n[e]=r,t=e+" "+t+" +"+n.humanize(a),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function o(e){return e instanceof Error?e.stack||e.message:e}t.exports=n,n.names=[],n.skips=[],n.enable=function(e){try{localStorage.debug=e}catch(t){}for(var o=(e||"").split(/[\s,]+/),r=o.length,a=0;r>a;a++)e=o[a].replace("*",".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$"))},n.disable=function(){n.enable("")},n.humanize=function(e){var t=1e3,n=6e4,o=60*n;return e>=o?(e/o).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},n.enabled=function(e){for(var t=0,o=n.skips.length;o>t;t++)if(n.skips[t].test(e))return!1;for(var t=0,o=n.names.length;o>t;t++)if(n.names[t].test(e))return!0;return!1};try{window.localStorage&&n.enable(localStorage.debug)}catch(r){}},{}],77:[function(e,t){t.exports=e("./lib/")},{"./lib/":78}],78:[function(e,t){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":79,"engine.io-parser":91}],79:[function(e,t){(function(n){function o(e,t){if(!(this instanceof o))return new o(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=h(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.host){var r=t.host.split(":");t.hostname=r.shift(),r.length?t.port=r.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=d.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function r(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var a=e("./transports"),s=e("component-emitter"),i=e("debug")("engine.io-client:socket"),c=e("indexof"),l=e("engine.io-parser"),h=e("parseuri"),u=e("parsejson"),d=e("parseqs");t.exports=o,o.priorWebsocketSuccess=!1,s(o.prototype),o.protocol=l.protocol,o.Socket=o,o.Transport=e("./transport"),o.transports=e("./transports"),o.parser=e("engine.io-parser"),o.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=r(this.query);t.EIO=l.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new a[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},o.prototype.open=function(){var e;if(this.rememberUpgrade&&o.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},o.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},o.prototype.probe=function(e){function t(){if(d.onlyBinaryUpgrades){var t=!this.supportsBinary&&d.transport.supportsBinary;u=u||t}u||(i('probe transport "%s" opened',e),h.send([{type:"ping",data:"probe"}]),h.once("packet",function(t){if(!u)if("pong"==t.type&&"probe"==t.data){if(i('probe transport "%s" pong',e),d.upgrading=!0,d.emit("upgrading",h),!h)return;o.priorWebsocketSuccess="websocket"==h.name,i('pausing current transport "%s"',d.transport.name),d.transport.pause(function(){u||"closed"!=d.readyState&&(i("changing transport and sending upgrade packet"),l(),d.setTransport(h),h.send([{type:"upgrade"}]),d.emit("upgrade",h),h=null,d.upgrading=!1,d.flush())})}else{i('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=h.name,d.emit("upgradeError",n)}}))}function n(){u||(u=!0,l(),h.close(),h=null)}function r(t){var o=new Error("probe error: "+t);o.transport=h.name,n(),i('probe transport "%s" failed because of error: %s',e,t),d.emit("upgradeError",o)}function a(){r("transport closed")}function s(){r("socket closed")}function c(e){h&&e.name!=h.name&&(i('"%s" works - aborting "%s"',e.name,h.name),n())}function l(){h.removeListener("open",t),h.removeListener("error",r),h.removeListener("close",a),d.removeListener("close",s),d.removeListener("upgrading",c)}i('probing transport "%s"',e);var h=this.createTransport(e,{probe:1}),u=!1,d=this;o.priorWebsocketSuccess=!1,h.once("open",t),h.once("error",r),h.once("close",a),this.once("close",s),this.once("upgrading",c),h.open()},o.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",o.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},o.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},o.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},o.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},o.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},o.prototype.ping=function(){this.sendPacket("ping")},o.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},o.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},o.prototype.write=o.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},o.prototype.sendPacket=function(e,t,n){if("closing"!=this.readyState&&"closed"!=this.readyState){var o={type:e,data:t};this.emit("packetCreate",o),this.writeBuffer.push(o),this.callbackBuffer.push(n),this.flush()}},o.prototype.close=function(){function e(){o.onClose("forced close"),i("socket closing - telling transport to close"),o.transport.close()}function t(){o.removeListener("upgrade",t),o.removeListener("upgradeError",t),e()}function n(){o.once("upgrade",t),o.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var o=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},o.prototype.onError=function(e){i("socket error %j",e),o.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},o.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){i('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},o.prototype.filterUpgrades=function(e){for(var t=[],n=0,o=e.length;o>n;n++)~c(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":80,"./transports":81,"component-emitter":75,debug:88,"engine.io-parser":91,indexof:108,parsejson:102,parseqs:103,parseuri:104}],80:[function(e,t){function n(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var o=e("engine.io-parser"),r=e("component-emitter");t.exports=n,r(n.prototype),n.timestamps=0,n.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},n.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},n.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(e){var t=o.decodePacket(e,this.socket.binaryType);this.onPacket(t)},n.prototype.onPacket=function(e){this.emit("packet",e)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":75,"engine.io-parser":91}],81:[function(e,t,n){(function(t){function o(e){var n,o=!1,i=!1,c=!1!==e.jsonp;if(t.location){var l="https:"==location.protocol,h=location.port;h||(h=l?443:80),o=e.hostname!=location.hostname||h!=e.port,i=e.secure!=l}if(e.xdomain=o,e.xscheme=i,n=new r(e),"open"in n&&!e.forceJSONP)return new a(e);if(!c)throw new Error("JSONP disabled");return new s(e)}var r=e("xmlhttprequest"),a=e("./polling-xhr"),s=e("./polling-jsonp"),i=e("./websocket");n.polling=o,n.websocket=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":82,"./polling-xhr":83,"./websocket":85,xmlhttprequest:86}],82:[function(e,t){(function(n){function o(){}function r(e){a.call(this,e),this.query=this.query||{},i||(n.___eio||(n.___eio=[]),i=n.___eio),this.index=i.length;var t=this;i.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=o)},!1)}var a=e("./polling"),s=e("component-inherit");t.exports=r;var i,c=/\n/g,l=/\\n/g;s(r,a),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),a.prototype.doClose.call(this)},r.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var o="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);o&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},r.prototype.doWrite=function(e,t){function n(){o(),t()}function o(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';a=document.createElement(t)}catch(e){a=document.createElement("iframe"),a.name=r.iframeId,a.src="javascript:0"}a.id=r.iframeId,r.form.appendChild(a),r.iframe=a}var r=this;if(!this.form){var a,s=document.createElement("form"),i=document.createElement("textarea"),h=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=h,s.method="POST",s.setAttribute("accept-charset","utf-8"),i.name="d",s.appendChild(i),document.body.appendChild(s),this.form=s,this.area=i}this.form.action=this.uri(),o(),e=e.replace(l,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(u){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==r.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":84,"component-inherit":87}],83:[function(e,t){(function(n){function o(){}function r(e){if(c.call(this,e),n.location){var t="https:"==location.protocol,o=location.port;o||(o=t?443:80),this.xd=e.hostname!=n.location.hostname||o!=e.port,this.xs=e.secure!=t}}function a(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function s(){for(var e in a.requests)a.requests.hasOwnProperty(e)&&a.requests[e].abort()}var i=e("xmlhttprequest"),c=e("./polling"),l=e("component-emitter"),h=e("component-inherit"),u=e("debug")("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=a,h(r,c),r.prototype.supportsBinary=!0,r.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new a(e)},r.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,o=this.request({method:"POST",data:e,isBinary:n}),r=this;o.on("success",t),o.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=o},r.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},l(a.prototype),a.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new i(e),o=this;try{if(u("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(r){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){o.onLoad()},t.onerror=function(){o.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?o.onLoad():setTimeout(function(){o.onError(t.status)},0))},u("xhr data %s",this.data),t.send(this.data)}catch(r){return void setTimeout(function(){o.onError(r)},0)}n.document&&(this.index=a.requestsCount++,a.requests[this.index]=this)},a.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},a.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},a.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},a.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=o:this.xhr.onreadystatechange=o,e)try{this.xhr.abort()}catch(t){}n.document&&delete a.requests[this.index],this.xhr=null}},a.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},a.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},a.prototype.abort=function(){this.cleanup()},n.document&&(a.requestsCount=0,a.requests={},n.attachEvent?n.attachEvent("onunload",s):n.addEventListener&&n.addEventListener("beforeunload",s,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":84,"component-emitter":75,"component-inherit":87,debug:88,xmlhttprequest:86}],84:[function(e,t){function n(e){var t=e&&e.forceBase64;(!c||t)&&(this.supportsBinary=!1),o.call(this,e)}var o=e("../transport"),r=e("parseqs"),a=e("engine.io-parser"),s=e("component-inherit"),i=e("debug")("engine.io-client:polling");t.exports=n;var c=function(){var t=e("xmlhttprequest"),n=new t({xdomain:!1});return null!=n.responseType}();s(n,o),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(e){function t(){i("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var o=0;this.polling&&(i("we are currently polling - waiting to pause"),o++,this.once("pollComplete",function(){i("pre-pause polling complete"),--o||t()})),this.writable||(i("we are currently writing - waiting to pause"),o++,this.once("drain",function(){i("pre-pause writing complete"),--o||t()}))}else t()},n.prototype.poll=function(){i("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(e){var t=this;
i("polling got data %s",e);var n=function(e){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():i('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function e(){i("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(i("transport open - closing"),e()):(i("transport not open - deferring close"),this.once("open",e))},n.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+o.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":80,"component-inherit":87,debug:88,"engine.io-parser":91,parseqs:103,xmlhttprequest:86}],85:[function(e,t){function n(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),o.call(this,e)}var o=e("../transport"),r=e("engine.io-parser"),a=e("parseqs"),s=e("component-inherit"),i=e("debug")("engine.io-client:websocket"),c=e("ws");t.exports=n,s(n,o),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(n.prototype.onData=function(e){var t=this;setTimeout(function(){o.prototype.onData.call(t,e)},0)}),n.prototype.write=function(e){function t(){n.writable=!0,n.emit("drain")}var n=this;this.writable=!1;for(var o=0,a=e.length;a>o;o++)r.encodePacket(e[o],this.supportsBinary,function(e){try{n.ws.send(e)}catch(t){i("websocket closed before onclose event")}});setTimeout(t,0)},n.prototype.onClose=function(){o.prototype.onClose.call(this)},n.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},n.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=a.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},n.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===n.prototype.name)}},{"../transport":80,"component-inherit":87,debug:88,"engine.io-parser":91,parseqs:103,ws:105}],86:[function(e,t){var n=e("has-cors");t.exports=function(e){var t=e.xdomain,o=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||n))return new XMLHttpRequest}catch(a){}try{if("undefined"!=typeof XDomainRequest&&!o&&r)return new XDomainRequest}catch(a){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}},{"has-cors":100}],87:[function(e,t){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],88:[function(e,t,n){function o(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function r(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var o="color: "+this.color;e=[e[0],o,"color: inherit"].concat(Array.prototype.slice.call(e,1));var r=0,a=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(a=r))}),e.splice(a,0,o),e}function a(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function i(){var e;try{e=localStorage.debug}catch(t){}return e}n=t.exports=e("./debug"),n.log=a,n.formatArgs=r,n.save=s,n.load=i,n.useColors=o,n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(i())},{"./debug":89}],89:[function(e,t,n){function o(){return n.colors[h++%n.colors.length]}function r(e){function t(){}function r(){var e=r,t=+new Date,a=t-(l||t);e.diff=a,e.prev=l,e.curr=t,l=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=o());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var i=0;s[0]=s[0].replace(/%([a-z%])/g,function(t,o){if("%%"===t)return t;i++;var r=n.formatters[o];if("function"==typeof r){var a=s[i];t=r.call(e,a),s.splice(i,1),i--}return t}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(e,s));var c=r.log||n.log||console.log.bind(console);c.apply(e,s)}t.enabled=!1,r.enabled=!0;var a=n.enabled(e)?r:t;return a.namespace=e,a}function a(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),o=t.length,r=0;o>r;r++)t[r]&&(e=t[r].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function s(){n.enable("")}function i(e){var t,o;for(t=0,o=n.skips.length;o>t;t++)if(n.skips[t].test(e))return!1;for(t=0,o=n.names.length;o>t;t++)if(n.names[t].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=r,n.coerce=c,n.disable=s,n.enable=a,n.enabled=i,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var l,h=0},{ms:90}],90:[function(e,t){function n(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),o=(t[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"y":return n*h;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"h":return n*c;case"minutes":case"minute":case"m":return n*i;case"seconds":case"second":case"s":return n*s;case"ms":return n}}}function o(e){return e>=l?Math.round(e/l)+"d":e>=c?Math.round(e/c)+"h":e>=i?Math.round(e/i)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function r(e){return a(e,l,"day")||a(e,c,"hour")||a(e,i,"minute")||a(e,s,"second")||e+" ms"}function a(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,i=60*s,c=60*i,l=24*c,h=365.25*l;t.exports=function(e,t){return t=t||{},"string"==typeof e?n(e):t.long?r(e):o(e)}},{}],91:[function(e,t,n){(function(t){function o(e,t){var o="b"+n.packets[e.type]+e.data.data;return t(o)}function r(e,t,o){if(!t)return n.encodeBase64Packet(e,o);var r=e.data,a=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=v[e.type];for(var i=0;i<a.length;i++)s[i+1]=a[i];return o(s.buffer)}function a(e,t,o){if(!t)return n.encodeBase64Packet(e,o);var r=new FileReader;return r.onload=function(){e.data=r.result,n.encodePacket(e,t,!0,o)},r.readAsArrayBuffer(e.data)}function s(e,t,o){if(!t)return n.encodeBase64Packet(e,o);if(m)return a(e,t,o);var r=new Uint8Array(1);r[0]=v[e.type];var s=new w([r.buffer,e.data]);return o(s)}function i(e,t,n){for(var o=new Array(e.length),r=d(e.length,n),a=function(e,n,r){t(n,function(t,n){o[e]=n,r(t,o)})},s=0;s<e.length;s++)a(s,e[s],r)}var c=e("./keys"),l=e("has-binary"),h=e("arraybuffer.slice"),u=e("base64-arraybuffer"),d=e("after"),p=e("utf8"),f=navigator.userAgent.match(/Android/i),g=/PhantomJS/i.test(navigator.userAgent),m=f||g;n.protocol=3;var v=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},b=c(v),y={type:"error",data:"parser error"},w=e("blob");n.encodePacket=function(e,n,a,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof a&&(i=a,a=null);var c=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&c instanceof ArrayBuffer)return r(e,n,i);if(w&&c instanceof t.Blob)return s(e,n,i);if(c&&c.base64)return o(e,i);var l=v[e.type];return void 0!==e.data&&(l+=a?p.encode(String(e.data)):String(e.data)),i(""+l)},n.encodeBase64Packet=function(e,o){var r="b"+n.packets[e.type];if(w&&e.data instanceof w){var a=new FileReader;return a.onload=function(){var e=a.result.split(",")[1];o(r+e)},a.readAsDataURL(e.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(i){for(var c=new Uint8Array(e.data),l=new Array(c.length),h=0;h<c.length;h++)l[h]=c[h];s=String.fromCharCode.apply(null,l)}return r+=t.btoa(s),o(r)},n.decodePacket=function(e,t,o){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(o)try{e=p.decode(e)}catch(r){return y}var a=e.charAt(0);return Number(a)==a&&b[a]?e.length>1?{type:b[a],data:e.substring(1)}:{type:b[a]}:y}var s=new Uint8Array(e),a=s[0],i=h(e,1);return w&&"blob"===t&&(i=new w([i])),{type:b[a],data:i}},n.decodeBase64Packet=function(e,n){var o=b[e.charAt(0)];if(!t.ArrayBuffer)return{type:o,data:{base64:!0,data:e.substr(1)}};var r=u.decode(e.substr(1));return"blob"===n&&w&&(r=new w([r])),{type:o,data:r}},n.encodePayload=function(e,t,o){function r(e){return e.length+":"+e}function a(e,o){n.encodePacket(e,s?t:!1,!0,function(e){o(null,r(e))})}"function"==typeof t&&(o=t,t=null);var s=l(e);return t&&s?w&&!m?n.encodePayloadAsBlob(e,o):n.encodePayloadAsArrayBuffer(e,o):e.length?void i(e,a,function(e,t){return o(t.join(""))}):o("0:")},n.decodePayload=function(e,t,o){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,o);"function"==typeof t&&(o=t,t=null);var r;if(""==e)return o(y,0,1);for(var a,s,i="",c=0,l=e.length;l>c;c++){var h=e.charAt(c);if(":"!=h)i+=h;else{if(""==i||i!=(a=Number(i)))return o(y,0,1);if(s=e.substr(c+1,a),i!=s.length)return o(y,0,1);if(s.length){if(r=n.decodePacket(s,t,!0),y.type==r.type&&y.data==r.data)return o(y,0,1);var u=o(r,c+a,l);if(!1===u)return}c+=a,i=""}}return""!=i?o(y,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){function o(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void i(e,o,function(e,n){var o=n.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),r=new Uint8Array(o),a=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var o=new Uint8Array(e.length),s=0;s<e.length;s++)o[s]=e.charCodeAt(s);n=o.buffer}r[a++]=t?0:1;for(var i=n.byteLength.toString(),s=0;s<i.length;s++)r[a++]=parseInt(i[s]);r[a++]=255;for(var o=new Uint8Array(n),s=0;s<o.length;s++)r[a++]=o[s]}),t(r.buffer)}):t(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(e,t){function o(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var o=new Uint8Array(e.length),r=0;r<e.length;r++)o[r]=e.charCodeAt(r);e=o.buffer,n[0]=0}for(var a=e instanceof ArrayBuffer?e.byteLength:e.size,s=a.toString(),i=new Uint8Array(s.length+1),r=0;r<s.length;r++)i[r]=parseInt(s[r]);if(i[s.length]=255,w){var c=new w([n.buffer,i.buffer,e]);t(null,c)}})}i(e,o,function(e,n){return t(new w(n))})},n.decodePayloadAsBinary=function(e,t,o){"function"==typeof t&&(o=t,t=null);for(var r=e,a=[],s=!1;r.byteLength>0;){for(var i=new Uint8Array(r),c=0===i[0],l="",u=1;255!=i[u];u++){if(l.length>310){s=!0;break}l+=i[u]}if(s)return o(y,0,1);r=h(r,2+l.length),l=parseInt(l);var d=h(r,0,l);if(c)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(p){var f=new Uint8Array(d);d="";for(var u=0;u<f.length;u++)d+=String.fromCharCode(f[u])}a.push(d),r=h(r,l)}var g=a.length;a.forEach(function(e,r){o(n.decodePacket(e,t,!0),r,g)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":92,after:93,"arraybuffer.slice":94,"base64-arraybuffer":95,blob:96,"has-binary":97,utf8:99}],92:[function(e,t){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var o in e)n.call(e,o)&&t.push(o);return t}},{}],93:[function(e,t){function n(e,t,n){function r(e,o){if(r.count<=0)throw new Error("after called too many times");--r.count,e?(a=!0,t(e),t=n):0!==r.count||a||t(null,o)}var a=!1;return n=n||o,r.count=e,0===e?t():r}function o(){}t.exports=n},{}],94:[function(e,t){t.exports=function(e,t,n){var o=e.byteLength;if(t=t||0,n=n||o,e.slice)return e.slice(t,n);if(0>t&&(t+=o),0>n&&(n+=o),n>o&&(n=o),t>=o||t>=n||0===o)return new ArrayBuffer(0);for(var r=new Uint8Array(e),a=new Uint8Array(n-t),s=t,i=0;n>s;s++,i++)a[i]=r[s];return a.buffer}},{}],95:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,o=new Uint8Array(t),r=o.length,a="";for(n=0;r>n;n+=3)a+=e[o[n]>>2],a+=e[(3&o[n])<<4|o[n+1]>>4],a+=e[(15&o[n+1])<<2|o[n+2]>>6],a+=e[63&o[n+2]];return r%3===2?a=a.substring(0,a.length-1)+"=":r%3===1&&(a=a.substring(0,a.length-2)+"=="),a},n.decode=function(t){var n,o,r,a,s,i=.75*t.length,c=t.length,l=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);var h=new ArrayBuffer(i),u=new Uint8Array(h);for(n=0;c>n;n+=4)o=e.indexOf(t[n]),r=e.indexOf(t[n+1]),a=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),u[l++]=o<<2|r>>4,u[l++]=(15&r)<<4|a>>2,u[l++]=(3&a)<<6|63&s;return h}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],96:[function(e,t){(function(e){function n(e,t){t=t||{};for(var n=new o,r=0;r<e.length;r++)n.append(e[r]);return t.type?n.getBlob(t.type):n.getBlob()}var o=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{var e=new Blob(["hi"]);return 2==e.size}catch(t){return!1}}(),a=o&&o.prototype.append&&o.prototype.getBlob;t.exports=function(){return r?e.Blob:a?n:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],97:[function(e,t){(function(n){function o(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var o=0;o<e.length;o++)if(t(e[o]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var a in e)if(e.hasOwnProperty(a)&&t(e[a]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:98}],98:[function(e,t){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],99:[function(e,t,n){(function(e){!function(o){function r(e){for(var t,n,o=[],r=0,a=e.length;a>r;)t=e.charCodeAt(r++),t>=55296&&56319>=t&&a>r?(n=e.charCodeAt(r++),56320==(64512&n)?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),r--)):o.push(t);return o}function a(e){for(var t,n=e.length,o=-1,r="";++o<n;)t=e[o],t>65535&&(t-=65536,r+=b(t>>>10&1023|55296),t=56320|1023&t),r+=b(t);return r}function s(e,t){return b(e>>t&63|128)}function i(e){if(0==(4294967168&e))return b(e);var t="";return 0==(4294965248&e)?t=b(e>>6&31|192):0==(4294901760&e)?(t=b(e>>12&15|224),t+=s(e,6)):0==(4292870144&e)&&(t=b(e>>18&7|240),t+=s(e,12),t+=s(e,6)),t+=b(63&e|128)}function c(e){for(var t,n=r(e),o=n.length,a=-1,s="";++a<o;)t=n[a],s+=i(t);return s}function l(){if(v>=m)throw Error("Invalid byte index");var e=255&g[v];if(v++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(){var e,t,n,o,r;if(v>m)throw Error("Invalid byte index");if(v==m)return!1;if(e=255&g[v],v++,0==(128&e))return e;if(192==(224&e)){var t=l();if(r=(31&e)<<6|t,r>=128)return r;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=l(),n=l(),r=(15&e)<<12|t<<6|n,r>=2048)return r;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=l(),n=l(),o=l(),r=(15&e)<<18|t<<12|n<<6|o,r>=65536&&1114111>=r))return r;throw Error("Invalid UTF-8 detected")}function u(e){g=r(e),m=g.length,v=0;for(var t,n=[];(t=h())!==!1;)n.push(t);return a(n)}var d="object"==typeof n&&n,p="object"==typeof t&&t&&t.exports==d&&t,f="object"==typeof e&&e;(f.global===f||f.window===f)&&(o=f);var g,m,v,b=String.fromCharCode,y={version:"2.0.0",encode:c,decode:u};if("function"==typeof define&&"object"==typeof define.amd&&define.amd)define(function(){return y});else if(d&&!d.nodeType)if(p)p.exports=y;else{var w={},k=w.hasOwnProperty;for(var _ in y)k.call(y,_)&&(d[_]=y[_])}else o.utf8=y}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],100:[function(e,t){var n=e("global");try{t.exports="XMLHttpRequest"in n&&"withCredentials"in new n.XMLHttpRequest}catch(o){t.exports=!1}},{global:101}],101:[function(e,t){t.exports=function(){return this}()},{}],102:[function(e,t){(function(e){var n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,i=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(i,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(o,"@").replace(r,"]").replace(a,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],103:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),o=0,r=n.length;r>o;o++){var a=n[o].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}},{}],104:[function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,r=e.indexOf("["),a=e.indexOf("]");-1!=r&&-1!=a&&(e=e.substring(0,r)+e.substring(r,a).replace(/:/g,";")+e.substring(a,e.length));for(var s=n.exec(e||""),i={},c=14;c--;)i[o[c]]=s[c]||"";return-1!=r&&-1!=a&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i}},{}],105:[function(e,t){function n(e,t){var n;return n=t?new r(e,t):new r(e)}var o=function(){return this}(),r=o.WebSocket||o.MozWebSocket;t.exports=r?n:null,r&&(n.prototype=r.prototype)},{}],106:[function(e,t){(function(n){function o(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(r(e)){for(var o=0;o<e.length;o++)if(t(e[o]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t(e[a]))return!0}return!1}return t(e)}var r=e("isarray");t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:107}],107:[function(e,t){t.exports=e(98)},{}],108:[function(e,t){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var o=0;o<e.length;++o)if(e[o]===t)return o;return-1}},{}],109:[function(e,t,n){var o=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],110:[function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=n.exec(e||""),r={},a=14;a--;)r[o[a]]=t[a]||"";return r}},{}],111:[function(e,t,n){(function(t){var o=e("isarray"),r=e("./is-buffer");n.deconstructPacket=function(e){function t(e){if(!e)return e;if(r(e)){var a={_placeholder:!0,num:n.length};return n.push(e),a}if(o(e)){for(var s=new Array(e.length),i=0;i<e.length;i++)s[i]=t(e[i]);return s}if("object"==typeof e&&!(e instanceof Date)){var s={};for(var c in e)s[c]=t(e[c]);return s}return e}var n=[],a=e.data,s=e;return s.data=t(a),s.attachments=n.length,{packet:s,buffers:n}},n.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var r=t[e.num];return r}if(o(e)){for(var a=0;a<e.length;a++)e[a]=n(e[a]);return e}if(e&&"object"==typeof e){for(var s in e)e[s]=n(e[s]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){function a(e,c,l){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){s++;var h=new FileReader;h.onload=function(){l?l[c]=this.result:i=this.result,--s||n(i)},h.readAsArrayBuffer(e)}else if(o(e))for(var u=0;u<e.length;u++)a(e[u],u,e);else if(e&&"object"==typeof e&&!r(e))for(var d in e)a(e[d],d,e)}var s=0,i=e;a(i),s||n(i)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":113,isarray:114}],112:[function(e,t,n){function o(){}function r(e){var t="",o=!1;return t+=e.type,(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)&&(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(o=!0,t+=e.nsp),null!=e.id&&(o&&(t+=",",o=!1),t+=e.id),null!=e.data&&(o&&(t+=","),t+=u.stringify(e.data)),h("encoded %j as %s",e,t),t}function a(e,t){function n(e){var n=p.deconstructPacket(e),o=r(n.packet),a=n.buffers;a.unshift(o),t(a)}p.removeBlobs(e,n)}function s(){this.reconstructor=null}function i(e){var t={},o=0;if(t.type=Number(e.charAt(0)),null==n.types[t.type])return l();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var r="";"-"!=e.charAt(++o)&&(r+=e.charAt(o),o!=e.length););if(r!=Number(r)||"-"!=e.charAt(o))throw new Error("Illegal attachments");t.attachments=Number(r)}if("/"==e.charAt(o+1))for(t.nsp="";++o;){var a=e.charAt(o);if(","==a)break;if(t.nsp+=a,o==e.length)break}else t.nsp="/";var s=e.charAt(o+1);if(""!==s&&Number(s)==s){for(t.id="";++o;){var a=e.charAt(o);if(null==a||Number(a)!=a){--o;break}if(t.id+=e.charAt(o),o==e.length)break}t.id=Number(t.id)}if(e.charAt(++o))try{t.data=u.parse(e.substr(o))}catch(i){return l()}return h("decoded %s as %j",e,t),t}function c(e){this.reconPack=e,this.buffers=[]}function l(){return{type:n.ERROR,data:"parser error"}}var h=e("debug")("socket.io-parser"),u=e("json3"),d=(e("isarray"),e("component-emitter")),p=e("./binary"),f=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=o,n.Decoder=s,o.prototype.encode=function(e,t){if(h("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)a(e,t);else{var o=r(e);t([o])}},d(s.prototype),s.prototype.add=function(e){var t;if("string"==typeof e)t=i(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new c(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},c.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=p.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},c.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":111,"./is-buffer":113,"component-emitter":75,debug:76,isarray:114,json3:115}],113:[function(e,t){(function(e){function n(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],114:[function(e,t){t.exports=e(98)},{}],115:[function(e,t,n){!function(e){function t(e){if(t[e]!==a)return t[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=t("json-stringify")&&t("json-parse");else{var o,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var i=l.stringify,c="function"==typeof i&&h;if(c){(o=function(){return 1}).toJSON=o;try{c="0"===i(0)&&"0"===i(new Number)&&'""'==i(new String)&&i(s)===a&&i(a)===a&&i()===a&&"1"===i(o)&&"[1]"==i([o])&&"[null]"==i([a])&&"null"==i(null)&&"[null,null,null]"==i([a,s,null])&&i({a:[o,!0,!1,null,"\x00\b\n\f\r	"]})==r&&"1"===i(null,o)&&"[\n 1,\n 2\n]"==i([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==i(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new Date(-1))}catch(u){c=!1}}n=c}if("json-parse"==e){var d=l.parse;if("function"==typeof d)try{if(0===d("0")&&!d(!1)){o=d(r);var p=5==o.a.length&&1===o.a[0];if(p){try{p=!d('"	"')}catch(u){}if(p)try{p=1!==d("01")}catch(u){}if(p)try{p=1!==d("1.")}catch(u){}}}}catch(u){p=!1}n=p}}return t[e]=!!n}var o,r,a,s={}.toString,i="function"==typeof define&&define.amd,c="object"==typeof JSON&&JSON,l="object"==typeof n&&n&&!n.nodeType&&n;l&&c?(l.stringify=c.stringify,l.parse=c.parse):l=e.JSON=c||{};var h=new Date(-0xc782b5b800cec);try{h=-109252==h.getUTCFullYear()&&0===h.getUTCMonth()&&1===h.getUTCDate()&&10==h.getUTCHours()&&37==h.getUTCMinutes()&&6==h.getUTCSeconds()&&708==h.getUTCMilliseconds()}catch(u){}if(!t("json")){var d="[object Function]",p="[object Date]",f="[object Number]",g="[object String]",m="[object Array]",v="[object Boolean]",b=t("bug-string-char-index");if(!h)var y=Math.floor,w=[0,31,59,90,120,151,181,212,243,273,304,334],k=function(e,t){return w[t]+365*(e-1970)+y((e-1969+(t=+(t>1)))/4)-y((e-1901+t)/100)+y((e-1601+t)/400)};(o={}.hasOwnProperty)||(o=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=s?o=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,o=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,o.call(this,e)});var _={"boolean":1,number:1,string:1,undefined:1},C=function(e,t){var n=typeof e[t];return"object"==n?!!e[t]:!_[n]};if(r=function(e,t){var n,a,i,c=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,a=new n;for(i in a)o.call(a,i)&&c++;return n=a=null,c?r=2==c?function(e,t){var n,r={},a=s.call(e)==d;for(n in e)a&&"prototype"==n||o.call(r,n)||!(r[n]=1)||!o.call(e,n)||t(n)}:function(e,t){var n,r,a=s.call(e)==d;for(n in e)a&&"prototype"==n||!o.call(e,n)||(r="constructor"===n)||t(n);(r||o.call(e,n="constructor"))&&t(n)}:(a=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],r=function(e,t){var n,r,i=s.call(e)==d,c=!i&&"function"!=typeof e.constructor&&C(e,"hasOwnProperty")?e.hasOwnProperty:o;for(n in e)i&&"prototype"==n||!c.call(e,n)||t(n);for(r=a.length;n=a[--r];c.call(e,n)&&t(n));}),r(e,t)},!t("json-stringify")){var x={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},T="000000",$=function(e,t){return(T+(t||0)).slice(-e)},A="\\u00",S=function(e){var t,n='"',o=0,r=e.length,a=r>10&&b;for(a&&(t=e.split(""));r>o;o++){var s=e.charCodeAt(o);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=x[s];break;default:if(32>s){n+=A+$(2,s.toString(16));break}n+=a?t[o]:b?e.charAt(o):e[o]}}return n+'"'},E=function(e,t,n,i,c,l,h){var u,d,b,w,_,C,x,T,A,M,B,D,j,O,R,N;try{u=t[e]}catch(L){}if("object"==typeof u&&u)if(d=s.call(u),d!=p||o.call(u,"toJSON"))"function"==typeof u.toJSON&&(d!=f&&d!=g&&d!=m||o.call(u,"toJSON"))&&(u=u.toJSON(e));else if(u>-1/0&&1/0>u){if(k){for(_=y(u/864e5),b=y(_/365.2425)+1970-1;k(b+1,0)<=_;b++);for(w=y((_-k(b,0))/30.42);k(b,w+1)<=_;w++);_=1+_-k(b,w),C=(u%864e5+864e5)%864e5,x=y(C/36e5)%24,T=y(C/6e4)%60,A=y(C/1e3)%60,M=C%1e3}else b=u.getUTCFullYear(),w=u.getUTCMonth(),_=u.getUTCDate(),x=u.getUTCHours(),T=u.getUTCMinutes(),A=u.getUTCSeconds(),M=u.getUTCMilliseconds();u=(0>=b||b>=1e4?(0>b?"-":"+")+$(6,0>b?-b:b):$(4,b))+"-"+$(2,w+1)+"-"+$(2,_)+"T"+$(2,x)+":"+$(2,T)+":"+$(2,A)+"."+$(3,M)+"Z"}else u=null;if(n&&(u=n.call(t,e,u)),null===u)return"null";if(d=s.call(u),d==v)return""+u;if(d==f)return u>-1/0&&1/0>u?""+u:"null";if(d==g)return S(""+u);if("object"==typeof u){for(O=h.length;O--;)if(h[O]===u)throw TypeError();if(h.push(u),B=[],R=l,l+=c,d==m){for(j=0,O=u.length;O>j;j++)D=E(j,u,n,i,c,l,h),B.push(D===a?"null":D);N=B.length?c?"[\n"+l+B.join(",\n"+l)+"\n"+R+"]":"["+B.join(",")+"]":"[]"}else r(i||u,function(e){var t=E(e,u,n,i,c,l,h);t!==a&&B.push(S(e)+":"+(c?" ":"")+t)}),N=B.length?c?"{\n"+l+B.join(",\n"+l)+"\n"+R+"}":"{"+B.join(",")+"}":"{}";return h.pop(),N}};l.stringify=function(e,t,n){var o,r,a,i;if("function"==typeof t||"object"==typeof t&&t)if((i=s.call(t))==d)r=t;else if(i==m){a={};for(var c,l=0,h=t.length;h>l;c=t[l++],i=s.call(c),(i==g||i==f)&&(a[c]=1));}if(n)if((i=s.call(n))==f){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else i==g&&(o=n.length<=10?n:n.slice(0,10));return E("",(c={},c[""]=e,c),r,a,o,"",[])}}if(!t("json-parse")){var M,B,D=String.fromCharCode,j={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},O=function(){throw M=B=null,SyntaxError()},R=function(){for(var e,t,n,o,r,a=B,s=a.length;s>M;)switch(r=a.charCodeAt(M)){case 9:case 10:case 13:case 32:M++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=b?a.charAt(M):a[M],M++,e;case 34:for(e="@",M++;s>M;)if(r=a.charCodeAt(M),32>r)O();else if(92==r)switch(r=a.charCodeAt(++M)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=j[r],M++;break;case 117:for(t=++M,n=M+4;n>M;M++)r=a.charCodeAt(M),r>=48&&57>=r||r>=97&&102>=r||r>=65&&70>=r||O();e+=D("0x"+a.slice(t,M));break;default:O()}else{if(34==r)break;for(r=a.charCodeAt(M),t=M;r>=32&&92!=r&&34!=r;)r=a.charCodeAt(++M);e+=a.slice(t,M)}if(34==a.charCodeAt(M))return M++,e;O();default:if(t=M,45==r&&(o=!0,r=a.charCodeAt(++M)),r>=48&&57>=r){for(48==r&&(r=a.charCodeAt(M+1),r>=48&&57>=r)&&O(),o=!1;s>M&&(r=a.charCodeAt(M),r>=48&&57>=r);M++);if(46==a.charCodeAt(M)){for(n=++M;s>n&&(r=a.charCodeAt(n),r>=48&&57>=r);n++);n==M&&O(),M=n}if(r=a.charCodeAt(M),101==r||69==r){for(r=a.charCodeAt(++M),(43==r||45==r)&&M++,n=M;s>n&&(r=a.charCodeAt(n),r>=48&&57>=r);n++);n==M&&O(),M=n}return+a.slice(t,M)}if(o&&O(),"true"==a.slice(M,M+4))return M+=4,!0;if("false"==a.slice(M,M+5))return M+=5,!1;if("null"==a.slice(M,M+4))return M+=4,null;O()}return"$"},N=function(e){var t,n;if("$"==e&&O(),"string"==typeof e){if("@"==(b?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=R(),"]"!=e;n||(n=!0))n&&(","==e?(e=R(),"]"==e&&O()):O()),","==e&&O(),t.push(N(e));return t}if("{"==e){for(t={};e=R(),"}"!=e;n||(n=!0))n&&(","==e?(e=R(),"}"==e&&O()):O()),(","==e||"string"!=typeof e||"@"!=(b?e.charAt(0):e[0])||":"!=R())&&O(),t[e.slice(1)]=N(R());return t}O()}return e},L=function(e,t,n){var o=I(e,t,n);o===a?delete e[t]:e[t]=o},I=function(e,t,n){var o,a=e[t];if("object"==typeof a&&a)if(s.call(a)==m)for(o=a.length;o--;)L(a,o,n);else r(a,function(e){L(a,e,n)});return n.call(e,t,a)};l.parse=function(e,t){var n,o;return M=0,B=""+e,n=N(R()),"$"!=R()&&O(),M=B=null,t&&s.call(t)==d?I((o={},o[""]=n,o),"",t):n}}}i&&define(function(){return l})}(this)},{}],116:[function(e,t){function n(e,t){var n=[];
t=t||0;for(var o=t||0;o<e.length;o++)n[o-t]=e[o];return n}t.exports=n},{}]},{},[12])}(window.BetterTTV=window.BetterTTV||{});
